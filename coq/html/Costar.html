
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Costar</title>
<meta name="description" content="Documentation of Coq module Costar" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module Costar</h1>
<div class="coq">
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html">List</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.Arith.html">Arith</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Freevar.html">Freevar</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Misc.html">Misc</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.micromega.Psatz.html">Psatz</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Star.html">Star</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Logic.Eqdep_dec.html">Coq.Logic.Eqdep_dec</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="FEnv.html">FEnv</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="STerm.html">STerm</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="kwd">Inductive</span>.<br/>
<br/>
<span class="kwd">CoInductive</span> <span class="id"><a name="infred">infred</a></span> {<span class="id">A</span> : <span class="kwd">Type</span>} (<span class="id">R</span> : <span class="id">A</span> -&gt; <span class="id">A</span> -&gt; <span class="kwd">Prop</span>) : <span class="id">A</span> -&gt; <span class="kwd">Prop</span> :=<br/>
| <span class="id"><a name="infred_step">infred_step</a></span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id">R</span> <span class="id">x</span> <span class="id">y</span> -&gt; <span class="id">infred</span> <span class="id">R</span> <span class="id">y</span> -&gt; <span class="id">infred</span> <span class="id">R</span> <span class="id">x</span>.<br/>
<span class="kwd">CoInductive</span> <span class="id"><a name="costar">costar</a></span> {<span class="id">A</span> : <span class="kwd">Type</span>} (<span class="id">R</span> : <span class="id">A</span> -&gt; <span class="id">A</span> -&gt; <span class="kwd">Prop</span>) : <span class="id">A</span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id">A</span> -&gt; <span class="kwd">Prop</span> :=<br/>
| <span class="id"><a name="costar_refl">costar_refl</a></span> : <span class="kwd">forall</span> <span class="id">x</span>, <span class="id">costar</span> <span class="id">R</span> <span class="id">x</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">x</span>)<br/>
| <span class="id"><a name="costar_step">costar_step</a></span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span>, <span class="id">R</span> <span class="id">x</span> <span class="id">y</span> -&gt; <span class="id">costar</span> <span class="id">R</span> <span class="id">y</span> <span class="id">z</span> -&gt; <span class="id">costar</span> <span class="id">R</span> <span class="id">x</span> <span class="id">z</span>.<br/>
<span class="kwd">Definition</span> <span class="id"><a name="costarP">costarP</a></span> {<span class="id">A</span> : <span class="kwd">Type</span>} (<span class="id">R</span> : <span class="id">A</span> -&gt; <span class="id">A</span> -&gt; <span class="kwd">Prop</span>) <span class="id">x</span> <span class="id">y</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">H</span>, <span class="id">H</span> <span class="id">x</span> <span class="id">y</span> /\ <span class="kwd">forall</span> <span class="id">x1</span> <span class="id">y1</span>, <span class="id">H</span> <span class="id">x1</span> <span class="id">y1</span> -&gt; <span class="id">y1</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">x1</span> \/ <span class="kwd">exists</span> <span class="id">z</span>, <span class="id">R</span> <span class="id">x1</span> <span class="id">z</span> /\ <span class="id">H</span> <span class="id">z</span> <span class="id">y1</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="costarP_costar">costarP_costar</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> (<span class="id">R</span> : <span class="id">A</span> -&gt; <span class="id">A</span> -&gt; <span class="kwd">Prop</span>) <span class="id">x</span> <span class="id">y</span>, <span class="id"><a href="Costar.html#costarP">costarP</a></span> <span class="id">R</span> <span class="id">x</span> <span class="id">y</span> -&gt; <span class="id"><a href="Costar.html#costar">costar</a></span> <span class="id">R</span> <span class="id">x</span> <span class="id">y</span>.<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">A</span> <span class="id">R</span>. <span class="kwd">cofix</span> <span class="id">IH</span>. <span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> (<span class="id">H</span> &amp; <span class="id">H1</span> &amp; <span class="id">H2</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="id">destruct</span> <span class="id">H1</span> <span class="kwd">as</span> [<span class="id">H1</span> | (<span class="id">z</span> &amp; <span class="id">HR</span> &amp; <span class="id">H1</span>)].<br/>
&nbsp;&nbsp;- <span class="id">subst</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">econstructor</span>; [<span class="id">eassumption</span>|]. <span class="id">apply</span> <span class="id">IH</span>. <span class="kwd">exists</span> <span class="id">H</span>; <span class="id">split</span>; <span class="id">assumption</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="infred_map_impl">infred_map_impl</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">A</span> <span class="id">B</span> : <span class="kwd">Type</span>) (<span class="id">RA</span> : <span class="id">A</span> -&gt; <span class="id">A</span> -&gt; <span class="kwd">Prop</span>) (<span class="id">RB</span> : <span class="id">B</span> -&gt; <span class="id">B</span> -&gt; <span class="kwd">Prop</span>) (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id">B</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> : <span class="id">A</span>, <span class="id">RA</span> <span class="id">x</span> <span class="id">y</span> -&gt; <span class="id">RB</span> (<span class="id">f</span> <span class="id">x</span>) (<span class="id">f</span> <span class="id">y</span>)) -&gt; <span class="kwd">forall</span> <span class="id">x</span> : <span class="id">A</span>, <span class="id"><a href="Costar.html#infred">infred</a></span> <span class="id">RA</span> <span class="id">x</span> -&gt; <span class="id"><a href="Costar.html#infred">infred</a></span> <span class="id">RB</span> (<span class="id">f</span> <span class="id">x</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">A</span> <span class="id">B</span> <span class="id">RA</span> <span class="id">RB</span> <span class="id">f</span> <span class="id">H</span>. <span class="kwd">cofix</span> <span class="id">IH</span>. <span class="id">intros</span> <span class="id">x</span> <span class="id">Hx</span>. <span class="id">inversion</span> <span class="id">Hx</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; [<span class="id">apply</span> <span class="id">H</span>; <span class="id">eassumption</span>|].<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">IH</span>. <span class="id">assumption</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="costar_map_impl">costar_map_impl</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">A</span> <span class="id">B</span> : <span class="kwd">Type</span>) (<span class="id">RA</span> : <span class="id">A</span> -&gt; <span class="id">A</span> -&gt; <span class="kwd">Prop</span>) (<span class="id">RB</span> : <span class="id">B</span> -&gt; <span class="id">B</span> -&gt; <span class="kwd">Prop</span>) (<span class="id">f</span> : <span class="id">A</span> -&gt; <span class="id">B</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> : <span class="id">A</span>, <span class="id">RA</span> <span class="id">x</span> <span class="id">y</span> -&gt; <span class="id">RB</span> (<span class="id">f</span> <span class="id">x</span>) (<span class="id">f</span> <span class="id">y</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id"><a href="Costar.html#costar">costar</a></span> <span class="id">RA</span> <span class="id">x</span> <span class="id">y</span> -&gt; <span class="id"><a href="Costar.html#costar">costar</a></span> <span class="id">RB</span> (<span class="id">f</span> <span class="id">x</span>) (<span class="kwd">match</span> <span class="id">y</span> <span class="kwd">with</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> | <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">y</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">f</span> <span class="id">y</span>) <span class="kwd">end</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">A</span> <span class="id">B</span> <span class="id">RA</span> <span class="id">RB</span> <span class="id">f</span> <span class="id">H</span>. <span class="kwd">cofix</span> <span class="id">IH</span>. <span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">Hx</span>. <span class="id">inversion</span> <span class="id">Hx</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">econstructor</span>; [<span class="id">apply</span> <span class="id">H</span>; <span class="id">eassumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">IH</span>. <span class="id">assumption</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="costar_compose">costar_compose</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">A</span> : <span class="kwd">Type</span>) (<span class="id">R</span> : <span class="id">A</span> -&gt; <span class="id">A</span> -&gt; <span class="kwd">Prop</span>) <span class="id">x</span> <span class="id">y</span> <span class="id">z</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Costar.html#costar">costar</a></span> <span class="id">R</span> <span class="id">x</span> <span class="id">y</span> -&gt; (<span class="kwd">forall</span> <span class="id">w</span>, <span class="id">y</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">w</span> -&gt; <span class="id"><a href="Costar.html#costar">costar</a></span> <span class="id">R</span> <span class="id">w</span> <span class="id">z</span>) -&gt; <span class="id"><a href="Costar.html#costar">costar</a></span> <span class="id">R</span> <span class="id">x</span> <span class="id">z</span>.<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">A</span> <span class="id">R</span>. <span class="kwd">cofix</span> <span class="id">IH</span>. <span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span> <span class="id">H1</span> <span class="id">H2</span>. <span class="id">inversion</span> <span class="id">H1</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id">H2</span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id">econstructor</span>; [<span class="id">eassumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">IH</span>; <span class="id">eassumption</span>.<br/>
Defined.</details>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="weaken">weaken</a></span> {<span class="id">A</span> : <span class="kwd">Type</span>} (<span class="id">x</span> <span class="id">y</span> : <span class="id">A</span> * <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) := <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">x</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">y</span> /\ <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">y</span> &lt;= <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">x</span>.<br/>
<span class="kwd">Definition</span> <span class="id"><a name="weakenO">weakenO</a></span> {<span class="id">A</span> : <span class="kwd">Type</span>} (<span class="id">x</span> <span class="id">y</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id">A</span> * <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>)) := <span class="kwd">match</span> <span class="id">x</span>, <span class="id">y</span> <span class="kwd">with</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> | <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">x</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">y</span> =&gt; <span class="id"><a href="Costar.html#weaken">weaken</a></span> <span class="id">x</span> <span class="id">y</span> | <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span> <span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="weaken_refl">weaken_refl</a></span> : <span class="kwd">forall</span> (<span class="id">A</span> : <span class="kwd">Type</span>) (<span class="id">x</span> : <span class="id">A</span> * <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>), <span class="id"><a href="Costar.html#weaken">weaken</a></span> <span class="id">x</span> <span class="id">x</span>.<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">A</span> [<span class="id">x</span> <span class="id">y</span>]. <span class="id">unfold</span> <span class="id"><a href="Costar.html#weaken">weaken</a></span>. <span class="id">simpl</span>. <span class="id">split</span>; <span class="id">reflexivity</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="weakenO_refl">weakenO_refl</a></span> : <span class="kwd">forall</span> (<span class="id">A</span> : <span class="kwd">Type</span>) (<span class="id">x</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id">A</span> * <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>)), <span class="id"><a href="Costar.html#weakenO">weakenO</a></span> <span class="id">x</span> <span class="id">x</span>.<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">A</span> [<span class="id">x</span>|]; <span class="id">unfold</span> <span class="id"><a href="Costar.html#weakenO">weakenO</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Costar.html#weaken_refl">weaken_refl</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">tauto</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="stepped">stepped</a></span> {<span class="id">A</span> : <span class="kwd">Type</span>} (<span class="id">R</span> : <span class="id">A</span> -&gt; <span class="id">A</span> -&gt; <span class="kwd">Prop</span>) <span class="id">x</span> <span class="id">y</span> := <span class="id">R</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">x</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">y</span>) \/ (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">x</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">y</span> /\ <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">y</span> &lt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">x</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="costarPTn">costarPTn</a></span> {<span class="id">A</span> : <span class="kwd">Type</span>} (<span class="id">R</span> : <span class="id">A</span> -&gt; <span class="id">A</span> -&gt; <span class="kwd">Prop</span>) <span class="id">x</span> <span class="id">y</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">H</span>, <span class="id">H</span> <span class="id">x</span> <span class="id">y</span> /\ <span class="kwd">forall</span> <span class="id">x1</span> <span class="id">y1</span>, <span class="id">H</span> <span class="id">x1</span> <span class="id">y1</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Costar.html#weakenO">weakenO</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">x1</span>) <span class="id">y1</span> \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">exists</span> <span class="id">z1</span>, <span class="id"><a href="Costar.html#stepped">stepped</a></span> <span class="id">R</span> <span class="id">x1</span> <span class="id">z1</span> /\ <span class="id">H</span> <span class="id">z1</span> <span class="id">y1</span>) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">exists</span> <span class="id">z1</span> <span class="id">z2</span>, <span class="id"><a href="Costar.html#stepped">stepped</a></span> <span class="id">R</span> <span class="id">x1</span> <span class="id">z1</span> /\ <span class="id">H</span> <span class="id">z1</span> <span class="id">z2</span> /\ (<span class="kwd">forall</span> <span class="id">v</span>, <span class="id">z2</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span> -&gt; <span class="id">H</span> <span class="id">v</span> <span class="id">y1</span>)).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="costarPTn_destruct">costarPTn_destruct</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">A</span> : <span class="kwd">Type</span>) (<span class="id">R</span> : <span class="id">A</span> -&gt; <span class="id">A</span> -&gt; <span class="kwd">Prop</span>) <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Costar.html#costarPTn">costarPTn</a></span> <span class="id">R</span> <span class="id">x</span> <span class="id">y</span> -&gt; <span class="id"><a href="Costar.html#weakenO">weakenO</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">x</span>) <span class="id">y</span> \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">exists</span> <span class="id">z</span>, <span class="id"><a href="Costar.html#stepped">stepped</a></span> <span class="id">R</span> <span class="id">x</span> <span class="id">z</span> /\ <span class="id"><a href="Costar.html#costarPTn">costarPTn</a></span> <span class="id">R</span> <span class="id">z</span> <span class="id">y</span>) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">exists</span> <span class="id">z1</span> <span class="id">z2</span>, <span class="id"><a href="Costar.html#stepped">stepped</a></span> <span class="id">R</span> <span class="id">x</span> <span class="id">z1</span> /\ <span class="id"><a href="Costar.html#costarPTn">costarPTn</a></span> <span class="id">R</span> <span class="id">z1</span> <span class="id">z2</span> /\ (<span class="kwd">forall</span> <span class="id">v</span>, <span class="id">z2</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span> -&gt; <span class="id"><a href="Costar.html#costarPTn">costarPTn</a></span> <span class="id">R</span> <span class="id">v</span> <span class="id">y</span>)).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">A</span> <span class="id">R</span> <span class="id">x</span> <span class="id">y</span> (<span class="id">H</span> &amp; <span class="id">H1</span> &amp; <span class="id">H2</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="id">destruct</span> <span class="id">H1</span> <span class="kwd">as</span> [<span class="id">H1</span> | [(<span class="id">z</span> &amp; <span class="id">Hz1</span> &amp; <span class="id">Hz2</span>) | (<span class="id">z1</span> &amp; <span class="id">z2</span> &amp; <span class="id">Hz1</span> &amp; <span class="id">Hz2</span> &amp; <span class="id">Hz3</span>)]].<br/>
&nbsp;&nbsp;- <span class="id">left</span>. <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">right</span>. <span class="id">left</span>. <span class="kwd">exists</span> <span class="id">z</span>. <span class="id">split</span>; [<span class="id">assumption</span>|]. <span class="kwd">exists</span> <span class="id">H</span>; <span class="id">split</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">right</span>. <span class="id">right</span>. <span class="kwd">exists</span> <span class="id">z1</span>. <span class="kwd">exists</span> <span class="id">z2</span>. <span class="id">split</span>; [<span class="id">assumption</span>|]. <span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="kwd">exists</span> <span class="id">H</span>; <span class="id">split</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> <span class="id">v</span> -&gt;. <span class="kwd">exists</span> <span class="id">H</span>; <span class="id">split</span>; [|<span class="id">assumption</span>]. <span class="id">apply</span> <span class="id">Hz3</span>. <span class="id">reflexivity</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="weaken_trans">weaken_trans</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">A</span> : <span class="kwd">Type</span>) (<span class="id">x</span> <span class="id">y</span> <span class="id">z</span> : <span class="id">A</span> * <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>), <span class="id"><a href="Costar.html#weaken">weaken</a></span> <span class="id">x</span> <span class="id">y</span> -&gt; <span class="id"><a href="Costar.html#weaken">weaken</a></span> <span class="id">y</span> <span class="id">z</span> -&gt; <span class="id"><a href="Costar.html#weaken">weaken</a></span> <span class="id">x</span> <span class="id">z</span>.<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">A</span> [<span class="id">x1</span> <span class="id">x2</span>] [<span class="id">y1</span> <span class="id">y2</span>] [<span class="id">z1</span> <span class="id">z2</span>]; <span class="id">unfold</span> <span class="id"><a href="Costar.html#weaken">weaken</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> [? ?] [? ?]; <span class="id">split</span>; [<span class="id">congruence</span>|<span class="id">lia</span>].<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="stepped_weaken">stepped_weaken</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">A</span> : <span class="kwd">Type</span>) (<span class="id">R</span> : <span class="id">A</span> -&gt; <span class="id">A</span> -&gt; <span class="kwd">Prop</span>) <span class="id">x</span> <span class="id">y</span> <span class="id">z</span>, <span class="id"><a href="Costar.html#weaken">weaken</a></span> <span class="id">x</span> <span class="id">y</span> -&gt; <span class="id"><a href="Costar.html#stepped">stepped</a></span> <span class="id">R</span> <span class="id">y</span> <span class="id">z</span> -&gt; <span class="id"><a href="Costar.html#stepped">stepped</a></span> <span class="id">R</span> <span class="id">x</span> <span class="id">z</span>.<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">A</span> <span class="id">R</span> [<span class="id">x1</span> <span class="id">x2</span>] [<span class="id">y1</span> <span class="id">y2</span>] [<span class="id">z1</span> <span class="id">z2</span>] [<span class="id">H1</span> <span class="id">H2</span>] [<span class="id">H3</span> | [<span class="id">H3</span> <span class="id">H4</span>]]; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;- <span class="id">left</span>; <span class="id">simpl</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">right</span>; <span class="id">simpl</span>; <span class="id">split</span>; [<span class="id">reflexivity</span>|<span class="id">lia</span>].<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="costarPTn_comp">costarPTn_comp</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">A</span> : <span class="kwd">Type</span>) (<span class="id">R</span> : <span class="id">A</span> -&gt; <span class="id">A</span> -&gt; <span class="kwd">Prop</span>) <span class="id">x</span> <span class="id">y</span> <span class="id">z</span>, <span class="id"><a href="Costar.html#costarPTn">costarPTn</a></span> <span class="id">R</span> <span class="id">x</span> <span class="id">y</span> -&gt; (<span class="kwd">forall</span> <span class="id">v</span>, <span class="id">y</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span> -&gt; <span class="id"><a href="Costar.html#costarPTn">costarPTn</a></span> <span class="id">R</span> <span class="id">v</span> <span class="id">z</span>) -&gt; <span class="id"><a href="Costar.html#costarPTn">costarPTn</a></span> <span class="id">R</span> <span class="id">x</span> <span class="id">z</span>.<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">A</span> <span class="id">R</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span> <span class="id">H1</span> <span class="id">H2</span>. <span class="kwd">exists</span> (<span class="kwd">fun</span> <span class="id">x1</span> <span class="id">y1</span> =&gt; <span class="id"><a href="Costar.html#costarPTn">costarPTn</a></span> <span class="id">R</span> <span class="id">x1</span> <span class="id">y1</span> \/ <span class="kwd">exists</span> <span class="id">w</span>, <span class="id"><a href="Costar.html#costarPTn">costarPTn</a></span> <span class="id">R</span> <span class="id">x1</span> <span class="id">w</span> /\ (<span class="kwd">forall</span> <span class="id">v</span>, <span class="id">w</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span> -&gt; <span class="id"><a href="Costar.html#costarPTn">costarPTn</a></span> <span class="id">R</span> <span class="id">v</span> <span class="id">y1</span>)).<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;- <span class="id">right</span>. <span class="kwd">exists</span> <span class="id">y</span>. <span class="id">split</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">clear</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span> <span class="id">H1</span> <span class="id">H2</span>. <span class="id">intros</span> <span class="id">x</span> <span class="id">z</span> [<span class="id">Hxz</span> | (<span class="id">y</span> &amp; <span class="id">Hxy</span> &amp; <span class="id">Hyz</span>)].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Costar.html#costarPTn_destruct">costarPTn_destruct</a></span> <span class="kwd">in</span> <span class="id">Hxz</span>. <span class="id">destruct</span> <span class="id">Hxz</span> <span class="kwd">as</span> [<span class="id">Hxz</span> | [(<span class="id">z1</span> &amp; <span class="id">Hz1</span> &amp; <span class="id">Hz2</span>) | (<span class="id">z1</span> &amp; <span class="id">z2</span> &amp; <span class="id">Hz1</span> &amp; <span class="id">Hz2</span> &amp; <span class="id">Hz3</span>)]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">left</span>. <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">right</span>. <span class="id">left</span>. <span class="kwd">exists</span> <span class="id">z1</span>. <span class="id">split</span>; <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">right</span>. <span class="id">right</span>. <span class="kwd">exists</span> <span class="id">z1</span>. <span class="kwd">exists</span> <span class="id">z2</span>. <span class="id">split</span>; [<span class="id">assumption</span>|]. <span class="id">split</span>; [<span class="id">tauto</span>|]. <span class="id">intros</span> <span class="id">v</span> <span class="id">Hv</span>; <span class="id">left</span>; <span class="id">apply</span> <span class="id">Hz3</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Costar.html#costarPTn_destruct">costarPTn_destruct</a></span> <span class="kwd">in</span> <span class="id">Hxy</span>. <span class="id">destruct</span> <span class="id">Hxy</span> <span class="kwd">as</span> [<span class="id">Hxy</span> | [(<span class="id">z1</span> &amp; <span class="id">Hz1</span> &amp; <span class="id">Hz2</span>) | (<span class="id">z1</span> &amp; <span class="id">z2</span> &amp; <span class="id">Hz1</span> &amp; <span class="id">Hz2</span> &amp; <span class="id">Hz3</span>)]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">destruct</span> <span class="id">y</span> <span class="kwd">as</span> [<span class="id">y</span>|]; <span class="id">simpl</span> <span class="kwd">in</span> *; [|<span class="id">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">Hyz</span> <span class="id">y</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Costar.html#costarPTn_destruct">costarPTn_destruct</a></span> <span class="kwd">in</span> <span class="id">Hyz</span>. <span class="id">destruct</span> <span class="id">Hyz</span> <span class="kwd">as</span> [<span class="id">Hyz</span> | [(<span class="id">z1</span> &amp; <span class="id">Hz1</span> &amp; <span class="id">Hz2</span>) | (<span class="id">z1</span> &amp; <span class="id">z2</span> &amp; <span class="id">Hz1</span> &amp; <span class="id">Hz2</span> &amp; <span class="id">Hz3</span>)]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">destruct</span> <span class="id">z</span> <span class="kwd">as</span> [<span class="id">z</span>|]; <span class="id">simpl</span> <span class="kwd">in</span> *; [|<span class="id">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="id">eapply</span> <span class="id"><a href="Costar.html#weaken_trans">weaken_trans</a></span>; <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">right</span>. <span class="id">left</span>. <span class="kwd">exists</span> <span class="id">z1</span>. <span class="id">split</span>; [<span class="id">eapply</span> <span class="id"><a href="Costar.html#stepped_weaken">stepped_weaken</a></span>; <span class="id">eassumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">right</span>. <span class="id">right</span>. <span class="kwd">exists</span> <span class="id">z1</span>. <span class="kwd">exists</span> <span class="id">z2</span>. <span class="id">split</span>; [<span class="id">eapply</span> <span class="id"><a href="Costar.html#stepped_weaken">stepped_weaken</a></span>; <span class="id">eassumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; [<span class="id">left</span>; <span class="id">assumption</span>|]. <span class="id">intros</span>; <span class="id">left</span>; <span class="id">apply</span> <span class="id">Hz3</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">right</span>. <span class="id">left</span>. <span class="kwd">exists</span> <span class="id">z1</span>. <span class="id">split</span>; [<span class="id">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>. <span class="kwd">exists</span> <span class="id">y</span>. <span class="id">split</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">right</span>. <span class="id">right</span>. <span class="kwd">exists</span> <span class="id">z1</span>. <span class="kwd">exists</span> <span class="id">z2</span>. <span class="id">split</span>; [<span class="id">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">left</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">intros</span> <span class="id">v</span> -&gt;. <span class="id">right</span>. <span class="kwd">exists</span> <span class="id">y</span>. <span class="id">split</span>; [<span class="id">apply</span> <span class="id">Hz3</span>; <span class="id">reflexivity</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">w</span> -&gt;. <span class="id">apply</span> <span class="id">Hyz</span>. <span class="id">reflexivity</span>.<br/>
Qed.</details>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="costarPTn_costarP">costarPTn_costarP</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">A</span> : <span class="kwd">Type</span>) (<span class="id">R</span> : <span class="id">A</span> -&gt; <span class="id">A</span> -&gt; <span class="kwd">Prop</span>) <span class="id">x</span> <span class="id">y</span>, <span class="id"><a href="Costar.html#costarPTn">costarPTn</a></span> <span class="id">R</span> <span class="id">x</span> <span class="id">y</span> -&gt; <span class="id"><a href="Costar.html#costarP">costarP</a></span> <span class="id">R</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">x</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option_map">option_map</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">y</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">A</span> <span class="id">R</span> <span class="id">x</span> <span class="id">y</span> <span class="id">H</span>. <span class="kwd">exists</span> (<span class="kwd">fun</span> <span class="id">u</span> <span class="id">v</span> =&gt; <span class="kwd">exists</span> <span class="id">n</span> <span class="id">m</span>, <span class="id"><a href="Costar.html#costarPTn">costarPTn</a></span> <span class="id">R</span> (<span class="id">u</span>, <span class="id">n</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option_map">option_map</a></span> (<span class="kwd">fun</span> <span class="id">v</span> =&gt; (<span class="id">v</span>, <span class="id">m</span>)) <span class="id">v</span>)).<br/>
&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;- <span class="kwd">exists</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">x</span>). <span class="kwd">exists</span> (<span class="kwd">match</span> <span class="id">y</span> <span class="kwd">with</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">y</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">y</span> | <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; 0 <span class="kwd">end</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">x</span> <span class="kwd">as</span> [<span class="id">x1</span> <span class="id">x2</span>]. <span class="id">destruct</span> <span class="id">y</span> <span class="kwd">as</span> [[<span class="id">y1</span> <span class="id">y2</span>]|]; <span class="id">simpl</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">clear</span> <span class="id">x</span> <span class="id">y</span> <span class="id">H</span>. <span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> (<span class="id">n</span> &amp; <span class="id">m</span> &amp; <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">revert</span> <span class="id">x</span> <span class="id">y</span> <span class="id">m</span> <span class="id">H</span>; <span class="id">induction</span> <span class="id">n</span> <span class="kwd">as</span> [<span class="id">n</span> <span class="id">Hn</span>] <span class="kwd">using</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.Wf_nat.html#lt_wf_ind">lt_wf_ind</a></span>; <span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">m</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Costar.html#costarPTn_destruct">costarPTn_destruct</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">H</span> | [(<span class="id">z</span> &amp; <span class="id">Hz1</span> &amp; <span class="id">Hz2</span>) | (<span class="id">z1</span> &amp; <span class="id">z2</span> &amp; <span class="id">Hz1</span> &amp; <span class="id">Hz2</span> &amp; <span class="id">Hz3</span>)]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">destruct</span> <span class="id">y</span> <span class="kwd">as</span> [<span class="id">y</span>|]; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">H</span>; [|<span class="id">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="Costar.html#weaken">weaken</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">left</span>. <span class="id">destruct</span> <span class="id">H</span>; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">destruct</span> <span class="id">Hz1</span> <span class="kwd">as</span> [<span class="id">Hz1</span> | <span class="id">Hz1</span>]; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Hz1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">right</span>. <span class="kwd">exists</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">z</span>). <span class="id">split</span>; [<span class="id">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">z</span>). <span class="kwd">exists</span> <span class="id">m</span>. <span class="id">destruct</span> <span class="id">z</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">destruct</span> <span class="id">Hz1</span> <span class="kwd">as</span> [-&gt; <span class="id">Hz1</span>]. <span class="id">destruct</span> <span class="id">z</span> <span class="kwd">as</span> [<span class="id">z1</span> <span class="id">z2</span>]; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">Hn</span>; [|<span class="id">eassumption</span>]. <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">destruct</span> <span class="id">Hz1</span> <span class="kwd">as</span> [<span class="id">Hz1</span> | <span class="id">Hz1</span>]; <span class="id">simpl</span> <span class="kwd">in</span> <span class="id">Hz1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">right</span>. <span class="kwd">exists</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">z1</span>). <span class="id">split</span>; [<span class="id">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">z1</span>). <span class="kwd">exists</span> <span class="id">m</span>. <span class="id">eapply</span> <span class="id"><a href="Costar.html#costarPTn_comp">costarPTn_comp</a></span>; [<span class="id">destruct</span> <span class="id">z1</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">eassumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">destruct</span> <span class="id">Hz1</span> <span class="kwd">as</span> [-&gt; <span class="id">Hz1</span>]. <span class="id">destruct</span> <span class="id">z1</span> <span class="kwd">as</span> [<span class="id">z3</span> <span class="id">z4</span>]; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id">Hn</span>; [<span class="id">exact</span> <span class="id">Hz1</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Costar.html#costarPTn_comp">costarPTn_comp</a></span>; <span class="id">eassumption</span>.<br/>
Qed.</details>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
