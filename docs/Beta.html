
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Beta</title>
<meta name="description" content="Documentation of Coq module Beta" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module Beta</h1>
<div class="coq">
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html">List</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.Arith.html">Arith</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Freevar.html">Freevar</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Misc.html">Misc</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.micromega.Psatz.html">Psatz</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Logic.Eqdep_dec.html">Coq.Logic.Eqdep_dec</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="FEnv.html">FEnv</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="Rewrite.html">Rewrite</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="STerm.html">STerm</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="kwd">Inductive</span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="GenInd.html">GenInd</a></span>.<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="beta">beta</a></span> : <span class="id"><a href="STerm.html#term">term</a></span> -&gt; <span class="id"><a href="STerm.html#term">term</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
| <span class="id"><a name="beta_app1">beta_app1</a></span> : <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">t3</span>, <span class="id">beta</span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id">beta</span> (<span class="id"><a href="STerm.html#app">app</a></span> <span class="id">t1</span> <span class="id">t3</span>) (<span class="id"><a href="STerm.html#app">app</a></span> <span class="id">t2</span> <span class="id">t3</span>)<br/>
| <span class="id"><a name="beta_app2">beta_app2</a></span> : <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">t3</span>, <span class="id">beta</span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id">beta</span> (<span class="id"><a href="STerm.html#app">app</a></span> <span class="id">t3</span> <span class="id">t1</span>) (<span class="id"><a href="STerm.html#app">app</a></span> <span class="id">t3</span> <span class="id">t2</span>)<br/>
| <span class="id"><a name="beta_abs">beta_abs</a></span> : <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span>, <span class="id">beta</span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id">beta</span> (<span class="id"><a href="STerm.html#abs">abs</a></span> <span class="id">t1</span>) (<span class="id"><a href="STerm.html#abs">abs</a></span> <span class="id">t2</span>)<br/>
| <span class="id"><a name="beta_redex">beta_redex</a></span> : <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span>, <span class="id">beta</span> (<span class="id"><a href="STerm.html#app">app</a></span> (<span class="id"><a href="STerm.html#abs">abs</a></span> <span class="id">t1</span>) <span class="id">t2</span>) (<span class="id"><a href="STerm.html#subst1">subst1</a></span> <span class="id">t2</span> <span class="id">t1</span>)<br/>
| <span class="id"><a name="beta_constr">beta_constr</a></span> : <span class="kwd">forall</span> <span class="id">tag</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">l1</span> <span class="id">l2</span>, <span class="id">beta</span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id">beta</span> (<span class="id"><a href="STerm.html#constr">constr</a></span> <span class="id">tag</span> (<span class="id">l1</span> ++ <span class="id">t1</span> :: <span class="id">l2</span>)) (<span class="id"><a href="STerm.html#constr">constr</a></span> <span class="id">tag</span> (<span class="id">l1</span> ++ <span class="id">t2</span> :: <span class="id">l2</span>))<br/>
| <span class="id"><a name="beta_switch1">beta_switch1</a></span> : <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">l</span>, <span class="id">beta</span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id">beta</span> (<span class="id"><a href="STerm.html#switch">switch</a></span> <span class="id">t1</span> <span class="id">l</span>) (<span class="id"><a href="STerm.html#switch">switch</a></span> <span class="id">t2</span> <span class="id">l</span>)<br/>
| <span class="id"><a name="beta_switch2">beta_switch2</a></span> : <span class="kwd">forall</span> <span class="id">t</span> <span class="id">p</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">l1</span> <span class="id">l2</span>, <span class="id">beta</span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id">beta</span> (<span class="id"><a href="STerm.html#switch">switch</a></span> <span class="id">t</span> (<span class="id">l1</span> ++ (<span class="id">p</span>, <span class="id">t1</span>) :: <span class="id">l2</span>)) (<span class="id"><a href="STerm.html#switch">switch</a></span> <span class="id">t</span> (<span class="id">l1</span> ++ (<span class="id">p</span>, <span class="id">t2</span>) :: <span class="id">l2</span>))<br/>
| <span class="id"><a name="beta_switch_redex">beta_switch_redex</a></span> : <span class="kwd">forall</span> <span class="id">l</span> <span class="id">t</span> <span class="id">l1</span> <span class="id">l2</span>, <span class="id">beta</span> (<span class="id"><a href="STerm.html#switch">switch</a></span> (<span class="id"><a href="STerm.html#constr">constr</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l1</span>) <span class="id">l</span>) (<span class="id">l1</span> ++ (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span>, <span class="id">t</span>) :: <span class="id">l2</span>)) (<span class="id"><a href="STerm.html#subst">subst</a></span> (<span class="id"><a href="STerm.html#read_env">read_env</a></span> <span class="id">l</span>) <span class="id">t</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="star_beta_app">star_beta_app</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">t3</span> <span class="id">t4</span>, <span class="id"><a href="Rewrite.html#star">star</a></span> <span class="id"><a href="Beta.html#beta">beta</a></span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id"><a href="Rewrite.html#star">star</a></span> <span class="id"><a href="Beta.html#beta">beta</a></span> <span class="id">t3</span> <span class="id">t4</span> -&gt; <span class="id"><a href="Rewrite.html#star">star</a></span> <span class="id"><a href="Beta.html#beta">beta</a></span> (<span class="id"><a href="STerm.html#app">app</a></span> <span class="id">t1</span> <span class="id">t3</span>) (<span class="id"><a href="STerm.html#app">app</a></span> <span class="id">t2</span> <span class="id">t4</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">t3</span> <span class="id">t4</span> <span class="id">H12</span> <span class="id">H34</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_compose">star_compose</a></span>.<br/>
&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_map_impl">star_map_impl</a></span> <span class="kwd">with</span> (<span class="id">RA</span> := <span class="id"><a href="Beta.html#beta">beta</a></span>) (<span class="id">f</span> := <span class="kwd">fun</span> <span class="id">t</span> =&gt; <span class="id"><a href="STerm.html#app">app</a></span> <span class="id">t</span> <span class="id">_</span>); [|<span class="id">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_map_impl">star_map_impl</a></span> <span class="kwd">with</span> (<span class="id">RA</span> := <span class="id"><a href="Beta.html#beta">beta</a></span>) (<span class="id">f</span> := <span class="kwd">fun</span> <span class="id">t</span> =&gt; <span class="id"><a href="STerm.html#app">app</a></span> <span class="id">_</span> <span class="id">t</span>); [|<span class="id">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="star_beta_abs">star_beta_abs</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span>, <span class="id"><a href="Rewrite.html#star">star</a></span> <span class="id"><a href="Beta.html#beta">beta</a></span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id"><a href="Rewrite.html#star">star</a></span> <span class="id"><a href="Beta.html#beta">beta</a></span> (<span class="id"><a href="STerm.html#abs">abs</a></span> <span class="id">t1</span>) (<span class="id"><a href="STerm.html#abs">abs</a></span> <span class="id">t2</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_map_impl">star_map_impl</a></span> <span class="kwd">with</span> (<span class="id">RA</span> := <span class="id"><a href="Beta.html#beta">beta</a></span>) (<span class="id">f</span> := <span class="kwd">fun</span> <span class="id">t</span> =&gt; <span class="id"><a href="STerm.html#abs">abs</a></span> <span class="id">t</span>); [|<span class="id">eassumption</span>].<br/>
&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="star_beta_constr">star_beta_constr</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">tag</span> <span class="id">l1</span> <span class="id">l2</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="id"><a href="Rewrite.html#star">star</a></span> <span class="id"><a href="Beta.html#beta">beta</a></span>) <span class="id">l1</span> <span class="id">l2</span> -&gt; <span class="id"><a href="Rewrite.html#star">star</a></span> <span class="id"><a href="Beta.html#beta">beta</a></span> (<span class="id"><a href="STerm.html#constr">constr</a></span> <span class="id">tag</span> <span class="id">l1</span>) (<span class="id"><a href="STerm.html#constr">constr</a></span> <span class="id">tag</span> <span class="id">l2</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">tag</span> <span class="id">l1</span> <span class="id">l2</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_list">star_list</a></span>; [|<span class="id">eassumption</span>].<br/>
&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="star_beta_switch">star_beta_switch</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">l1</span> <span class="id">l2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Rewrite.html#star">star</a></span> <span class="id"><a href="Beta.html#beta">beta</a></span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> <span class="id">pt1</span> <span class="id">pt2</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">pt1</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">pt2</span> /\ <span class="id"><a href="Rewrite.html#star">star</a></span> <span class="id"><a href="Beta.html#beta">beta</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">pt1</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">pt2</span>)) <span class="id">l1</span> <span class="id">l2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Rewrite.html#star">star</a></span> <span class="id"><a href="Beta.html#beta">beta</a></span> (<span class="id"><a href="STerm.html#switch">switch</a></span> <span class="id">t1</span> <span class="id">l1</span>) (<span class="id"><a href="STerm.html#switch">switch</a></span> <span class="id">t2</span> <span class="id">l2</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">l1</span> <span class="id">l2</span> <span class="id">Ht</span> <span class="id">Hl</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_compose">star_compose</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_map_impl">star_map_impl</a></span> <span class="kwd">with</span> (<span class="id">RA</span> := <span class="id"><a href="Beta.html#beta">beta</a></span>) (<span class="id">f</span> := <span class="kwd">fun</span> <span class="id">t</span> =&gt; <span class="id"><a href="STerm.html#switch">switch</a></span> <span class="id">t</span> <span class="id">_</span>); [|<span class="id">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_list">star_list</a></span> <span class="kwd">with</span> (<span class="id">RA</span> := <span class="kwd">fun</span> <span class="id">pt1</span> <span class="id">pt2</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">pt1</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">pt2</span> /\ <span class="id"><a href="Beta.html#beta">beta</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">pt1</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">pt2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> <span class="id">l3</span> <span class="id">l4</span> [<span class="id">p1</span> <span class="id">t3</span>] [<span class="id">p2</span> <span class="id">t4</span>] [<span class="id">Hp</span> <span class="id">Hbeta</span>]; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>. <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Misc.html#Forall2_impl">Forall2_impl</a></span>; [|<span class="id">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> [<span class="id">p1</span> <span class="id">t3</span>] [<span class="id">p2</span> <span class="id">t4</span>] [<span class="id">Hp</span> <span class="id">Hbeta</span>]; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_map_impl">star_map_impl</a></span>; [|<span class="id">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">simpl</span>; <span class="id">tauto</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="beta_subst1">beta_subst1</a></span> : <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">us</span>, <span class="id"><a href="Beta.html#beta">beta</a></span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id"><a href="Beta.html#beta">beta</a></span> (<span class="id"><a href="STerm.html#subst">subst</a></span> <span class="id">us</span> <span class="id">t1</span>) (<span class="id"><a href="STerm.html#subst">subst</a></span> <span class="id">us</span> <span class="id">t2</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">us</span> <span class="id">H</span>. <span class="id">revert</span> <span class="id">us</span>. <span class="id">induction</span> <span class="id">H</span>; <span class="id">intros</span> <span class="id">us</span>; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>. <span class="id">apply</span> <span class="id">IHbeta</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>. <span class="id">apply</span> <span class="id">IHbeta</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>. <span class="id">apply</span> <span class="id">IHbeta</span>.<br/>
&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="STerm.html#subst_subst1">subst_subst1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">rewrite</span> !<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>. <span class="id">simpl</span>. <span class="id">constructor</span>. <span class="id">apply</span> <span class="id">IHbeta</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>. <span class="id">apply</span> <span class="id">IHbeta</span>.<br/>
&nbsp;&nbsp;- <span class="id">rewrite</span> !<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>. <span class="id">simpl</span>. <span class="id">constructor</span>. <span class="id">apply</span> <span class="id">IHbeta</span>.<br/>
&nbsp;&nbsp;- <span class="id">rewrite</span> !<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>. <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="STerm.html#subst_read_env">subst_read_env</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ereplace</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l1</span>); [|<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ereplace</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span>); [|<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="star_beta_subst1">star_beta_subst1</a></span> : <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">us</span>, <span class="id"><a href="Rewrite.html#star">star</a></span> <span class="id"><a href="Beta.html#beta">beta</a></span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id"><a href="Rewrite.html#star">star</a></span> <span class="id"><a href="Beta.html#beta">beta</a></span> (<span class="id"><a href="STerm.html#subst">subst</a></span> <span class="id">us</span> <span class="id">t1</span>) (<span class="id"><a href="STerm.html#subst">subst</a></span> <span class="id">us</span> <span class="id">t2</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">us</span> <span class="id">H</span>. <span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_map_impl">star_map_impl</a></span> <span class="kwd">with</span> (<span class="id">f</span> := <span class="kwd">fun</span> <span class="id">t</span> =&gt; <span class="id"><a href="STerm.html#subst">subst</a></span> <span class="id">us</span> <span class="id">t</span>); [|<span class="id">eassumption</span>].<br/>
&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Beta.html#beta_subst1">beta_subst1</a></span>; <span class="id">assumption</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="beta_subst2">beta_subst2</a></span> : <span class="kwd">forall</span> <span class="id">t</span> <span class="id">us1</span> <span class="id">us2</span>, (<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Rewrite.html#star">star</a></span> <span class="id"><a href="Beta.html#beta">beta</a></span> (<span class="id">us1</span> <span class="id">n</span>) (<span class="id">us2</span> <span class="id">n</span>)) -&gt; <span class="id"><a href="Rewrite.html#star">star</a></span> <span class="id"><a href="Beta.html#beta">beta</a></span> (<span class="id"><a href="STerm.html#subst">subst</a></span> <span class="id">us1</span> <span class="id">t</span>) (<span class="id"><a href="STerm.html#subst">subst</a></span> <span class="id">us2</span> <span class="id">t</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">t</span> <span class="id">us1</span> <span class="id">us2</span> <span class="id">Hus</span>. <span class="id">revert</span> <span class="id">us1</span> <span class="id">us2</span> <span class="id">Hus</span>. <span class="id">induction</span> <span class="id">t</span> <span class="kwd">using</span> <span class="id"><a href="STerm.html#term_ind2">term_ind2</a></span>; <span class="id">intros</span> <span class="id">us1</span> <span class="id">us2</span> <span class="id">Hus</span>; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id">Hus</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Beta.html#star_beta_abs">star_beta_abs</a></span>. <span class="id">apply</span> <span class="id">IHt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> [|<span class="id">n</span>]; <span class="id">simpl</span>; [<span class="id">constructor</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="STerm.html#comp">comp</a></span>. <span class="id">rewrite</span> !<span class="id"><a href="STerm.html#ren_term_is_subst">ren_term_is_subst</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Beta.html#star_beta_subst1">star_beta_subst1</a></span>, <span class="id">Hus</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Beta.html#star_beta_app">star_beta_app</a></span>; [<span class="id">apply</span> <span class="id">IHt1</span>|<span class="id">apply</span> <span class="id">IHt2</span>]; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Beta.html#star_beta_constr">star_beta_constr</a></span>. <span class="id">rewrite</span> <span class="id"><a href="Misc.html#Forall2_map_left">Forall2_map_left</a></span>, <span class="id"><a href="Misc.html#Forall2_map_right">Forall2_map_right</a></span>, <span class="id"><a href="Misc.html#Forall2_map_same">Forall2_map_same</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; [|<span class="id">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">t</span> <span class="id">H1</span>; <span class="id">apply</span> <span class="id">H1</span>, <span class="id">Hus</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Beta.html#star_beta_switch">star_beta_switch</a></span>; [<span class="id">apply</span> <span class="id">IHt</span>, <span class="id">Hus</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Misc.html#Forall2_map_left">Forall2_map_left</a></span>, <span class="id"><a href="Misc.html#Forall2_map_right">Forall2_map_right</a></span>, <span class="id"><a href="Misc.html#Forall2_map_same">Forall2_map_same</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; [|<span class="id">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> [<span class="id">p</span> <span class="id">t2</span>] <span class="id">H1</span>; <span class="id">split</span>; [<span class="id">reflexivity</span>|]; <span class="id">apply</span> <span class="id">H1</span>. <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">n</span>; <span class="id">unfold</span> <span class="id"><a href="STerm.html#liftn_subst">liftn_subst</a></span>. <span class="id">destruct</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.Compare_dec.html#le_lt_dec">le_lt_dec</a></span>; [|<span class="id">constructor</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> !<span class="id"><a href="STerm.html#ren_term_is_subst">ren_term_is_subst</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Beta.html#star_beta_subst1">star_beta_subst1</a></span>, <span class="id">Hus</span>.<br/>
Qed.</details>
<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="pbeta">pbeta</a></span> : <span class="id"><a href="STerm.html#term">term</a></span> -&gt; <span class="id"><a href="STerm.html#term">term</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
| <span class="id"><a name="pbeta_var">pbeta_var</a></span> : <span class="kwd">forall</span> <span class="id">n</span>, <span class="id">pbeta</span> (<span class="id"><a href="STerm.html#var">var</a></span> <span class="id">n</span>) (<span class="id"><a href="STerm.html#var">var</a></span> <span class="id">n</span>)<br/>
| <span class="id"><a name="pbeta_dvar">pbeta_dvar</a></span> : <span class="kwd">forall</span> <span class="id">n</span>, <span class="id">pbeta</span> (<span class="id"><a href="STerm.html#dvar">dvar</a></span> <span class="id">n</span>) (<span class="id"><a href="STerm.html#dvar">dvar</a></span> <span class="id">n</span>)<br/>
| <span class="id"><a name="pbeta_app">pbeta_app</a></span> : <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">t3</span> <span class="id">t4</span>, <span class="id">pbeta</span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id">pbeta</span> <span class="id">t3</span> <span class="id">t4</span> -&gt; <span class="id">pbeta</span> (<span class="id"><a href="STerm.html#app">app</a></span> <span class="id">t1</span> <span class="id">t3</span>) (<span class="id"><a href="STerm.html#app">app</a></span> <span class="id">t2</span> <span class="id">t4</span>)<br/>
| <span class="id"><a name="pbeta_redex">pbeta_redex</a></span> : <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">t3</span> <span class="id">t4</span>, <span class="id">pbeta</span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id">pbeta</span> <span class="id">t3</span> <span class="id">t4</span> -&gt; <span class="id">pbeta</span> (<span class="id"><a href="STerm.html#app">app</a></span> (<span class="id"><a href="STerm.html#abs">abs</a></span> <span class="id">t1</span>) <span class="id">t3</span>) (<span class="id"><a href="STerm.html#subst1">subst1</a></span> <span class="id">t4</span> <span class="id">t2</span>)<br/>
| <span class="id"><a name="pbeta_abs">pbeta_abs</a></span> : <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span>, <span class="id">pbeta</span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id">pbeta</span> (<span class="id"><a href="STerm.html#abs">abs</a></span> <span class="id">t1</span>) (<span class="id"><a href="STerm.html#abs">abs</a></span> <span class="id">t2</span>)<br/>
| <span class="id"><a name="pbeta_constr">pbeta_constr</a></span> : <span class="kwd">forall</span> <span class="id">tag</span> <span class="id">l1</span> <span class="id">l2</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id">pbeta</span> <span class="id">l1</span> <span class="id">l2</span> -&gt; <span class="id">pbeta</span> (<span class="id"><a href="STerm.html#constr">constr</a></span> <span class="id">tag</span> <span class="id">l1</span>) (<span class="id"><a href="STerm.html#constr">constr</a></span> <span class="id">tag</span> <span class="id">l2</span>)<br/>
| <span class="id"><a name="pbeta_switch">pbeta_switch</a></span> : <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">l1</span> <span class="id">l2</span>, <span class="id">pbeta</span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> <span class="id">pt1</span> <span class="id">pt2</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">pt1</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">pt2</span> /\ <span class="id">pbeta</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">pt1</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">pt2</span>)) <span class="id">l1</span> <span class="id">l2</span> -&gt; <span class="id">pbeta</span> (<span class="id"><a href="STerm.html#switch">switch</a></span> <span class="id">t1</span> <span class="id">l1</span>) (<span class="id"><a href="STerm.html#switch">switch</a></span> <span class="id">t2</span> <span class="id">l2</span>)<br/>
| <span class="id"><a name="pbeta_switch_redex">pbeta_switch_redex</a></span> : <span class="kwd">forall</span> <span class="id">lt1</span> <span class="id">lt2</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">l1</span> <span class="id">l2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id">pbeta</span> <span class="id">lt1</span> <span class="id">lt2</span> -&gt; <span class="id">pbeta</span> <span class="id">t1</span> <span class="id">t2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pbeta</span> (<span class="id"><a href="STerm.html#switch">switch</a></span> (<span class="id"><a href="STerm.html#constr">constr</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l1</span>) <span class="id">lt1</span>) (<span class="id">l1</span> ++ (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">lt1</span>, <span class="id">t1</span>) :: <span class="id">l2</span>)) (<span class="id"><a href="STerm.html#subst">subst</a></span> (<span class="id"><a href="STerm.html#read_env">read_env</a></span> <span class="id">lt2</span>) <span class="id">t2</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="pbeta_refl">pbeta_refl</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span>, <span class="id"><a href="Beta.html#pbeta">pbeta</a></span> <span class="id">t</span> <span class="id">t</span>.<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">t</span> <span class="kwd">using</span> <span class="id"><a href="STerm.html#term_ind2">term_ind2</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>. <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>. <span class="id">apply</span> <span class="id"><a href="Misc.html#Forall2_map_same">Forall2_map_same</a></span>. <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>; [<span class="id">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Misc.html#Forall2_map_same">Forall2_map_same</a></span>. <span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; [|<span class="id">exact</span> <span class="id">H</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> [<span class="id">p</span> <span class="id">t2</span>]; <span class="id">simpl</span>; <span class="id">tauto</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="pbeta_ind2">pbeta_ind2</a></span> (<span class="id">P</span> : <span class="id"><a href="STerm.html#term">term</a></span> -&gt; <span class="id"><a href="STerm.html#term">term</a></span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hvar</span> : <span class="kwd">forall</span> <span class="id">n</span>, <span class="id">P</span> (<span class="id"><a href="STerm.html#var">var</a></span> <span class="id">n</span>) (<span class="id"><a href="STerm.html#var">var</a></span> <span class="id">n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hdvar</span> : <span class="kwd">forall</span> <span class="id">n</span>, <span class="id">P</span> (<span class="id"><a href="STerm.html#dvar">dvar</a></span> <span class="id">n</span>) (<span class="id"><a href="STerm.html#dvar">dvar</a></span> <span class="id">n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Happ</span> : <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">t3</span> <span class="id">t4</span>, <span class="id"><a href="Beta.html#pbeta">pbeta</a></span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id">P</span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id"><a href="Beta.html#pbeta">pbeta</a></span> <span class="id">t3</span> <span class="id">t4</span> -&gt; <span class="id">P</span> <span class="id">t3</span> <span class="id">t4</span> -&gt; <span class="id">P</span> (<span class="id"><a href="STerm.html#app">app</a></span> <span class="id">t1</span> <span class="id">t3</span>) (<span class="id"><a href="STerm.html#app">app</a></span> <span class="id">t2</span> <span class="id">t4</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hredex</span> : <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">t3</span> <span class="id">t4</span>, <span class="id"><a href="Beta.html#pbeta">pbeta</a></span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id">P</span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id"><a href="Beta.html#pbeta">pbeta</a></span> <span class="id">t3</span> <span class="id">t4</span> -&gt; <span class="id">P</span> <span class="id">t3</span> <span class="id">t4</span> -&gt; <span class="id">P</span> (<span class="id"><a href="STerm.html#app">app</a></span> (<span class="id"><a href="STerm.html#abs">abs</a></span> <span class="id">t1</span>) <span class="id">t3</span>) (<span class="id"><a href="STerm.html#subst1">subst1</a></span> <span class="id">t4</span> <span class="id">t2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hlam</span> : <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span>, <span class="id"><a href="Beta.html#pbeta">pbeta</a></span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id">P</span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id">P</span> (<span class="id"><a href="STerm.html#abs">abs</a></span> <span class="id">t1</span>) (<span class="id"><a href="STerm.html#abs">abs</a></span> <span class="id">t2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hconstr</span> : <span class="kwd">forall</span> <span class="id">tag</span> <span class="id">l1</span> <span class="id">l2</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id"><a href="Beta.html#pbeta">pbeta</a></span> <span class="id">l1</span> <span class="id">l2</span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id">P</span> <span class="id">l1</span> <span class="id">l2</span> -&gt; <span class="id">P</span> (<span class="id"><a href="STerm.html#constr">constr</a></span> <span class="id">tag</span> <span class="id">l1</span>) (<span class="id"><a href="STerm.html#constr">constr</a></span> <span class="id">tag</span> <span class="id">l2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hswitch</span> : <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">l1</span> <span class="id">l2</span>, <span class="id"><a href="Beta.html#pbeta">pbeta</a></span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id">P</span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> <span class="id">pt1</span> <span class="id">pt2</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">pt1</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">pt2</span> /\ <span class="id"><a href="Beta.html#pbeta">pbeta</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">pt1</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">pt2</span>)) <span class="id">l1</span> <span class="id">l2</span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> <span class="id">pt1</span> <span class="id">pt2</span> =&gt; <span class="id">P</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">pt1</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">pt2</span>)) <span class="id">l1</span> <span class="id">l2</span> -&gt; <span class="id">P</span> (<span class="id"><a href="STerm.html#switch">switch</a></span> <span class="id">t1</span> <span class="id">l1</span>) (<span class="id"><a href="STerm.html#switch">switch</a></span> <span class="id">t2</span> <span class="id">l2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Hswitch_redex</span> : <span class="kwd">forall</span> <span class="id">lt1</span> <span class="id">lt2</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">l1</span> <span class="id">l2</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id"><a href="Beta.html#pbeta">pbeta</a></span> <span class="id">lt1</span> <span class="id">lt2</span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id">P</span> <span class="id">lt1</span> <span class="id">lt2</span> -&gt; <span class="id"><a href="Beta.html#pbeta">pbeta</a></span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id">P</span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id">P</span> (<span class="id"><a href="STerm.html#switch">switch</a></span> (<span class="id"><a href="STerm.html#constr">constr</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l1</span>) <span class="id">lt1</span>) (<span class="id">l1</span> ++ (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">lt1</span>, <span class="id">t1</span>) :: <span class="id">l2</span>)) (<span class="id"><a href="STerm.html#subst">subst</a></span> (<span class="id"><a href="STerm.html#read_env">read_env</a></span> <span class="id">lt2</span>) <span class="id">t2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">t1</span> <span class="id">t2</span> : <span class="id"><a href="STerm.html#term">term</a></span>) (<span class="id">H</span> : <span class="id"><a href="Beta.html#pbeta">pbeta</a></span> <span class="id">t1</span> <span class="id">t2</span>) {<span class="id">struct</span> <span class="id">H</span>} : <span class="id">P</span> <span class="id">t1</span> <span class="id">t2</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">rec</span> := <span class="id">pbeta_ind2</span> <span class="id">P</span> <span class="id">Hvar</span> <span class="id">Hdvar</span> <span class="id">Happ</span> <span class="id">Hredex</span> <span class="id">Hlam</span> <span class="id">Hconstr</span> <span class="id">Hswitch</span> <span class="id">Hswitch_redex</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">H</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Beta.html#pbeta_var">pbeta_var</a></span> <span class="id">n</span> =&gt; <span class="id">Hvar</span> <span class="id">n</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Beta.html#pbeta_dvar">pbeta_dvar</a></span> <span class="id">n</span> =&gt; <span class="id">Hdvar</span> <span class="id">n</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Beta.html#pbeta_app">pbeta_app</a></span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">t3</span> <span class="id">t4</span> <span class="id">H12</span> <span class="id">H34</span> =&gt; <span class="id">Happ</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">t3</span> <span class="id">t4</span> <span class="id">H12</span> (<span class="id">rec</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">H12</span>) <span class="id">H34</span> (<span class="id">rec</span> <span class="id">t3</span> <span class="id">t4</span> <span class="id">H34</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="Beta.html#pbeta_redex">pbeta_redex</a></span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">t3</span> <span class="id">t4</span> <span class="id">H12</span> <span class="id">H34</span> =&gt; <span class="id">Hredex</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">t3</span> <span class="id">t4</span> <span class="id">H12</span> (<span class="id">rec</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">H12</span>) <span class="id">H34</span> (<span class="id">rec</span> <span class="id">t3</span> <span class="id">t4</span> <span class="id">H34</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="Beta.html#pbeta_abs">pbeta_abs</a></span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">H12</span> =&gt; <span class="id">Hlam</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">H12</span> (<span class="id">rec</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">H12</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="Beta.html#pbeta_constr">pbeta_constr</a></span> <span class="id">tag</span> <span class="id">l1</span> <span class="id">l2</span> <span class="id">H12</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hconstr</span> <span class="id">tag</span> <span class="id">l1</span> <span class="id">l2</span> <span class="id">H12</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Misc.html#Forall2_impl_transparent">Forall2_impl_transparent</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="Beta.html#pbeta">pbeta</a></span> <span class="id">P</span> <span class="id">l1</span> <span class="id">l2</span> <span class="id">rec</span> <span class="id">H12</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="Beta.html#pbeta_switch">pbeta_switch</a></span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">l1</span> <span class="id">l2</span> <span class="id">Ht</span> <span class="id">Hl</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hswitch</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">l1</span> <span class="id">l2</span> <span class="id">Ht</span> (<span class="id">rec</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">Ht</span>) <span class="id">Hl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="Misc.html#Forall2_impl_transparent">Forall2_impl_transparent</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">l1</span> <span class="id">l2</span> (<span class="kwd">fun</span> <span class="id">pt1</span> <span class="id">pt2</span> <span class="id">H</span> =&gt; <span class="id">rec</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">pt1</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">pt2</span>) (<span class="kwd">match</span> <span class="id">H</span> <span class="kwd">with</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> <span class="id">_</span> <span class="id">H2</span> =&gt; <span class="id">H2</span> <span class="kwd">end</span>)) <span class="id">Hl</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="Beta.html#pbeta_switch_redex">pbeta_switch_redex</a></span> <span class="id">lt1</span> <span class="id">lt2</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">l1</span> <span class="id">l2</span> <span class="id">Hl</span> <span class="id">Ht</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Hswitch_redex</span> <span class="id">lt1</span> <span class="id">lt2</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">l1</span> <span class="id">l2</span> <span class="id">Hl</span> (<span class="id"><a href="Misc.html#Forall2_impl_transparent">Forall2_impl_transparent</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="Beta.html#pbeta">pbeta</a></span> <span class="id">P</span> <span class="id">lt1</span> <span class="id">lt2</span> <span class="id">rec</span> <span class="id">Hl</span>) <span class="id">Ht</span> (<span class="id">rec</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">Ht</span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="beta_pbeta">beta_pbeta</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span>, <span class="id"><a href="Beta.html#beta">beta</a></span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id"><a href="Beta.html#pbeta">pbeta</a></span> <span class="id">t1</span> <span class="id">t2</span>.<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">Hbeta</span>. <span class="id">induction</span> <span class="id">Hbeta</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>; [<span class="id">assumption</span>|<span class="id">apply</span> <span class="id"><a href="Beta.html#pbeta_refl">pbeta_refl</a></span>].<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>; [<span class="id">apply</span> <span class="id"><a href="Beta.html#pbeta_refl">pbeta_refl</a></span>|<span class="id">assumption</span>].<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>; <span class="id">apply</span> <span class="id"><a href="Beta.html#pbeta_refl">pbeta_refl</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>; <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2_app">Forall2_app</a></span>; [|<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2_cons">Forall2_cons</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Misc.html#Forall2_map_same">Forall2_map_same</a></span>, <span class="id"><a href="Misc.html#Forall_True">Forall_True</a></span>; <span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Beta.html#pbeta_refl">pbeta_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Misc.html#Forall2_map_same">Forall2_map_same</a></span>, <span class="id"><a href="Misc.html#Forall_True">Forall_True</a></span>; <span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Beta.html#pbeta_refl">pbeta_refl</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Misc.html#Forall2_map_same">Forall2_map_same</a></span>, <span class="id"><a href="Misc.html#Forall_True">Forall_True</a></span>; <span class="id">intros</span>; <span class="id">split</span>; [<span class="id">reflexivity</span>|<span class="id">apply</span> <span class="id"><a href="Beta.html#pbeta_refl">pbeta_refl</a></span>].<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Beta.html#pbeta_refl">pbeta_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2_app">Forall2_app</a></span>; [|<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2_cons">Forall2_cons</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">apply</span> <span class="id"><a href="Misc.html#Forall2_map_same">Forall2_map_same</a></span>, <span class="id"><a href="Misc.html#Forall_True">Forall_True</a></span>; <span class="id">intros</span>; <span class="id">split</span>; [<span class="id">reflexivity</span>|<span class="id">apply</span> <span class="id"><a href="Beta.html#pbeta_refl">pbeta_refl</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">split</span>; [<span class="id">reflexivity</span>|<span class="id">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">apply</span> <span class="id"><a href="Misc.html#Forall2_map_same">Forall2_map_same</a></span>, <span class="id"><a href="Misc.html#Forall_True">Forall_True</a></span>; <span class="id">intros</span>; <span class="id">split</span>; [<span class="id">reflexivity</span>|<span class="id">apply</span> <span class="id"><a href="Beta.html#pbeta_refl">pbeta_refl</a></span>].<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>; [|<span class="id">apply</span> <span class="id"><a href="Beta.html#pbeta_refl">pbeta_refl</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Misc.html#Forall2_map_same">Forall2_map_same</a></span>, <span class="id"><a href="Misc.html#Forall_True">Forall_True</a></span>; <span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Beta.html#pbeta_refl">pbeta_refl</a></span>.<br/>
Qed.</details>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="pbeta_star_beta">pbeta_star_beta</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span>, <span class="id"><a href="Beta.html#pbeta">pbeta</a></span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id"><a href="Rewrite.html#star">star</a></span> <span class="id"><a href="Beta.html#beta">beta</a></span> <span class="id">t1</span> <span class="id">t2</span>.<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">Hpbeta</span>. <span class="id">induction</span> <span class="id">Hpbeta</span> <span class="kwd">using</span> <span class="id"><a href="Beta.html#pbeta_ind2">pbeta_ind2</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Beta.html#star_beta_app">star_beta_app</a></span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_compose">star_compose</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Beta.html#star_beta_app">star_beta_app</a></span>; [|<span class="id">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Beta.html#star_beta_abs">star_beta_abs</a></span>; <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">econstructor</span>; [|<span class="id">constructor</span>]. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_map_impl">star_map_impl</a></span> <span class="kwd">with</span> (<span class="id">RA</span> := <span class="id"><a href="Beta.html#beta">beta</a></span>) (<span class="id">f</span> := <span class="id"><a href="STerm.html#abs">abs</a></span>); [|<span class="id">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Beta.html#star_beta_constr">star_beta_constr</a></span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Beta.html#star_beta_switch">star_beta_switch</a></span>; [<span class="id">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Misc.html#Forall2_impl">Forall2_impl</a></span>; [|<span class="id">apply</span> <span class="id"><a href="Misc.html#Forall2_and">Forall2_and</a></span>; [<span class="id">apply</span> <span class="id">H</span>|<span class="id">apply</span> <span class="id">H0</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_compose">star_compose</a></span>; [|<span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_compose">star_compose</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_map_impl">star_map_impl</a></span> <span class="kwd">with</span> (<span class="id">RA</span> := <span class="id"><a href="Beta.html#beta">beta</a></span>) (<span class="id">f</span> := <span class="kwd">fun</span> <span class="id">t</span> =&gt; <span class="id"><a href="STerm.html#switch">switch</a></span> <span class="id">t</span> <span class="id">_</span>); [<span class="id">intros</span>; <span class="id">constructor</span>; <span class="id">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Beta.html#star_beta_constr">star_beta_constr</a></span>. <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_map_impl">star_map_impl</a></span> <span class="kwd">with</span> (<span class="id">RA</span> := <span class="id"><a href="Beta.html#beta">beta</a></span>) (<span class="id">f</span> := <span class="kwd">fun</span> <span class="id">t</span> =&gt; <span class="id"><a href="STerm.html#switch">switch</a></span> <span class="id">_</span> (<span class="id">_</span> ++ (<span class="id">_</span>, <span class="id">t</span>) :: <span class="id">_</span>)); [|<span class="id">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">simpl</span>; <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">econstructor</span>; [|<span class="id">constructor</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="Misc.html#Forall2_length">Forall2_length</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="pbeta_ren">pbeta_ren</a></span> : <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">r</span>, <span class="id"><a href="Beta.html#pbeta">pbeta</a></span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id"><a href="Beta.html#pbeta">pbeta</a></span> (<span class="id"><a href="STerm.html#ren_term">ren_term</a></span> <span class="id">r</span> <span class="id">t1</span>) (<span class="id"><a href="STerm.html#ren_term">ren_term</a></span> <span class="id">r</span> <span class="id">t2</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">r</span> <span class="id">H</span>. <span class="id">revert</span> <span class="id">r</span>. <span class="id">induction</span> <span class="id">H</span> <span class="kwd">using</span> <span class="id"><a href="Beta.html#pbeta_ind2">pbeta_ind2</a></span>; <span class="id">intros</span> <span class="id">r</span>; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>; [<span class="id">apply</span> <span class="id">IHpbeta1</span>|<span class="id">apply</span> <span class="id">IHpbeta2</span>].<br/>
&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="STerm.html#ren_subst1">ren_subst1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; [<span class="id">apply</span> <span class="id">IHpbeta1</span>|<span class="id">apply</span> <span class="id">IHpbeta2</span>].<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>; <span class="id">apply</span> <span class="id">IHpbeta</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>. <span class="id">apply</span> <span class="id"><a href="Misc.html#Forall2_map_left">Forall2_map_left</a></span>, <span class="id"><a href="Misc.html#Forall2_map_right">Forall2_map_right</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Misc.html#Forall2_impl">Forall2_impl</a></span>; [|<span class="id">eassumption</span>]. <span class="id">intros</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>; [<span class="id">apply</span> <span class="id">IHpbeta</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Misc.html#Forall2_map_left">Forall2_map_left</a></span>, <span class="id"><a href="Misc.html#Forall2_map_right">Forall2_map_right</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Misc.html#Forall2_impl">Forall2_impl</a></span>; [|<span class="id">apply</span> <span class="id"><a href="Misc.html#Forall2_and">Forall2_and</a></span>; [<span class="id">apply</span> <span class="id">H0</span>|<span class="id">apply</span> <span class="id">H1</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> [<span class="id">p3</span> <span class="id">t3</span>] [<span class="id">p4</span> <span class="id">t4</span>] [[<span class="id">Heq</span> <span class="id">Hbeta</span>] <span class="id">IH</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; [<span class="id">assumption</span>|]. <span class="id">simpl</span> <span class="kwd">in</span> *. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">IH</span>.<br/>
&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>. <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ereplace</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l1</span>); [|<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ereplace</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">lt1</span>); [|<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="STerm.html#ren_read_env">ren_read_env</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id"><a href="Misc.html#Forall2_map_left">Forall2_map_left</a></span>, <span class="id"><a href="Misc.html#Forall2_map_right">Forall2_map_right</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Misc.html#Forall2_impl">Forall2_impl</a></span>; [|<span class="id">exact</span> <span class="id">H0</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>. <span class="id">intros</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>, (<span class="id"><a href="Misc.html#Forall2_length">Forall2_length</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">IHpbeta</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="pbeta_subst">pbeta_subst</a></span> : <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">us1</span> <span class="id">us2</span>, <span class="id"><a href="Beta.html#pbeta">pbeta</a></span> <span class="id">t1</span> <span class="id">t2</span> -&gt; (<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Beta.html#pbeta">pbeta</a></span> (<span class="id">us1</span> <span class="id">n</span>) (<span class="id">us2</span> <span class="id">n</span>)) -&gt; <span class="id"><a href="Beta.html#pbeta">pbeta</a></span> (<span class="id"><a href="STerm.html#subst">subst</a></span> <span class="id">us1</span> <span class="id">t1</span>) (<span class="id"><a href="STerm.html#subst">subst</a></span> <span class="id">us2</span> <span class="id">t2</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">us1</span> <span class="id">us2</span> <span class="id">H</span>. <span class="id">revert</span> <span class="id">us1</span> <span class="id">us2</span>. <span class="id">induction</span> <span class="id">H</span> <span class="kwd">using</span> <span class="id"><a href="Beta.html#pbeta_ind2">pbeta_ind2</a></span>; <span class="id">intros</span> <span class="id">us1</span> <span class="id">us2</span> <span class="id">Hus</span>; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id">Hus</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>; [<span class="id">apply</span> <span class="id">IHpbeta1</span>|<span class="id">apply</span> <span class="id">IHpbeta2</span>]; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="STerm.html#subst_subst1">subst_subst1</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; [<span class="id">apply</span> <span class="id">IHpbeta1</span>|<span class="id">apply</span> <span class="id">IHpbeta2</span>; <span class="id">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> [|<span class="id">n</span>]; <span class="id">simpl</span>; [<span class="id">constructor</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="STerm.html#comp">comp</a></span>. <span class="id">apply</span> <span class="id"><a href="Beta.html#pbeta_ren">pbeta_ren</a></span>, <span class="id">Hus</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>. <span class="id">apply</span> <span class="id">IHpbeta</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> [|<span class="id">n</span>]; <span class="id">simpl</span>; [<span class="id">constructor</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="STerm.html#comp">comp</a></span>. <span class="id">apply</span> <span class="id"><a href="Beta.html#pbeta_ren">pbeta_ren</a></span>, <span class="id">Hus</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>. <span class="id">apply</span> <span class="id"><a href="Misc.html#Forall2_map_left">Forall2_map_left</a></span>, <span class="id"><a href="Misc.html#Forall2_map_right">Forall2_map_right</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Misc.html#Forall2_impl">Forall2_impl</a></span>; [|<span class="id">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id">IHpbeta</span>. <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id"><a href="Misc.html#Forall2_map_left">Forall2_map_left</a></span>, <span class="id"><a href="Misc.html#Forall2_map_right">Forall2_map_right</a></span>. <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Misc.html#Forall2_impl">Forall2_impl</a></span>; [|<span class="id">apply</span> <span class="id"><a href="Misc.html#Forall2_and">Forall2_and</a></span>; [<span class="id">apply</span> <span class="id">H0</span>|<span class="id">apply</span> <span class="id">H1</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> [<span class="id">p3</span> <span class="id">t3</span>] [<span class="id">p4</span> <span class="id">t4</span>] [[<span class="id">Heq</span> <span class="id">Hbeta</span>] <span class="id">IH</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; [<span class="id">assumption</span>|]. <span class="id">simpl</span> <span class="kwd">in</span> *. <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">n</span>. <span class="id">unfold</span> <span class="id"><a href="STerm.html#liftn_subst">liftn_subst</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.Compare_dec.html#le_lt_dec">le_lt_dec</a></span>; [<span class="id">apply</span> <span class="id"><a href="Beta.html#pbeta_ren">pbeta_ren</a></span>; <span class="id">apply</span> <span class="id">Hus</span>|<span class="id">apply</span> <span class="id"><a href="Beta.html#pbeta_refl">pbeta_refl</a></span>].<br/>
&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>. <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ereplace</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l1</span>); [|<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ereplace</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">lt1</span>); [|<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="STerm.html#subst_read_env">subst_read_env</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id"><a href="Misc.html#Forall2_map_left">Forall2_map_left</a></span>, <span class="id"><a href="Misc.html#Forall2_map_right">Forall2_map_right</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Misc.html#Forall2_impl">Forall2_impl</a></span>; [|<span class="id">exact</span> <span class="id">H0</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>. <span class="id">intros</span>; <span class="id">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_length">map_length</a></span>, (<span class="id"><a href="Misc.html#Forall2_length">Forall2_length</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">IHpbeta</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">n</span>; <span class="id">unfold</span> <span class="id"><a href="STerm.html#liftn_subst">liftn_subst</a></span>. <span class="id">destruct</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.Compare_dec.html#le_lt_dec">le_lt_dec</a></span>; [<span class="id">apply</span> <span class="id"><a href="Beta.html#pbeta_ren">pbeta_ren</a></span>; <span class="id">apply</span> <span class="id">Hus</span>|<span class="id">apply</span> <span class="id"><a href="Beta.html#pbeta_refl">pbeta_refl</a></span>].<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="read_env_pbeta">read_env_pbeta</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l1</span> <span class="id">l2</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> <span class="id"><a href="Beta.html#pbeta">pbeta</a></span> <span class="id">l1</span> <span class="id">l2</span> -&gt; <span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Beta.html#pbeta">pbeta</a></span> (<span class="id"><a href="STerm.html#read_env">read_env</a></span> <span class="id">l1</span> <span class="id">n</span>) (<span class="id"><a href="STerm.html#read_env">read_env</a></span> <span class="id">l2</span> <span class="id">n</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">l1</span> <span class="id">l2</span> <span class="id">H</span> <span class="id">n</span>. <span class="id">unfold</span> <span class="id"><a href="STerm.html#read_env">read_env</a></span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#nth_error">nth_error</a></span> <span class="id">l1</span> <span class="id">n</span>) <span class="id">eqn</span>:<span class="id">H1</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#nth_error">nth_error</a></span> <span class="id">l2</span> <span class="id">n</span>) <span class="id">eqn</span>:<span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id"><a href="Misc.html#nth_error_Forall2_iff">nth_error_Forall2_iff</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">eapply</span> <span class="id">H</span>; <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">erewrite</span> <span class="id"><a href="Misc.html#nth_error_Forall2_None">nth_error_Forall2_None</a></span> <span class="kwd">in</span> <span class="id">H2</span>; [|<span class="id">eapply</span> <span class="id"><a href="Misc.html#Forall2_comm">Forall2_comm</a></span>; <span class="id">exact</span> <span class="id">H</span>]. <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;- <span class="id">erewrite</span> <span class="id"><a href="Misc.html#nth_error_Forall2_None">nth_error_Forall2_None</a></span> <span class="kwd">in</span> <span class="id">H1</span>; [|<span class="id">exact</span> <span class="id">H</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">H1</span>. <span class="id">rewrite</span> <span class="id"><a href="Misc.html#nth_error_Forall2_iff">nth_error_Forall2_iff</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">rewrite</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Beta.html#pbeta_refl">pbeta_refl</a></span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="pbeta_diamond">pbeta_diamond</a></span> : <span class="id"><a href="Rewrite.html#diamond">diamond</a></span> <span class="id"><a href="Beta.html#pbeta">pbeta</a></span>.<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">t3</span> <span class="id">H12</span>. <span class="id">revert</span> <span class="id">t3</span>. <span class="id">induction</span> <span class="id">H12</span> <span class="kwd">using</span> <span class="id"><a href="Beta.html#pbeta_ind2">pbeta_ind2</a></span>; <span class="id">intros</span> <span class="id">t5</span> <span class="id">H15</span>; <span class="id">inversion</span> <span class="id">H15</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;- <span class="kwd">exists</span> (<span class="id"><a href="STerm.html#var">var</a></span> <span class="id">n</span>). <span class="id">split</span>; <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="kwd">exists</span> (<span class="id"><a href="STerm.html#dvar">dvar</a></span> <span class="id">n</span>). <span class="id">split</span>; <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> (<span class="id">IHpbeta1</span> <span class="id">t6</span>) <span class="kwd">as</span> (<span class="id">t7</span> &amp; <span class="id">H27</span> &amp; <span class="id">H67</span>); [<span class="id">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">IHpbeta2</span> <span class="id">t8</span>) <span class="kwd">as</span> (<span class="id">t9</span> &amp; <span class="id">H49</span> &amp; <span class="id">H89</span>); [<span class="id">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="STerm.html#app">app</a></span> <span class="id">t7</span> <span class="id">t9</span>). <span class="id">split</span>; <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> (<span class="id">IHpbeta1</span> (<span class="id"><a href="STerm.html#abs">abs</a></span> <span class="id">t6</span>)) <span class="kwd">as</span> (<span class="id">t7</span> &amp; <span class="id">H27</span> &amp; <span class="id">H67</span>); [<span class="id">constructor</span>; <span class="id">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">IHpbeta2</span> <span class="id">t8</span>) <span class="kwd">as</span> (<span class="id">t9</span> &amp; <span class="id">H49</span> &amp; <span class="id">H89</span>); [<span class="id">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inversion</span> <span class="id">H67</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inversion</span> <span class="id">H12_</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="STerm.html#subst1">subst1</a></span> <span class="id">t9</span> <span class="id">t5</span>). <span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">constructor</span>; [<span class="id">inversion</span> <span class="id">H27</span>; <span class="id">subst</span>; <span class="id">assumption</span>|<span class="id">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Beta.html#pbeta_subst">pbeta_subst</a></span>; [<span class="id">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> [|<span class="id">n</span>]; <span class="id">simpl</span>; [<span class="id">assumption</span>|<span class="id">constructor</span>].<br/>
&nbsp;&nbsp;- <span class="id">inversion</span> <span class="id">H1</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">IHpbeta1</span> <span class="id">t5</span>) <span class="kwd">as</span> (<span class="id">t7</span> &amp; <span class="id">H27</span> &amp; <span class="id">H57</span>); [<span class="id">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">IHpbeta2</span> <span class="id">t8</span>) <span class="kwd">as</span> (<span class="id">t9</span> &amp; <span class="id">H49</span> &amp; <span class="id">H89</span>); [<span class="id">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="STerm.html#subst1">subst1</a></span> <span class="id">t9</span> <span class="id">t7</span>). <span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Beta.html#pbeta_subst">pbeta_subst</a></span>; [<span class="id">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> [|<span class="id">n</span>]; <span class="id">simpl</span>; [<span class="id">assumption</span>|<span class="id">constructor</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> (<span class="id">IHpbeta1</span> <span class="id">t6</span>) <span class="kwd">as</span> (<span class="id">t7</span> &amp; <span class="id">H27</span> &amp; <span class="id">H67</span>); [<span class="id">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">IHpbeta2</span> <span class="id">t8</span>) <span class="kwd">as</span> (<span class="id">t9</span> &amp; <span class="id">H49</span> &amp; <span class="id">H89</span>); [<span class="id">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="STerm.html#subst1">subst1</a></span> <span class="id">t9</span> <span class="id">t7</span>). <span class="id">split</span>; <span class="id">apply</span> <span class="id"><a href="Beta.html#pbeta_subst">pbeta_subst</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> [|<span class="id">n</span>]; <span class="id">simpl</span>; [<span class="id">assumption</span>|<span class="id">constructor</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> [|<span class="id">n</span>]; <span class="id">simpl</span>; [<span class="id">assumption</span>|<span class="id">constructor</span>].<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> (<span class="id">IHpbeta</span> <span class="id">t3</span>) <span class="kwd">as</span> (<span class="id">t4</span> &amp; <span class="id">H24</span> &amp; <span class="id">H34</span>); [<span class="id">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="STerm.html#abs">abs</a></span> <span class="id">t4</span>); <span class="id">split</span>; <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">assert</span> (<span class="id">H23</span> := <span class="id"><a href="Misc.html#Forall3_from_Forall2">Forall3_from_Forall2</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span> <span class="id">H4</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Misc.html#Forall3_impl">Forall3_impl</a></span> <span class="kwd">in</span> <span class="id">H23</span>; [|<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span> <span class="id">H123</span>; <span class="id">exact</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> <span class="id">H123</span> <span class="id">z</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> <span class="id">H123</span>))].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Misc.html#Forall3_select23">Forall3_select23</a></span> <span class="kwd">in</span> <span class="id">H23</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Misc.html#Forall2_exists_Forall3">Forall2_exists_Forall3</a></span> <span class="kwd">in</span> <span class="id">H23</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H23</span> <span class="kwd">as</span> (<span class="id">l4</span> &amp; <span class="id">Hl4</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="STerm.html#constr">constr</a></span> <span class="id">tag</span> <span class="id">l4</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Misc.html#Forall3_select13">Forall3_select13</a></span>; <span class="id">eapply</span> <span class="id"><a href="Misc.html#Forall3_impl">Forall3_impl</a></span>; [|<span class="id">apply</span> <span class="id">Hl4</span>]. <span class="id">intros</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Misc.html#Forall3_select23">Forall3_select23</a></span>; <span class="id">eapply</span> <span class="id"><a href="Misc.html#Forall3_impl">Forall3_impl</a></span>; [|<span class="id">apply</span> <span class="id">Hl4</span>]. <span class="id">intros</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">assert</span> (<span class="id">H23</span> := <span class="id"><a href="Misc.html#Forall3_from_Forall2">Forall3_from_Forall2</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="Misc.html#Forall2_and">Forall2_and</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span> <span class="id">H0</span>) <span class="id">H5</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Misc.html#Forall3_impl">Forall3_impl</a></span> <span class="kwd">in</span> <span class="id">H23</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Misc.html#Forall3_select23">Forall3_select23</a></span> <span class="kwd">in</span> <span class="id">H23</span>. <span class="id">eapply</span> <span class="id"><a href="Misc.html#Forall2_exists_Forall3">Forall2_exists_Forall3</a></span> <span class="kwd">in</span> <span class="id">H23</span>. <span class="id">destruct</span> <span class="id">H23</span> <span class="kwd">as</span> (<span class="id">l4</span> &amp; <span class="id">Hl4</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">IHpbeta</span> <span class="id">_</span> <span class="id">H3</span>) <span class="kwd">as</span> (<span class="id">t4</span> &amp; <span class="id">Ht4</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="STerm.html#switch">switch</a></span> <span class="id">t4</span> <span class="id">l4</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">eapply</span> <span class="id"><a href="Misc.html#Forall3_select13">Forall3_select13</a></span>; <span class="id">eapply</span> <span class="id"><a href="Misc.html#Forall3_impl">Forall3_impl</a></span>; [|<span class="id">apply</span> <span class="id">Hl4</span>]. <span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span> <span class="id">Hxyz</span>; <span class="id">refine</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> <span class="id">Hxyz</span>). <span class="id">shelve</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">eapply</span> <span class="id"><a href="Misc.html#Forall3_select23">Forall3_select23</a></span>; <span class="id">eapply</span> <span class="id"><a href="Misc.html#Forall3_impl">Forall3_impl</a></span>; [|<span class="id">apply</span> <span class="id">Hl4</span>]. <span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span> <span class="id">Hxyz</span>; <span class="id">exact</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> <span class="id">Hxyz</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">simpl</span>. <span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span> (((<span class="id">Ha</span> &amp; <span class="id">Hb</span>) &amp; <span class="id">Hc</span>) &amp; <span class="id">Hd</span> &amp; <span class="id">He</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">Hc</span> <span class="id">_</span> <span class="id">He</span>) <span class="kwd">as</span> (<span class="id">t4</span> &amp; <span class="id">Ht4</span>). <span class="kwd">exists</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">z</span>, <span class="id">t4</span>). <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intuition</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;- <span class="id">assert</span> (<span class="id">H6</span> := <span class="id"><a href="Misc.html#Forall2_and">Forall2_and</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span> <span class="id">H</span>). <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2_app_inv_l">Forall2_app_inv_l</a></span> <span class="kwd">in</span> <span class="id">H6</span>. <span class="id">destruct</span> <span class="id">H6</span> <span class="kwd">as</span> (<span class="id">l2a</span> &amp; <span class="id">l2b</span> &amp; <span class="id">H6a</span> &amp; <span class="id">H6b</span> &amp; <span class="id">H6eq</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inversion</span> <span class="id">H6b</span>; <span class="id">subst</span>; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">y</span> <span class="kwd">as</span> [<span class="id">p</span> <span class="id">t1</span>]; <span class="id">destruct</span> <span class="id">H4</span> <span class="kwd">as</span> [<span class="id">H4</span> [<span class="id">Hp</span> <span class="id">Ht1</span>]]; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">H4</span> <span class="id">_</span> <span class="id">H5</span>) <span class="kwd">as</span> (<span class="id">t4</span> &amp; <span class="id">Ht4</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inversion</span> <span class="id">H12</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">IHpbeta</span> (<span class="id"><a href="STerm.html#constr">constr</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l0</span>) <span class="id">lt2</span>) <span class="id">ltac</span>:(<span class="id">constructor</span>; <span class="id">assumption</span>)) <span class="kwd">as</span> (<span class="id">t5</span> &amp; <span class="id">Ht5a</span> &amp; <span class="id">Ht5b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inversion</span> <span class="id">Ht5a</span>; <span class="id">subst</span>. <span class="id">inversion</span> <span class="id">Ht5b</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="STerm.html#subst">subst</a></span> (<span class="id"><a href="STerm.html#read_env">read_env</a></span> <span class="id">l4</span>) <span class="id">t4</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> (<span class="id"><a href="Misc.html#Forall2_length">Forall2_length</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H6a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="Misc.html#Forall2_length">Forall2_length</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H8</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Beta.html#pbeta_subst">pbeta_subst</a></span>; [<span class="id">tauto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Beta.html#read_env_pbeta">read_env_pbeta</a></span>. <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2_app_inv_l">Forall2_app_inv_l</a></span> <span class="kwd">in</span> <span class="id">H5</span>. <span class="id">destruct</span> <span class="id">H5</span> <span class="kwd">as</span> (<span class="id">l2a</span> &amp; <span class="id">l2b</span> &amp; <span class="id">H5a</span> &amp; <span class="id">H5b</span> &amp; <span class="id">H5eq</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inversion</span> <span class="id">H5b</span>; <span class="id">subst</span>; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">y</span> <span class="kwd">as</span> [<span class="id">p</span> <span class="id">t4</span>]; <span class="id">destruct</span> <span class="id">H4</span> <span class="kwd">as</span> [<span class="id">Hp</span> <span class="id">Ht4</span>]; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">IHpbeta</span> <span class="id">_</span> <span class="id">Ht4</span>) <span class="kwd">as</span> (<span class="id">t5</span> &amp; <span class="id">Ht5</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inversion</span> <span class="id">H3</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">H7</span> := <span class="id"><a href="Misc.html#Forall3_from_Forall2">Forall3_from_Forall2</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span> <span class="id">H5</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Misc.html#Forall3_impl">Forall3_impl</a></span> <span class="kwd">in</span> <span class="id">H7</span>; [|<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span> <span class="id">Hxyz</span>; <span class="id">exact</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> <span class="id">Hxyz</span> <span class="id">z</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> <span class="id">Hxyz</span>))].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Misc.html#Forall3_select23">Forall3_select23</a></span>, <span class="id"><a href="Misc.html#Forall2_exists_Forall3">Forall2_exists_Forall3</a></span> <span class="kwd">in</span> <span class="id">H7</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H7</span> <span class="kwd">as</span> (<span class="id">l4</span> &amp; <span class="id">Hl4</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="STerm.html#subst">subst</a></span> (<span class="id"><a href="STerm.html#read_env">read_env</a></span> <span class="id">l4</span>) <span class="id">t5</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Beta.html#pbeta_subst">pbeta_subst</a></span>; [<span class="id">tauto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Beta.html#read_env_pbeta">read_env_pbeta</a></span>. <span class="id">eapply</span> <span class="id"><a href="Misc.html#Forall3_select13">Forall3_select13</a></span>, <span class="id"><a href="Misc.html#Forall3_impl">Forall3_impl</a></span>, <span class="id">Hl4</span>. <span class="id">intros</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> (<span class="id"><a href="Misc.html#Forall2_length">Forall2_length</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H5a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id"><a href="Misc.html#Forall2_length">Forall2_length</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H5</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; [|<span class="id">tauto</span>]. <span class="id">eapply</span> <span class="id"><a href="Misc.html#Forall3_select23">Forall3_select23</a></span>, <span class="id"><a href="Misc.html#Forall3_impl">Forall3_impl</a></span>, <span class="id">Hl4</span>. <span class="id">intros</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Misc.html#list_app_eq_length">list_app_eq_length</a></span> <span class="kwd">in</span> <span class="id">H4</span>; [|<span class="id">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H4</span> <span class="kwd">as</span> (? &amp; [=]); <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">IHpbeta</span> <span class="id">_</span> <span class="id">H6</span>) <span class="kwd">as</span> (<span class="id">t4</span> &amp; <span class="id">Ht4</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">assert</span> (<span class="id">H23</span> := <span class="id"><a href="Misc.html#Forall3_from_Forall2">Forall3_from_Forall2</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span> <span class="id">H5</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Misc.html#Forall3_impl">Forall3_impl</a></span> <span class="kwd">in</span> <span class="id">H23</span>; [|<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span> <span class="id">H123</span>; <span class="id">exact</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> <span class="id">H123</span> <span class="id">z</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> <span class="id">H123</span>))].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Misc.html#Forall3_select23">Forall3_select23</a></span> <span class="kwd">in</span> <span class="id">H23</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Misc.html#Forall2_exists_Forall3">Forall2_exists_Forall3</a></span> <span class="kwd">in</span> <span class="id">H23</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H23</span> <span class="kwd">as</span> (<span class="id">lt4</span> &amp; <span class="id">Hlt4</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="STerm.html#subst">subst</a></span> (<span class="id"><a href="STerm.html#read_env">read_env</a></span> <span class="id">lt4</span>) <span class="id">t4</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">eapply</span> <span class="id"><a href="Beta.html#pbeta_subst">pbeta_subst</a></span>; <span class="id">try</span> <span class="id">apply</span> <span class="id">Ht4</span>; <span class="id">apply</span> <span class="id"><a href="Beta.html#read_env_pbeta">read_env_pbeta</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Misc.html#Forall3_select13">Forall3_select13</a></span>, <span class="id"><a href="Misc.html#Forall3_impl">Forall3_impl</a></span>, <span class="id">Hlt4</span>; <span class="id">intros</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Misc.html#Forall3_select23">Forall3_select23</a></span>, <span class="id"><a href="Misc.html#Forall3_impl">Forall3_impl</a></span>, <span class="id">Hlt4</span>; <span class="id">intros</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">tauto</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="beta_confluent">beta_confluent</a></span> :<br/>
&nbsp;&nbsp;<span class="id"><a href="Rewrite.html#confluent">confluent</a></span> <span class="id"><a href="Beta.html#beta">beta</a></span>.<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Rewrite.html#diamond_ext">diamond_ext</a></span>; [|<span class="id">apply</span> <span class="id"><a href="Rewrite.html#diamond_is_confluent">diamond_is_confluent</a></span>, <span class="id"><a href="Beta.html#pbeta_diamond">pbeta_diamond</a></span>].<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Rewrite.html#between_star">between_star</a></span>; [<span class="id">apply</span> <span class="id"><a href="Beta.html#beta_pbeta">beta_pbeta</a></span>|<span class="id">apply</span> <span class="id"><a href="Beta.html#pbeta_star_beta">pbeta_star_beta</a></span>].<br/>
Qed.</details>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="iota">iota</a></span> <span class="id">defs</span> : <span class="id"><a href="STerm.html#term">term</a></span> -&gt; <span class="id"><a href="STerm.html#term">term</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
| <span class="id"><a name="iota_unfold">iota_unfold</a></span> : <span class="kwd">forall</span> <span class="id">k</span> <span class="id">t</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#nth_error">nth_error</a></span> <span class="id">defs</span> <span class="id">k</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">t</span> -&gt; <span class="id"><a href="STerm.html#closed_at">closed_at</a></span> <span class="id">t</span> 0 -&gt; <span class="id">iota</span> <span class="id">defs</span> (<span class="id"><a href="STerm.html#dvar">dvar</a></span> <span class="id">k</span>) <span class="id">t</span><br/>
| <span class="id"><a name="iota_app1">iota_app1</a></span> : <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">t3</span>, <span class="id">iota</span> <span class="id">defs</span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id">iota</span> <span class="id">defs</span> (<span class="id"><a href="STerm.html#app">app</a></span> <span class="id">t1</span> <span class="id">t3</span>) (<span class="id"><a href="STerm.html#app">app</a></span> <span class="id">t2</span> <span class="id">t3</span>)<br/>
| <span class="id"><a name="iota_app2">iota_app2</a></span> : <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">t3</span>, <span class="id">iota</span> <span class="id">defs</span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id">iota</span> <span class="id">defs</span> (<span class="id"><a href="STerm.html#app">app</a></span> <span class="id">t3</span> <span class="id">t1</span>) (<span class="id"><a href="STerm.html#app">app</a></span> <span class="id">t3</span> <span class="id">t2</span>)<br/>
| <span class="id"><a name="iota_abs">iota_abs</a></span> : <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span>, <span class="id">iota</span> <span class="id">defs</span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id">iota</span> <span class="id">defs</span> (<span class="id"><a href="STerm.html#abs">abs</a></span> <span class="id">t1</span>) (<span class="id"><a href="STerm.html#abs">abs</a></span> <span class="id">t2</span>)<br/>
| <span class="id"><a name="iota_constr">iota_constr</a></span> : <span class="kwd">forall</span> <span class="id">tag</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">l1</span> <span class="id">l2</span>, <span class="id">iota</span> <span class="id">defs</span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id">iota</span> <span class="id">defs</span> (<span class="id"><a href="STerm.html#constr">constr</a></span> <span class="id">tag</span> (<span class="id">l1</span> ++ <span class="id">t1</span> :: <span class="id">l2</span>)) (<span class="id"><a href="STerm.html#constr">constr</a></span> <span class="id">tag</span> (<span class="id">l1</span> ++ <span class="id">t2</span> :: <span class="id">l2</span>))<br/>
| <span class="id"><a name="iota_switch1">iota_switch1</a></span> : <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">l</span>, <span class="id">iota</span> <span class="id">defs</span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id">iota</span> <span class="id">defs</span> (<span class="id"><a href="STerm.html#switch">switch</a></span> <span class="id">t1</span> <span class="id">l</span>) (<span class="id"><a href="STerm.html#switch">switch</a></span> <span class="id">t2</span> <span class="id">l</span>)<br/>
| <span class="id"><a name="iota_switch2">iota_switch2</a></span> : <span class="kwd">forall</span> <span class="id">t</span> <span class="id">p</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">l1</span> <span class="id">l2</span>, <span class="id">iota</span> <span class="id">defs</span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id">iota</span> <span class="id">defs</span> (<span class="id"><a href="STerm.html#switch">switch</a></span> <span class="id">t</span> (<span class="id">l1</span> ++ (<span class="id">p</span>, <span class="id">t1</span>) :: <span class="id">l2</span>)) (<span class="id"><a href="STerm.html#switch">switch</a></span> <span class="id">t</span> (<span class="id">l1</span> ++ (<span class="id">p</span>, <span class="id">t2</span>) :: <span class="id">l2</span>)).<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="iota_subst_left">iota_subst_left</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">defs</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">us</span>, <span class="id"><a href="Beta.html#iota">iota</a></span> <span class="id">defs</span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id"><a href="Beta.html#iota">iota</a></span> <span class="id">defs</span> (<span class="id"><a href="STerm.html#subst">subst</a></span> <span class="id">us</span> <span class="id">t1</span>) (<span class="id"><a href="STerm.html#subst">subst</a></span> <span class="id">us</span> <span class="id">t2</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">defs</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">us</span> <span class="id">H</span>. <span class="id">revert</span> <span class="id">us</span>; <span class="id">induction</span> <span class="id">H</span>; <span class="id">intros</span> <span class="id">us</span>; <span class="id">unfold</span> <span class="id"><a href="STerm.html#subst1">subst1</a></span>, <span class="id"><a href="STerm.html#scons">scons</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;- <span class="id">erewrite</span> <span class="id"><a href="STerm.html#subst_closed_at_ext">subst_closed_at_ext</a></span>, <span class="id"><a href="STerm.html#subst_id">subst_id</a></span>; [<span class="id">constructor</span>; <span class="id">eassumption</span>|<span class="id">eassumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">lia</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>. <span class="id">apply</span> <span class="id">IHiota</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>. <span class="id">apply</span> <span class="id">IHiota</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>. <span class="id">apply</span> <span class="id">IHiota</span>.<br/>
&nbsp;&nbsp;- <span class="id">rewrite</span> !<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>. <span class="id">apply</span> <span class="id">IHiota</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>. <span class="id">apply</span> <span class="id">IHiota</span>.<br/>
&nbsp;&nbsp;- <span class="id">rewrite</span> !<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>. <span class="id">apply</span> <span class="id">IHiota</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="iota_subst_right">iota_subst_right</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">defs</span> <span class="id">us1</span> <span class="id">us2</span> <span class="id">t</span>, (<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Rewrite.html#star">star</a></span> (<span class="id"><a href="Beta.html#iota">iota</a></span> <span class="id">defs</span>) (<span class="id">us1</span> <span class="id">n</span>) (<span class="id">us2</span> <span class="id">n</span>)) -&gt; <span class="id"><a href="Rewrite.html#star">star</a></span> (<span class="id"><a href="Beta.html#iota">iota</a></span> <span class="id">defs</span>) (<span class="id"><a href="STerm.html#subst">subst</a></span> <span class="id">us1</span> <span class="id">t</span>) (<span class="id"><a href="STerm.html#subst">subst</a></span> <span class="id">us2</span> <span class="id">t</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">defs</span> <span class="id">us1</span> <span class="id">us2</span> <span class="id">t</span> <span class="id">Hus</span>.<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">us1</span> <span class="id">us2</span> <span class="id">Hus</span>; <span class="id">induction</span> <span class="id">t</span> <span class="kwd">using</span> <span class="id"><a href="STerm.html#term_ind2">term_ind2</a></span>; <span class="id">intros</span> <span class="id">us1</span> <span class="id">us2</span> <span class="id">Hus</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id">Hus</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_map_impl">star_map_impl</a></span> <span class="kwd">with</span> (<span class="id">f</span> := <span class="kwd">fun</span> <span class="id">t</span> =&gt; <span class="id"><a href="STerm.html#abs">abs</a></span> <span class="id">t</span>); [|<span class="id">apply</span> <span class="id">IHt</span>]; [<span class="id">intros</span>; <span class="id">constructor</span>; <span class="id">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> [|<span class="id">n</span>]; <span class="id">unfold</span> <span class="id"><a href="STerm.html#lift_subst">lift_subst</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">unfold</span> <span class="id"><a href="STerm.html#comp">comp</a></span>. <span class="id">rewrite</span> !<span class="id"><a href="STerm.html#ren_term_is_subst">ren_term_is_subst</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_map_impl">star_map_impl</a></span>; [|<span class="id">apply</span> <span class="id">Hus</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">H12</span>; <span class="id">apply</span> <span class="id"><a href="Beta.html#iota_subst_left">iota_subst_left</a></span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_compose">star_compose</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_map_impl">star_map_impl</a></span> <span class="kwd">with</span> (<span class="id">f</span> := <span class="kwd">fun</span> <span class="id">t</span> =&gt; <span class="id"><a href="STerm.html#app">app</a></span> <span class="id">t</span> <span class="id">_</span>); [|<span class="id">apply</span> <span class="id">IHt1</span>, <span class="id">Hus</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_map_impl">star_map_impl</a></span> <span class="kwd">with</span> (<span class="id">f</span> := <span class="kwd">fun</span> <span class="id">t</span> =&gt; <span class="id"><a href="STerm.html#app">app</a></span> <span class="id">_</span> <span class="id">t</span>); [|<span class="id">apply</span> <span class="id">IHt2</span>, <span class="id">Hus</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_list">star_list</a></span>; [<span class="id">intros</span>; <span class="id">constructor</span>; <span class="id">eassumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Misc.html#Forall2_map_left">Forall2_map_left</a></span>, <span class="id"><a href="Misc.html#Forall2_map_right">Forall2_map_right</a></span>, <span class="id"><a href="Misc.html#Forall2_map_same">Forall2_map_same</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; [|<span class="id">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">t</span> <span class="id">Ht</span>; <span class="id">apply</span> <span class="id">Ht</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_compose">star_compose</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_map_impl">star_map_impl</a></span> <span class="kwd">with</span> (<span class="id">f</span> := <span class="kwd">fun</span> <span class="id">t</span> =&gt; <span class="id"><a href="STerm.html#switch">switch</a></span> <span class="id">t</span> <span class="id">_</span>); [|<span class="id">apply</span> <span class="id">IHt</span>; <span class="id">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_list">star_list</a></span> <span class="kwd">with</span> (<span class="id">RA</span> := <span class="kwd">fun</span> <span class="id">pt1</span> <span class="id">pt2</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">pt1</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">pt2</span> /\ <span class="id"><a href="Beta.html#iota">iota</a></span> <span class="id">defs</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">pt1</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">pt2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">intros</span> <span class="id">l1</span> <span class="id">l2</span> [<span class="id">p1</span> <span class="id">t1</span>] [<span class="id">p2</span> <span class="id">t2</span>] [<span class="id">Hp</span> <span class="id">Hiota</span>]; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">rewrite</span> <span class="id"><a href="Misc.html#Forall2_map_left">Forall2_map_left</a></span>, <span class="id"><a href="Misc.html#Forall2_map_right">Forall2_map_right</a></span>, <span class="id"><a href="Misc.html#Forall2_map_same">Forall2_map_same</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; [|<span class="id">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> [<span class="id">p</span> <span class="id">t1</span>] <span class="id">Hpt</span>; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_map_impl">star_map_impl</a></span> <span class="kwd">with</span> (<span class="id">f</span> := <span class="kwd">fun</span> <span class="id">t1</span> =&gt; (<span class="id">p</span>, <span class="id">t1</span>)); [|<span class="id">apply</span> <span class="id">Hpt</span>]; [<span class="id">intros</span>; <span class="id">simpl</span>; <span class="id">tauto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">n</span>. <span class="id">unfold</span> <span class="id"><a href="STerm.html#liftn_subst">liftn_subst</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.Compare_dec.html#le_lt_dec">le_lt_dec</a></span>; [|<span class="id">constructor</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> !<span class="id"><a href="STerm.html#ren_term_is_subst">ren_term_is_subst</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_map_impl">star_map_impl</a></span>; [|<span class="id">apply</span> <span class="id">Hus</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Beta.html#iota_subst_left">iota_subst_left</a></span>; <span class="id">assumption</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="beta_iota_strongly_commute">beta_iota_strongly_commute</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">defs</span>, <span class="id"><a href="Rewrite.html#strongly_commute">strongly_commute</a></span> (<span class="id"><a href="Beta.html#iota">iota</a></span> <span class="id">defs</span>) <span class="id"><a href="Beta.html#beta">beta</a></span>.<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">defs</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">t3</span> <span class="id">Hiota</span> <span class="id">Hbeta</span>.<br/>
&nbsp;&nbsp;<span class="id">enough</span> (<span class="kwd">exists</span> <span class="id">w</span> : <span class="id"><a href="STerm.html#term">term</a></span>, <span class="id"><a href="Beta.html#beta">beta</a></span> <span class="id">t2</span> <span class="id">w</span> /\ <span class="id"><a href="Rewrite.html#star">star</a></span> (<span class="id"><a href="Beta.html#iota">iota</a></span> <span class="id">defs</span>) <span class="id">t3</span> <span class="id">w</span>) <span class="kwd">by</span> (<span class="id">unfold</span> <span class="id"><a href="Rewrite.html#reflc">reflc</a></span>; <span class="id">firstorder</span>).<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">t2</span> <span class="id">Hiota</span>; <span class="id">induction</span> <span class="id">Hbeta</span>; <span class="id">intros</span> <span class="id">t4</span> <span class="id">Hiota</span>; <span class="id">inversion</span> <span class="id">Hiota</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> (<span class="id">IHHbeta</span> <span class="id">_</span> <span class="id">H2</span>) <span class="kwd">as</span> (<span class="id">t4</span> &amp; <span class="id">Ht34</span> &amp; <span class="id">Ht24</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="STerm.html#app">app</a></span> <span class="id">t4</span> <span class="id">t3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; [<span class="id">constructor</span>; <span class="id">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_map_impl">star_map_impl</a></span> <span class="kwd">with</span> (<span class="id">f</span> := <span class="kwd">fun</span> <span class="id">t</span> =&gt; <span class="id"><a href="STerm.html#app">app</a></span> <span class="id">t</span> <span class="id">t3</span>); [|<span class="id">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="kwd">exists</span> (<span class="id"><a href="STerm.html#app">app</a></span> <span class="id">t2</span> <span class="id">t5</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; [<span class="id">constructor</span>; <span class="id">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_1">star_1</a></span>. <span class="id">constructor</span>. <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="kwd">exists</span> (<span class="id"><a href="STerm.html#app">app</a></span> <span class="id">t5</span> <span class="id">t2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; [<span class="id">constructor</span>; <span class="id">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_1">star_1</a></span>. <span class="id">constructor</span>. <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> (<span class="id">IHHbeta</span> <span class="id">_</span> <span class="id">H2</span>) <span class="kwd">as</span> (<span class="id">t4</span> &amp; <span class="id">Ht34</span> &amp; <span class="id">Ht24</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="STerm.html#app">app</a></span> <span class="id">t3</span> <span class="id">t4</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; [<span class="id">constructor</span>; <span class="id">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_map_impl">star_map_impl</a></span> <span class="kwd">with</span> (<span class="id">f</span> := <span class="kwd">fun</span> <span class="id">t</span> =&gt; <span class="id"><a href="STerm.html#app">app</a></span> <span class="id">t3</span> <span class="id">t</span>); [|<span class="id">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> (<span class="id">IHHbeta</span> <span class="id">_</span> <span class="id">H0</span>) <span class="kwd">as</span> (<span class="id">t4</span> &amp; <span class="id">Ht34</span> &amp; <span class="id">Ht24</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="STerm.html#abs">abs</a></span> <span class="id">t4</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; [<span class="id">constructor</span>; <span class="id">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_map_impl">star_map_impl</a></span> <span class="kwd">with</span> (<span class="id">f</span> := <span class="kwd">fun</span> <span class="id">t</span> =&gt; <span class="id"><a href="STerm.html#abs">abs</a></span> <span class="id">t</span>); [|<span class="id">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">inversion</span> <span class="id">H2</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="STerm.html#subst1">subst1</a></span> <span class="id">t2</span> <span class="id">t4</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; [<span class="id">constructor</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Rewrite.html#star_1">star_1</a></span>, <span class="id"><a href="Beta.html#iota_subst_left">iota_subst_left</a></span>. <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="kwd">exists</span> (<span class="id"><a href="STerm.html#subst1">subst1</a></span> <span class="id">t3</span> <span class="id">t1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; [<span class="id">constructor</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Beta.html#iota_subst_right">iota_subst_right</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> [|<span class="id">n</span>]; <span class="id">simpl</span>; [<span class="id">apply</span> <span class="id"><a href="Rewrite.html#star_1">star_1</a></span>; <span class="id">assumption</span>|<span class="id">constructor</span>].<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Misc.html#list_select_eq">list_select_eq</a></span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H1</span> <span class="kwd">as</span> [(-&gt; &amp; -&gt; &amp; -&gt;) | [(<span class="id">l4</span> &amp; &lt;- &amp; -&gt;) | (<span class="id">l4</span> &amp; -&gt; &amp; &lt;-)]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">destruct</span> (<span class="id">IHHbeta</span> <span class="id">_</span> <span class="id">H2</span>) <span class="kwd">as</span> (<span class="id">t4</span> &amp; <span class="id">Ht34</span> &amp; <span class="id">Ht24</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="STerm.html#constr">constr</a></span> <span class="id">tag</span> (<span class="id">l1</span> ++ <span class="id">t4</span> :: <span class="id">l2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; [<span class="id">constructor</span>; <span class="id">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_map_impl">star_map_impl</a></span> <span class="kwd">with</span> (<span class="id">f</span> := <span class="kwd">fun</span> <span class="id">t</span> =&gt; <span class="id"><a href="STerm.html#constr">constr</a></span> <span class="id">tag</span> (<span class="id">l1</span> ++ <span class="id">t</span> :: <span class="id">l2</span>)); [|<span class="id">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="kwd">exists</span> (<span class="id"><a href="STerm.html#constr">constr</a></span> <span class="id">tag</span> (<span class="id">l0</span> ++ <span class="id">t3</span> :: <span class="id">l4</span> ++ <span class="id">t2</span> :: <span class="id">l2</span>)). <span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">rewrite</span> &lt;- !<span class="id"><a href="Misc.html#select2_app_assoc">select2_app_assoc</a></span>. <span class="id">constructor</span>. <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">apply</span> <span class="id"><a href="Rewrite.html#star_1">star_1</a></span>. <span class="id">rewrite</span> <span class="id"><a href="Misc.html#select2_app_assoc">select2_app_assoc</a></span>. <span class="id">constructor</span>. <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="kwd">exists</span> (<span class="id"><a href="STerm.html#constr">constr</a></span> <span class="id">tag</span> (<span class="id">l1</span> ++ <span class="id">t2</span> :: <span class="id">l4</span> ++ <span class="id">t3</span> :: <span class="id">l3</span>)). <span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">rewrite</span> <span class="id"><a href="Misc.html#select2_app_assoc">select2_app_assoc</a></span>. <span class="id">constructor</span>. <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">apply</span> <span class="id"><a href="Rewrite.html#star_1">star_1</a></span>. <span class="id">rewrite</span> &lt;- !<span class="id"><a href="Misc.html#select2_app_assoc">select2_app_assoc</a></span>. <span class="id">constructor</span>. <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> (<span class="id">IHHbeta</span> <span class="id">_</span> <span class="id">H2</span>) <span class="kwd">as</span> (<span class="id">t4</span> &amp; <span class="id">Ht34</span> &amp; <span class="id">Ht24</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="STerm.html#switch">switch</a></span> <span class="id">t4</span> <span class="id">l</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; [<span class="id">constructor</span>; <span class="id">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_map_impl">star_map_impl</a></span> <span class="kwd">with</span> (<span class="id">f</span> := <span class="kwd">fun</span> <span class="id">t</span> =&gt; <span class="id"><a href="STerm.html#switch">switch</a></span> <span class="id">t</span> <span class="id">l</span>); [|<span class="id">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="kwd">exists</span> (<span class="id"><a href="STerm.html#switch">switch</a></span> <span class="id">t2</span> (<span class="id">l1</span> ++ (<span class="id">p</span>, <span class="id">t3</span>) :: <span class="id">l2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; [<span class="id">constructor</span>; <span class="id">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Rewrite.html#star_1">star_1</a></span>. <span class="id">constructor</span>. <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="kwd">exists</span> (<span class="id"><a href="STerm.html#switch">switch</a></span> <span class="id">t3</span> (<span class="id">l1</span> ++ (<span class="id">p</span>, <span class="id">t2</span>) :: <span class="id">l2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; [<span class="id">constructor</span>; <span class="id">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Rewrite.html#star_1">star_1</a></span>. <span class="id">constructor</span>. <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Misc.html#list_select_eq">list_select_eq</a></span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H1</span> <span class="kwd">as</span> [(-&gt; &amp; [=-&gt; -&gt;] &amp; -&gt;) | [(<span class="id">l4</span> &amp; &lt;- &amp; -&gt;) | (<span class="id">l4</span> &amp; -&gt; &amp; &lt;-)]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">destruct</span> (<span class="id">IHHbeta</span> <span class="id">_</span> <span class="id">H2</span>) <span class="kwd">as</span> (<span class="id">t4</span> &amp; <span class="id">Ht34</span> &amp; <span class="id">Ht24</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="STerm.html#switch">switch</a></span> <span class="id">t</span> (<span class="id">l1</span> ++ (<span class="id">p</span>, <span class="id">t4</span>) :: <span class="id">l2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; [<span class="id">constructor</span>; <span class="id">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_map_impl">star_map_impl</a></span> <span class="kwd">with</span> (<span class="id">f</span> := <span class="kwd">fun</span> <span class="id">t1</span> =&gt; <span class="id"><a href="STerm.html#switch">switch</a></span> <span class="id">t</span> (<span class="id">l1</span> ++ (<span class="id">p</span>, <span class="id">t1</span>) :: <span class="id">l2</span>)); [|<span class="id">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="kwd">exists</span> (<span class="id"><a href="STerm.html#switch">switch</a></span> <span class="id">t</span> (<span class="id">l0</span> ++ (<span class="id">p0</span>, <span class="id">t5</span>) :: <span class="id">l4</span> ++ (<span class="id">p</span>, <span class="id">t2</span>) :: <span class="id">l2</span>)). <span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">rewrite</span> &lt;- !<span class="id"><a href="Misc.html#select2_app_assoc">select2_app_assoc</a></span>. <span class="id">constructor</span>. <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">apply</span> <span class="id"><a href="Rewrite.html#star_1">star_1</a></span>. <span class="id">rewrite</span> <span class="id"><a href="Misc.html#select2_app_assoc">select2_app_assoc</a></span>. <span class="id">constructor</span>. <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="kwd">exists</span> (<span class="id"><a href="STerm.html#switch">switch</a></span> <span class="id">t</span> (<span class="id">l1</span> ++ (<span class="id">p</span>, <span class="id">t2</span>) :: <span class="id">l4</span> ++ (<span class="id">p0</span>, <span class="id">t5</span>) :: <span class="id">l3</span>)). <span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">rewrite</span> <span class="id"><a href="Misc.html#select2_app_assoc">select2_app_assoc</a></span>. <span class="id">constructor</span>. <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">apply</span> <span class="id"><a href="Rewrite.html#star_1">star_1</a></span>. <span class="id">rewrite</span> &lt;- !<span class="id"><a href="Misc.html#select2_app_assoc">select2_app_assoc</a></span>. <span class="id">constructor</span>. <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">inversion</span> <span class="id">H2</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="STerm.html#subst">subst</a></span> (<span class="id"><a href="STerm.html#read_env">read_env</a></span> (<span class="id">l0</span> ++ <span class="id">t0</span> :: <span class="id">l3</span>)) <span class="id">t</span>). <span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">erewrite</span> <span class="id"><a href="Misc.html#length_select">length_select</a></span>; <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Beta.html#iota_subst_right">iota_subst_right</a></span>. <span class="id">intros</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">unfold</span> <span class="id"><a href="STerm.html#read_env">read_env</a></span>. <span class="id">rewrite</span> !<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#app_length">app_length</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.Compare_dec.html#le_lt_dec">le_lt_dec</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l0</span>) <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">rewrite</span> !<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#nth_error_app2">nth_error_app2</a></span> <span class="kwd">by</span> <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">n</span> - <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l0</span>); <span class="id">simpl</span>; [<span class="id">apply</span> <span class="id"><a href="Rewrite.html#star_1">star_1</a></span>; <span class="id">assumption</span>|<span class="id">constructor</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">rewrite</span> !<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#nth_error_app1">nth_error_app1</a></span> <span class="kwd">by</span> <span class="id">assumption</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Misc.html#list_select_eq">list_select_eq</a></span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H1</span> <span class="kwd">as</span> [(-&gt; &amp; [=-&gt; -&gt;] &amp; -&gt;) | [(<span class="id">l4</span> &amp; &lt;- &amp; -&gt;) | (<span class="id">l4</span> &amp; -&gt; &amp; &lt;-)]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="kwd">exists</span> (<span class="id"><a href="STerm.html#subst">subst</a></span> (<span class="id"><a href="STerm.html#read_env">read_env</a></span> <span class="id">l</span>) <span class="id">t2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; [<span class="id">constructor</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Rewrite.html#star_1">star_1</a></span>, <span class="id"><a href="Beta.html#iota_subst_left">iota_subst_left</a></span>. <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="kwd">exists</span> (<span class="id"><a href="STerm.html#subst">subst</a></span> (<span class="id"><a href="STerm.html#read_env">read_env</a></span> <span class="id">l</span>) <span class="id">t</span>). <span class="id">split</span>; [|<span class="id">constructor</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- <span class="id"><a href="Misc.html#select2_app_assoc">select2_app_assoc</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="Misc.html#length_select">length_select</a></span>; <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="kwd">exists</span> (<span class="id"><a href="STerm.html#subst">subst</a></span> (<span class="id"><a href="STerm.html#read_env">read_env</a></span> <span class="id">l</span>) <span class="id">t</span>). <span class="id">split</span>; [|<span class="id">constructor</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Misc.html#select2_app_assoc">select2_app_assoc</a></span>. <span class="id">constructor</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="iota_weak_diamond">iota_weak_diamond</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">defs</span>, <span class="id"><a href="Rewrite.html#weak_diamond">weak_diamond</a></span> (<span class="id"><a href="Beta.html#iota">iota</a></span> <span class="id">defs</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">defs</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">t3</span> <span class="id">H12</span>. <span class="id">revert</span> <span class="id">t3</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">H12</span>; <span class="id">intros</span> <span class="id">t4</span> <span class="id">H14</span>; <span class="id">inversion</span> <span class="id">H14</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;- <span class="id">left</span>. <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> (<span class="id">IHiota</span> <span class="id">_</span> <span class="id">H2</span>) <span class="kwd">as</span> [-&gt; | (<span class="id">t4</span> &amp; <span class="id">Ht24</span> &amp; <span class="id">Ht34</span>)]; [<span class="id">left</span>; <span class="id">reflexivity</span>|<span class="id">right</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="STerm.html#app">app</a></span> <span class="id">t4</span> <span class="id">t3</span>). <span class="id">split</span>; <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">right</span>. <span class="kwd">exists</span> (<span class="id"><a href="STerm.html#app">app</a></span> <span class="id">t2</span> <span class="id">t5</span>). <span class="id">split</span>; <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">right</span>. <span class="kwd">exists</span> (<span class="id"><a href="STerm.html#app">app</a></span> <span class="id">t5</span> <span class="id">t2</span>). <span class="id">split</span>; <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> (<span class="id">IHiota</span> <span class="id">_</span> <span class="id">H2</span>) <span class="kwd">as</span> [-&gt; | (<span class="id">t4</span> &amp; <span class="id">Ht24</span> &amp; <span class="id">Ht34</span>)]; [<span class="id">left</span>; <span class="id">reflexivity</span>|<span class="id">right</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="STerm.html#app">app</a></span> <span class="id">t3</span> <span class="id">t4</span>). <span class="id">split</span>; <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> (<span class="id">IHiota</span> <span class="id">_</span> <span class="id">H0</span>) <span class="kwd">as</span> [-&gt; | (<span class="id">t4</span> &amp; <span class="id">Ht2</span>' &amp; <span class="id">Ht34</span>)]; [<span class="id">left</span>; <span class="id">reflexivity</span>|<span class="id">right</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="STerm.html#abs">abs</a></span> <span class="id">t4</span>). <span class="id">split</span>; <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Misc.html#list_select_eq">list_select_eq</a></span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H1</span> <span class="kwd">as</span> [(-&gt; &amp; -&gt; &amp; -&gt;) | [(<span class="id">l4</span> &amp; &lt;- &amp; -&gt;) | (<span class="id">l4</span> &amp; -&gt; &amp; &lt;-)]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">destruct</span> (<span class="id">IHiota</span> <span class="id">_</span> <span class="id">H2</span>) <span class="kwd">as</span> [-&gt; | (<span class="id">t4</span> &amp; <span class="id">Ht24</span> &amp; <span class="id">Ht34</span>)]; [<span class="id">left</span>; <span class="id">reflexivity</span>|<span class="id">right</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="STerm.html#constr">constr</a></span> <span class="id">tag</span> (<span class="id">l1</span> ++ <span class="id">t4</span> :: <span class="id">l2</span>)). <span class="id">split</span>; <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="STerm.html#constr">constr</a></span> <span class="id">tag</span> (<span class="id">l0</span> ++ <span class="id">t3</span> :: <span class="id">l4</span> ++ <span class="id">t2</span> :: <span class="id">l2</span>)). <span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">rewrite</span> <span class="id"><a href="Misc.html#select2_app_assoc">select2_app_assoc</a></span>. <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">rewrite</span> &lt;- !<span class="id"><a href="Misc.html#select2_app_assoc">select2_app_assoc</a></span>. <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="STerm.html#constr">constr</a></span> <span class="id">tag</span> (<span class="id">l1</span> ++ <span class="id">t2</span> :: <span class="id">l4</span> ++ <span class="id">t3</span> :: <span class="id">l3</span>)). <span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">rewrite</span> &lt;- !<span class="id"><a href="Misc.html#select2_app_assoc">select2_app_assoc</a></span>. <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">rewrite</span> <span class="id"><a href="Misc.html#select2_app_assoc">select2_app_assoc</a></span>. <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> (<span class="id">IHiota</span> <span class="id">_</span> <span class="id">H2</span>) <span class="kwd">as</span> [-&gt; | (<span class="id">t4</span> &amp; <span class="id">Ht24</span> &amp; <span class="id">Ht34</span>)]; [<span class="id">left</span>; <span class="id">reflexivity</span>|<span class="id">right</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="STerm.html#switch">switch</a></span> <span class="id">t4</span> <span class="id">l</span>). <span class="id">split</span>; <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">right</span>. <span class="kwd">exists</span> (<span class="id"><a href="STerm.html#switch">switch</a></span> <span class="id">t2</span> (<span class="id">l1</span> ++ (<span class="id">p</span>, <span class="id">t3</span>) :: <span class="id">l2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">right</span>. <span class="kwd">exists</span> (<span class="id"><a href="STerm.html#switch">switch</a></span> <span class="id">t3</span> (<span class="id">l1</span> ++ (<span class="id">p</span>, <span class="id">t2</span>) :: <span class="id">l2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Misc.html#list_select_eq">list_select_eq</a></span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">H1</span> <span class="kwd">as</span> [(-&gt; &amp; [=-&gt; -&gt;] &amp; -&gt;) | [(<span class="id">l4</span> &amp; &lt;- &amp; -&gt;) | (<span class="id">l4</span> &amp; -&gt; &amp; &lt;-)]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">destruct</span> (<span class="id">IHiota</span> <span class="id">_</span> <span class="id">H2</span>) <span class="kwd">as</span> [-&gt; | (<span class="id">t4</span> &amp; <span class="id">Ht24</span> &amp; <span class="id">Ht34</span>)]; [<span class="id">left</span>; <span class="id">reflexivity</span>|<span class="id">right</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="STerm.html#switch">switch</a></span> <span class="id">t</span> (<span class="id">l1</span> ++ (<span class="id">p</span>, <span class="id">t4</span>) :: <span class="id">l2</span>)). <span class="id">split</span>; <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="STerm.html#switch">switch</a></span> <span class="id">t</span> (<span class="id">l0</span> ++ (<span class="id">p0</span>, <span class="id">t5</span>) :: <span class="id">l4</span> ++ (<span class="id">p</span>, <span class="id">t2</span>) :: <span class="id">l2</span>)). <span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">rewrite</span> <span class="id"><a href="Misc.html#select2_app_assoc">select2_app_assoc</a></span>. <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">rewrite</span> &lt;- !<span class="id"><a href="Misc.html#select2_app_assoc">select2_app_assoc</a></span>. <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="STerm.html#switch">switch</a></span> <span class="id">t</span> (<span class="id">l1</span> ++ (<span class="id">p</span>, <span class="id">t2</span>) :: <span class="id">l4</span> ++ (<span class="id">p0</span>, <span class="id">t5</span>) :: <span class="id">l3</span>)). <span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">rewrite</span> &lt;- !<span class="id"><a href="Misc.html#select2_app_assoc">select2_app_assoc</a></span>. <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">rewrite</span> <span class="id"><a href="Misc.html#select2_app_assoc">select2_app_assoc</a></span>. <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="iota_confluent">iota_confluent</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">defs</span>, <span class="id"><a href="Rewrite.html#confluent">confluent</a></span> (<span class="id"><a href="Beta.html#iota">iota</a></span> <span class="id">defs</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">defs</span>. <span class="id">apply</span> <span class="id"><a href="Rewrite.html#weak_diamond_confluent">weak_diamond_confluent</a></span>, <span class="id"><a href="Beta.html#iota_weak_diamond">iota_weak_diamond</a></span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="beta_iota_confluent">beta_iota_confluent</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">defs</span>, <span class="id"><a href="Rewrite.html#confluent">confluent</a></span> (<span class="id"><a href="Rewrite.html#union">union</a></span> (<span class="id"><a href="Beta.html#iota">iota</a></span> <span class="id">defs</span>) <span class="id"><a href="Beta.html#beta">beta</a></span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">defs</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Rewrite.html#commuting_confluent">commuting_confluent</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Beta.html#iota_confluent">iota_confluent</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Beta.html#beta_confluent">beta_confluent</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Rewrite.html#strongly_commute_commutes">strongly_commute_commutes</a></span>, <span class="id"><a href="Beta.html#beta_iota_strongly_commute">beta_iota_strongly_commute</a></span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="betaiota">betaiota</a></span> <span class="id">defs</span> := <span class="id"><a href="Rewrite.html#union">union</a></span> (<span class="id"><a href="Beta.html#iota">iota</a></span> <span class="id">defs</span>) <span class="id"><a href="Beta.html#beta">beta</a></span>.<br/>
<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="is_head">is_head</a></span> : <span class="id"><a href="STerm.html#term">term</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
| <span class="id"><a name="is_head_var">is_head_var</a></span> : <span class="kwd">forall</span> <span class="id">n</span>, <span class="id">is_head</span> (<span class="id"><a href="STerm.html#var">var</a></span> <span class="id">n</span>)<br/>
| <span class="id"><a name="is_head_dvar">is_head_dvar</a></span> : <span class="kwd">forall</span> <span class="id">n</span>, <span class="id">is_head</span> (<span class="id"><a href="STerm.html#dvar">dvar</a></span> <span class="id">n</span>).<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="is_head_betaiota">is_head_betaiota</a></span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="STerm.html#term">term</a></span> -&gt; <span class="id"><a href="STerm.html#term">term</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
| <span class="id"><a name="is_head_betaiota_var">is_head_betaiota_var</a></span> : <span class="kwd">forall</span> <span class="id">defs</span> <span class="id">n</span>, <span class="id">is_head_betaiota</span> <span class="id">defs</span> (<span class="id"><a href="STerm.html#var">var</a></span> <span class="id">n</span>)<br/>
| <span class="id"><a name="is_head_betaiota_dvar">is_head_betaiota_dvar</a></span> : <span class="kwd">forall</span> <span class="id">defs</span> <span class="id">n</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#nth_error">nth_error</a></span> <span class="id">defs</span> <span class="id">n</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt; <span class="id">is_head_betaiota</span> <span class="id">defs</span> (<span class="id"><a href="STerm.html#dvar">dvar</a></span> <span class="id">n</span>).<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="hctx">hctx</a></span> : <span class="kwd">Type</span> :=<br/>
| <span class="id"><a name="h_hole">h_hole</a></span> : <span class="id">hctx</span><br/>
| <span class="id"><a name="h_app">h_app</a></span> : <span class="id">hctx</span> -&gt; <span class="id"><a href="STerm.html#term">term</a></span> -&gt; <span class="id">hctx</span><br/>
| <span class="id"><a name="h_switch">h_switch</a></span> : <span class="id">hctx</span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> * <span class="id"><a href="STerm.html#term">term</a></span>) -&gt; <span class="id">hctx</span>.<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="fill_hctx">fill_hctx</a></span> (<span class="id">h</span> : <span class="id"><a href="Beta.html#hctx">hctx</a></span>) (<span class="id">t</span> : <span class="id"><a href="STerm.html#term">term</a></span>) : <span class="id"><a href="STerm.html#term">term</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">h</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Beta.html#h_hole">h_hole</a></span> =&gt; <span class="id">t</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Beta.html#h_app">h_app</a></span> <span class="id">h</span> <span class="id">t2</span> =&gt; <span class="id"><a href="STerm.html#app">app</a></span> (<span class="id">fill_hctx</span> <span class="id">h</span> <span class="id">t</span>) <span class="id">t2</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Beta.html#h_switch">h_switch</a></span> <span class="id">h</span> <span class="id">l</span> =&gt; <span class="id"><a href="STerm.html#switch">switch</a></span> (<span class="id">fill_hctx</span> <span class="id">h</span> <span class="id">t</span>) <span class="id">l</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="compose_hctx">compose_hctx</a></span> (<span class="id">h1</span> <span class="id">h2</span> : <span class="id"><a href="Beta.html#hctx">hctx</a></span>) : <span class="id"><a href="Beta.html#hctx">hctx</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">h1</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Beta.html#h_hole">h_hole</a></span> =&gt; <span class="id">h2</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Beta.html#h_app">h_app</a></span> <span class="id">h</span> <span class="id">t</span> =&gt; <span class="id"><a href="Beta.html#h_app">h_app</a></span> (<span class="id">compose_hctx</span> <span class="id">h</span> <span class="id">h2</span>) <span class="id">t</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="Beta.html#h_switch">h_switch</a></span> <span class="id">h</span> <span class="id">l</span> =&gt; <span class="id"><a href="Beta.html#h_switch">h_switch</a></span> (<span class="id">compose_hctx</span> <span class="id">h</span> <span class="id">h2</span>) <span class="id">l</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="fill_compose">fill_compose</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">h1</span> <span class="id">h2</span> <span class="id">t</span>, <span class="id"><a href="Beta.html#fill_hctx">fill_hctx</a></span> (<span class="id"><a href="Beta.html#compose_hctx">compose_hctx</a></span> <span class="id">h1</span> <span class="id">h2</span>) <span class="id">t</span> = <span class="id"><a href="Beta.html#fill_hctx">fill_hctx</a></span> <span class="id">h1</span> (<span class="id"><a href="Beta.html#fill_hctx">fill_hctx</a></span> <span class="id">h2</span> <span class="id">t</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">h1</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">congruence</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="in_ctx">in_ctx</a></span> (<span class="id">P</span> : <span class="id"><a href="STerm.html#term">term</a></span> -&gt; <span class="kwd">Prop</span>) <span class="id">t</span> := <span class="kwd">exists</span> <span class="id">h</span> <span class="id">t2</span>, <span class="id">P</span> <span class="id">t2</span> /\ <span class="id">t</span> = <span class="id"><a href="Beta.html#fill_hctx">fill_hctx</a></span> <span class="id">h</span> <span class="id">t2</span>.<br/>
<span class="kwd">Definition</span> <span class="id"><a name="is_hnf">is_hnf</a></span> := <span class="id"><a href="Beta.html#in_ctx">in_ctx</a></span> <span class="id"><a href="Beta.html#is_head">is_head</a></span>.<br/>
<span class="kwd">Definition</span> <span class="id"><a name="is_hnf_betaiota">is_hnf_betaiota</a></span> <span class="id">defs</span> := <span class="id"><a href="Beta.html#in_ctx">in_ctx</a></span> (<span class="id"><a href="Beta.html#is_head_betaiota">is_head_betaiota</a></span> <span class="id">defs</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="in_ctx_hole">in_ctx_hole</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">P</span> : <span class="id"><a href="STerm.html#term">term</a></span> -&gt; <span class="kwd">Prop</span>) <span class="id">t</span>, <span class="id">P</span> <span class="id">t</span> -&gt; <span class="id"><a href="Beta.html#in_ctx">in_ctx</a></span> <span class="id">P</span> <span class="id">t</span>.<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">P</span> <span class="id">t</span> <span class="id">H</span>; <span class="kwd">exists</span> <span class="id"><a href="Beta.html#h_hole">h_hole</a></span>; <span class="kwd">exists</span> <span class="id">t</span>. <span class="id">split</span>; [<span class="id">assumption</span>|<span class="id">reflexivity</span>].<br/>
Qed.</details>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="in_ctx_fill">in_ctx_fill</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">P</span> <span class="id">h</span> <span class="id">t</span>, <span class="id"><a href="Beta.html#in_ctx">in_ctx</a></span> <span class="id">P</span> <span class="id">t</span> -&gt; <span class="id"><a href="Beta.html#in_ctx">in_ctx</a></span> <span class="id">P</span> (<span class="id"><a href="Beta.html#fill_hctx">fill_hctx</a></span> <span class="id">h</span> <span class="id">t</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">P</span> <span class="id">h</span> <span class="id">t</span> (<span class="id">h2</span> &amp; <span class="id">t2</span> &amp; <span class="id">H</span> &amp; <span class="id">Ht</span>).<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id"><a href="Beta.html#compose_hctx">compose_hctx</a></span> <span class="id">h</span> <span class="id">h2</span>). <span class="kwd">exists</span> <span class="id">t2</span>.<br/>
&nbsp;&nbsp;<span class="id">split</span>; [<span class="id">assumption</span>|]. <span class="id">rewrite</span> <span class="id">Ht</span>, <span class="id"><a href="Beta.html#fill_compose">fill_compose</a></span>. <span class="id">reflexivity</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="in_ctx_app">in_ctx_app</a></span> : <span class="kwd">forall</span> <span class="id">P</span> <span class="id">t1</span> <span class="id">t2</span>, <span class="id"><a href="Beta.html#in_ctx">in_ctx</a></span> <span class="id">P</span> <span class="id">t1</span> -&gt; <span class="id"><a href="Beta.html#in_ctx">in_ctx</a></span> <span class="id">P</span> (<span class="id"><a href="STerm.html#app">app</a></span> <span class="id">t1</span> <span class="id">t2</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">P</span> <span class="id">t1</span> <span class="id">t2</span>. <span class="id">apply</span> <span class="id"><a href="Beta.html#in_ctx_fill">in_ctx_fill</a></span> <span class="kwd">with</span> (<span class="id">h</span> := <span class="id"><a href="Beta.html#h_app">h_app</a></span> <span class="id"><a href="Beta.html#h_hole">h_hole</a></span> <span class="id">t2</span>).<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="in_ctx_switch">in_ctx_switch</a></span> : <span class="kwd">forall</span> <span class="id">P</span> <span class="id">t</span> <span class="id">l</span>, <span class="id"><a href="Beta.html#in_ctx">in_ctx</a></span> <span class="id">P</span> <span class="id">t</span> -&gt; <span class="id"><a href="Beta.html#in_ctx">in_ctx</a></span> <span class="id">P</span> (<span class="id"><a href="STerm.html#switch">switch</a></span> <span class="id">t</span> <span class="id">l</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">P</span> <span class="id">t</span> <span class="id">l</span>. <span class="id">apply</span> <span class="id"><a href="Beta.html#in_ctx_fill">in_ctx_fill</a></span> <span class="kwd">with</span> (<span class="id">h</span> := <span class="id"><a href="Beta.html#h_switch">h_switch</a></span> <span class="id"><a href="Beta.html#h_hole">h_hole</a></span> <span class="id">l</span>).<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="in_ctx_imp">in_ctx_imp</a></span> : <span class="kwd">forall</span> (<span class="id">P</span> <span class="id">Q</span> : <span class="id"><a href="STerm.html#term">term</a></span> -&gt; <span class="kwd">Prop</span>), (<span class="kwd">forall</span> <span class="id">t</span>, <span class="id">P</span> <span class="id">t</span> -&gt; <span class="id">Q</span> <span class="id">t</span>) -&gt; <span class="kwd">forall</span> <span class="id">t</span>, <span class="id"><a href="Beta.html#in_ctx">in_ctx</a></span> <span class="id">P</span> <span class="id">t</span> -&gt; <span class="id"><a href="Beta.html#in_ctx">in_ctx</a></span> <span class="id">Q</span> <span class="id">t</span>.<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">P</span> <span class="id">Q</span> <span class="id">H</span> <span class="id">t</span> (<span class="id">h</span> &amp; <span class="id">t2</span> &amp; <span class="id">Ht2</span> &amp; -&gt;).<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">h</span>. <span class="kwd">exists</span> <span class="id">t2</span>. <span class="id">split</span>; [|<span class="id">reflexivity</span>]. <span class="id">apply</span> <span class="id">H</span>; <span class="id">assumption</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_hnf_var">is_hnf_var</a></span> : <span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Beta.html#is_hnf">is_hnf</a></span> (<span class="id"><a href="STerm.html#var">var</a></span> <span class="id">n</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">n</span>. <span class="id">apply</span> <span class="id"><a href="Beta.html#in_ctx_hole">in_ctx_hole</a></span>. <span class="id">constructor</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_hnf_dvar">is_hnf_dvar</a></span> : <span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="Beta.html#is_hnf">is_hnf</a></span> (<span class="id"><a href="STerm.html#dvar">dvar</a></span> <span class="id">n</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">n</span>. <span class="id">apply</span> <span class="id"><a href="Beta.html#in_ctx_hole">in_ctx_hole</a></span>. <span class="id">constructor</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_hnf_ctx">is_hnf_ctx</a></span> : <span class="kwd">forall</span> <span class="id">h</span> <span class="id">t</span>, <span class="id"><a href="Beta.html#is_hnf">is_hnf</a></span> <span class="id">t</span> -&gt; <span class="id"><a href="Beta.html#is_hnf">is_hnf</a></span> (<span class="id"><a href="Beta.html#fill_hctx">fill_hctx</a></span> <span class="id">h</span> <span class="id">t</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Beta.html#in_ctx_fill">in_ctx_fill</a></span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_hnf_app">is_hnf_app</a></span> : <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span>, <span class="id"><a href="Beta.html#is_hnf">is_hnf</a></span> <span class="id">t1</span> -&gt; <span class="id"><a href="Beta.html#is_hnf">is_hnf</a></span> (<span class="id"><a href="STerm.html#app">app</a></span> <span class="id">t1</span> <span class="id">t2</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Beta.html#in_ctx_app">in_ctx_app</a></span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_hnf_switch">is_hnf_switch</a></span> : <span class="kwd">forall</span> <span class="id">t</span> <span class="id">l</span>, <span class="id"><a href="Beta.html#is_hnf">is_hnf</a></span> <span class="id">t</span> -&gt; <span class="id"><a href="Beta.html#is_hnf">is_hnf</a></span> (<span class="id"><a href="STerm.html#switch">switch</a></span> <span class="id">t</span> <span class="id">l</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Beta.html#in_ctx_switch">in_ctx_switch</a></span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="is_value">is_value</a></span> : <span class="id"><a href="STerm.html#term">term</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
| <span class="id"><a name="is_value_abs">is_value_abs</a></span> : <span class="kwd">forall</span> <span class="id">t</span>, <span class="id">is_value</span> (<span class="id"><a href="STerm.html#abs">abs</a></span> <span class="id">t</span>)<br/>
| <span class="id"><a name="is_value_constr">is_value_constr</a></span> : <span class="kwd">forall</span> <span class="id">tag</span> <span class="id">l</span>, <span class="id">is_value</span> (<span class="id"><a href="STerm.html#constr">constr</a></span> <span class="id">tag</span> <span class="id">l</span>)<br/>
| <span class="id"><a name="is_value_hnf">is_value_hnf</a></span> : <span class="kwd">forall</span> <span class="id">t</span>, <span class="id"><a href="Beta.html#is_hnf">is_hnf</a></span> <span class="id">t</span> -&gt; <span class="id">is_value</span> <span class="id">t</span>.<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="beta_err">beta_err</a></span> : <span class="id"><a href="STerm.html#term">term</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
| <span class="id"><a name="beta_err_app_constr">beta_err_app_constr</a></span> : <span class="kwd">forall</span> <span class="id">tag</span> <span class="id">l</span> <span class="id">t</span>, <span class="id">beta_err</span> (<span class="id"><a href="STerm.html#app">app</a></span> (<span class="id"><a href="STerm.html#constr">constr</a></span> <span class="id">tag</span> <span class="id">l</span>) <span class="id">t</span>)<br/>
| <span class="id"><a name="beta_err_switch_abs">beta_err_switch_abs</a></span> : <span class="kwd">forall</span> <span class="id">t</span> <span class="id">l</span>, <span class="id">beta_err</span> (<span class="id"><a href="STerm.html#switch">switch</a></span> (<span class="id"><a href="STerm.html#abs">abs</a></span> <span class="id">t</span>) <span class="id">l</span>)<br/>
| <span class="id"><a name="beta_err_switch_overflow">beta_err_switch_overflow</a></span> : <span class="kwd">forall</span> <span class="id">tag</span> <span class="id">l</span> <span class="id">l1</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l1</span> &lt;= <span class="id">tag</span> -&gt; <span class="id">beta_err</span> (<span class="id"><a href="STerm.html#switch">switch</a></span> (<span class="id"><a href="STerm.html#constr">constr</a></span> <span class="id">tag</span> <span class="id">l</span>) <span class="id">l1</span>)<br/>
| <span class="id"><a name="beta_err_switch_numvars">beta_err_switch_numvars</a></span>: <span class="kwd">forall</span> <span class="id">l</span> <span class="id">p</span> <span class="id">t</span> <span class="id">l1</span> <span class="id">l2</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span> &lt;&gt; <span class="id">p</span> -&gt; <span class="id">beta_err</span> (<span class="id"><a href="STerm.html#switch">switch</a></span> (<span class="id"><a href="STerm.html#constr">constr</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l1</span>) <span class="id">l</span>) (<span class="id">l1</span> ++ (<span class="id">p</span>, <span class="id">t</span>) :: <span class="id">l2</span>)).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="beta_herr">beta_herr</a></span> := <span class="id"><a href="Beta.html#in_ctx">in_ctx</a></span> <span class="id"><a href="Beta.html#beta_err">beta_err</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="beta_herr_err">beta_herr_err</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span>, <span class="id"><a href="Beta.html#beta_err">beta_err</a></span> <span class="id">t</span> -&gt; <span class="id"><a href="Beta.html#beta_herr">beta_herr</a></span> <span class="id">t</span>.<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Beta.html#in_ctx_hole">in_ctx_hole</a></span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="beta_herr_ctx">beta_herr_ctx</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">h</span> <span class="id">t</span>, <span class="id"><a href="Beta.html#beta_herr">beta_herr</a></span> <span class="id">t</span> -&gt; <span class="id"><a href="Beta.html#beta_herr">beta_herr</a></span> (<span class="id"><a href="Beta.html#fill_hctx">fill_hctx</a></span> <span class="id">h</span> <span class="id">t</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Beta.html#in_ctx_fill">in_ctx_fill</a></span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="beta_red">beta_red</a></span> : <span class="id"><a href="STerm.html#term">term</a></span> -&gt; <span class="id"><a href="STerm.html#term">term</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
| <span class="id"><a name="beta_red_lam">beta_red_lam</a></span> : <span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span>, <span class="id">beta_red</span> (<span class="id"><a href="STerm.html#app">app</a></span> (<span class="id"><a href="STerm.html#abs">abs</a></span> <span class="id">t1</span>) <span class="id">t2</span>) (<span class="id"><a href="STerm.html#subst1">subst1</a></span> <span class="id">t2</span> <span class="id">t1</span>)<br/>
| <span class="id"><a name="beta_red_switch">beta_red_switch</a></span> : <span class="kwd">forall</span> <span class="id">l</span> <span class="id">t</span> <span class="id">l1</span> <span class="id">l2</span>, <span class="id">beta_red</span> (<span class="id"><a href="STerm.html#switch">switch</a></span> (<span class="id"><a href="STerm.html#constr">constr</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l1</span>) <span class="id">l</span>) (<span class="id">l1</span> ++ (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span>, <span class="id">t</span>) :: <span class="id">l2</span>)) (<span class="id"><a href="STerm.html#subst">subst</a></span> (<span class="id"><a href="STerm.html#read_env">read_env</a></span> <span class="id">l</span>) <span class="id">t</span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="beta_hnf">beta_hnf</a></span> <span class="id">t1</span> <span class="id">t2</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">h</span> <span class="id">t3</span> <span class="id">t4</span>, <span class="id">t1</span> = <span class="id"><a href="Beta.html#fill_hctx">fill_hctx</a></span> <span class="id">h</span> <span class="id">t3</span> /\ <span class="id">t2</span> = <span class="id"><a href="Beta.html#fill_hctx">fill_hctx</a></span> <span class="id">h</span> <span class="id">t4</span> /\ <span class="id"><a href="Beta.html#beta_red">beta_red</a></span> <span class="id">t3</span> <span class="id">t4</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="beta_hnf_ctx">beta_hnf_ctx</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">h</span> <span class="id">t1</span> <span class="id">t2</span>, <span class="id"><a href="Beta.html#beta_hnf">beta_hnf</a></span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id"><a href="Beta.html#beta_hnf">beta_hnf</a></span> (<span class="id"><a href="Beta.html#fill_hctx">fill_hctx</a></span> <span class="id">h</span> <span class="id">t1</span>) (<span class="id"><a href="Beta.html#fill_hctx">fill_hctx</a></span> <span class="id">h</span> <span class="id">t2</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">h</span> <span class="id">t1</span> <span class="id">t2</span> (<span class="id">h2</span> &amp; <span class="id">t3</span> &amp; <span class="id">t4</span> &amp; -&gt; &amp; -&gt; &amp; <span class="id">Hbeta</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> &lt;- !<span class="id"><a href="Beta.html#fill_compose">fill_compose</a></span>. <span class="id">eexists</span>; <span class="id">eauto</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="beta_hnf_red">beta_hnf_red</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span>, <span class="id"><a href="Beta.html#beta_red">beta_red</a></span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id"><a href="Beta.html#beta_hnf">beta_hnf</a></span> <span class="id">t1</span> <span class="id">t2</span>.<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">H</span>. <span class="kwd">exists</span> <span class="id"><a href="Beta.html#h_hole">h_hole</a></span>, <span class="id">t1</span>, <span class="id">t2</span>.<br/>
&nbsp;&nbsp;<span class="id">auto</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="beta_hnf_beta">beta_hnf_beta</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span>, <span class="id"><a href="Beta.html#beta_hnf">beta_hnf</a></span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id"><a href="Beta.html#beta">beta</a></span> <span class="id">t1</span> <span class="id">t2</span>.<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">t1</span> <span class="id">t2</span> (<span class="id">h</span> &amp; <span class="id">t3</span> &amp; <span class="id">t4</span> &amp; -&gt; &amp; -&gt; &amp; <span class="id">Hbeta</span>).<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">h</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">try</span> (<span class="id">constructor</span>; <span class="id">assumption</span>).<br/>
&nbsp;&nbsp;<span class="id">inversion</span> <span class="id">Hbeta</span>; <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="beta_progress">beta_progress</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span>, <span class="id"><a href="Beta.html#is_value">is_value</a></span> <span class="id">t</span> \/ <span class="id"><a href="Beta.html#beta_herr">beta_herr</a></span> <span class="id">t</span> \/ <span class="kwd">exists</span> <span class="id">t2</span>, <span class="id"><a href="Beta.html#beta_hnf">beta_hnf</a></span> <span class="id">t</span> <span class="id">t2</span>.<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">t</span> <span class="kwd">using</span> <span class="id"><a href="STerm.html#term_ind2">term_ind2</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">left</span>. <span class="id">constructor</span>. <span class="id">apply</span> <span class="id"><a href="Beta.html#is_hnf_var">is_hnf_var</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">left</span>. <span class="id">constructor</span>. <span class="id">apply</span> <span class="id"><a href="Beta.html#is_hnf_dvar">is_hnf_dvar</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">left</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">IHt1</span> <span class="kwd">as</span> [<span class="id">Hval</span> | [<span class="id">Herr</span> | [<span class="id">t3</span> <span class="id">Ht3</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inversion</span> <span class="id">Hval</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">right</span>. <span class="id">right</span>. <span class="id">eexists</span>. <span class="id">apply</span> <span class="id"><a href="Beta.html#beta_hnf_red">beta_hnf_red</a></span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">right</span>. <span class="id">left</span>. <span class="id">apply</span> <span class="id"><a href="Beta.html#beta_herr_err">beta_herr_err</a></span>, <span class="id"><a href="Beta.html#beta_err_app_constr">beta_err_app_constr</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">left</span>. <span class="id">constructor</span>. <span class="id">apply</span> <span class="id"><a href="Beta.html#is_hnf_app">is_hnf_app</a></span>. <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">right</span>. <span class="id">left</span>. <span class="id">apply</span> <span class="id"><a href="Beta.html#in_ctx_app">in_ctx_app</a></span>; <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">right</span>. <span class="id">right</span>. <span class="id">eexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Beta.html#beta_hnf_ctx">beta_hnf_ctx</a></span> <span class="kwd">with</span> (<span class="id">h</span> := <span class="id"><a href="Beta.html#h_app">h_app</a></span> <span class="id"><a href="Beta.html#h_hole">h_hole</a></span> <span class="id">t2</span>); <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">left</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">IHt</span> <span class="kwd">as</span> [<span class="id">Hval</span> | [<span class="id">Herr</span> | [<span class="id">t2</span> <span class="id">Ht2</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inversion</span> <span class="id">Hval</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">right</span>. <span class="id">left</span>. <span class="id">apply</span> <span class="id"><a href="Beta.html#beta_herr_err">beta_herr_err</a></span>, <span class="id"><a href="Beta.html#beta_err_switch_abs">beta_err_switch_abs</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">right</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#nth_error">nth_error</a></span> <span class="id">m</span> <span class="id">tag</span>) <span class="kwd">as</span> [[<span class="id">p</span> <span class="id">t</span>]|] <span class="id">eqn</span>:<span class="id">Htag</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#nth_error_split">nth_error_split</a></span> <span class="kwd">in</span> <span class="id">Htag</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Htag</span> <span class="kwd">as</span> (<span class="id">l1</span> &amp; <span class="id">l2</span> &amp; -&gt; &amp; &lt;-).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_dec">Nat.eq_dec</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l</span>) <span class="id">p</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id">subst</span>. <span class="id">right</span>. <span class="id">eexists</span>. <span class="id">apply</span> <span class="id"><a href="Beta.html#beta_hnf_red">beta_hnf_red</a></span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id">left</span>. <span class="id">apply</span> <span class="id"><a href="Beta.html#beta_herr_err">beta_herr_err</a></span>, <span class="id"><a href="Beta.html#beta_err_switch_numvars">beta_err_switch_numvars</a></span>. <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-- <span class="id">left</span>. <span class="id">apply</span> <span class="id"><a href="Beta.html#beta_herr_err">beta_herr_err</a></span>, <span class="id"><a href="Beta.html#beta_err_switch_overflow">beta_err_switch_overflow</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#nth_error_None">nth_error_None</a></span>. <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">left</span>. <span class="id">constructor</span>. <span class="id">apply</span> <span class="id"><a href="Beta.html#is_hnf_switch">is_hnf_switch</a></span>. <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">right</span>. <span class="id">left</span>. <span class="id">apply</span> <span class="id"><a href="Beta.html#in_ctx_switch">in_ctx_switch</a></span>; <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">right</span>. <span class="id">right</span>. <span class="id">eexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Beta.html#beta_hnf_ctx">beta_hnf_ctx</a></span> <span class="kwd">with</span> (<span class="id">h</span> := <span class="id"><a href="Beta.html#h_switch">h_switch</a></span> <span class="id"><a href="Beta.html#h_hole">h_hole</a></span> <span class="id">m</span>); <span class="id">eassumption</span>.<br/>
Qed.</details>
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="mk_merge">mk_merge</a></span> {<span class="id">A</span> : <span class="kwd">Type</span>} (<span class="id">l1</span> <span class="id">l2</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>)) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">l1</span>, <span class="id">l2</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l1</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l2</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">l1</span> ++ <span class="id">l2</span>)<br/>
&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Arguments</span> <span class="id"><a href="Beta.html#mk_merge">mk_merge</a></span> {<span class="id">A</span>} <span class="id">l1</span> <span class="id">l2</span> : <span class="id">simpl</span> <span class="id">nomatch</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Forall_1">Forall_1</a></span> {<span class="id">A</span> : <span class="kwd">Type</span>} (<span class="id">P</span> : <span class="id">A</span> -&gt; <span class="kwd">Prop</span>) <span class="id">x</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id">P</span> (<span class="id">x</span> :: <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) &lt;-&gt; <span class="id">P</span> <span class="id">x</span>.<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">split</span>; <span class="id">intros</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;- <span class="id">inversion</span> <span class="id">H</span>; <span class="id">subst</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>; [<span class="id">assumption</span>|<span class="id">constructor</span>].<br/>
Qed.</details>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="compare_branches">compare_branches</a></span> (<span class="id">l1</span> <span class="id">l2</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> * <span class="id"><a href="STerm.html#term">term</a></span>)) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">l1</span>, <span class="id">l2</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;| (<span class="id">p1</span>, <span class="id">t1</span>) :: <span class="id">l1</span>, (<span class="id">p2</span>, <span class="id">t2</span>) :: <span class="id">l2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_dec">Nat.eq_dec</a></span> <span class="id">p1</span> <span class="id">p2</span> <span class="kwd">then</span> <span class="id"><a href="Beta.html#mk_merge">mk_merge</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> ((<span class="id">t1</span>, <span class="id">t2</span>) :: <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)) (<span class="id">compare_branches</span> <span class="id">l1</span> <span class="id">l2</span>) <span class="kwd">else</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="compare_branches_app">compare_branches_app</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l1</span> <span class="id">l2</span> <span class="id">l3</span> <span class="id">l4</span>, <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l1</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#length">length</a></span> <span class="id">l3</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="Beta.html#compare_branches">compare_branches</a></span> (<span class="id">l1</span> ++ <span class="id">l2</span>) (<span class="id">l3</span> ++ <span class="id">l4</span>) = <span class="id"><a href="Beta.html#mk_merge">mk_merge</a></span> (<span class="id"><a href="Beta.html#compare_branches">compare_branches</a></span> <span class="id">l1</span> <span class="id">l3</span>) (<span class="id"><a href="Beta.html#compare_branches">compare_branches</a></span> <span class="id">l2</span> <span class="id">l4</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">l1</span>; <span class="id">intros</span> <span class="id">l2</span> <span class="id">l3</span> <span class="id">l4</span> <span class="id">Hlen</span>; <span class="id">destruct</span> <span class="id">l3</span>; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id"><a href="Beta.html#compare_branches">compare_branches</a></span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id">discriminate</span>.<br/>
&nbsp;&nbsp;- <span class="id">discriminate</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">a</span>; <span class="id">destruct</span> <span class="id">p</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_dec">Nat.eq_dec</a></span>; [|<span class="id">reflexivity</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">IHl1</span> <span class="kwd">by</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id"><a href="Beta.html#compare_branches">compare_branches</a></span>; <span class="id">simpl</span> <span class="kwd">in</span> *; [|<span class="id">reflexivity</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id"><a href="Beta.html#compare_branches">compare_branches</a></span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">reflexivity</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="compare_hnf">compare_hnf</a></span> (<span class="id">t1</span> <span class="id">t2</span> : <span class="id"><a href="STerm.html#term">term</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">t1</span>, <span class="id">t2</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="STerm.html#var">var</a></span> <span class="id">n1</span>, <span class="id"><a href="STerm.html#var">var</a></span> <span class="id">n2</span> =&gt; <span class="kwd">if</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_dec">Nat.eq_dec</a></span> <span class="id">n1</span> <span class="id">n2</span> <span class="kwd">then</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="kwd">else</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="STerm.html#dvar">dvar</a></span> <span class="id">d1</span>, <span class="id"><a href="STerm.html#dvar">dvar</a></span> <span class="id">d2</span> =&gt; <span class="kwd">if</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_dec">Nat.eq_dec</a></span> <span class="id">d1</span> <span class="id">d2</span> <span class="kwd">then</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="kwd">else</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="STerm.html#app">app</a></span> <span class="id">t1</span> <span class="id">u1</span>, <span class="id"><a href="STerm.html#app">app</a></span> <span class="id">t2</span> <span class="id">u2</span> =&gt; <span class="id"><a href="Beta.html#mk_merge">mk_merge</a></span> (<span class="id">compare_hnf</span> <span class="id">t1</span> <span class="id">t2</span>) (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> ((<span class="id">u1</span>, <span class="id">u2</span>) :: <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>))<br/>
&nbsp;&nbsp;| <span class="id"><a href="STerm.html#switch">switch</a></span> <span class="id">t1</span> <span class="id">l1</span>, <span class="id"><a href="STerm.html#switch">switch</a></span> <span class="id">t2</span> <span class="id">l2</span> =&gt; <span class="id"><a href="Beta.html#mk_merge">mk_merge</a></span> (<span class="id">compare_hnf</span> <span class="id">t1</span> <span class="id">t2</span>) (<span class="id"><a href="Beta.html#compare_branches">compare_branches</a></span> <span class="id">l1</span> <span class="id">l2</span>)<br/>
&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="beta_convertible_app">beta_convertible_app</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">u1</span> <span class="id">u2</span>, <span class="id"><a href="Rewrite.html#convertible">convertible</a></span> <span class="id"><a href="Beta.html#beta">beta</a></span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id"><a href="Rewrite.html#convertible">convertible</a></span> <span class="id"><a href="Beta.html#beta">beta</a></span> <span class="id">u1</span> <span class="id">u2</span> -&gt; <span class="id"><a href="Rewrite.html#convertible">convertible</a></span> <span class="id"><a href="Beta.html#beta">beta</a></span> (<span class="id"><a href="STerm.html#app">app</a></span> <span class="id">t1</span> <span class="id">u1</span>) (<span class="id"><a href="STerm.html#app">app</a></span> <span class="id">t2</span> <span class="id">u2</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">u1</span> <span class="id">u2</span> <span class="id">Ht</span> <span class="id">Hu</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_compose">star_compose</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_map_impl">star_map_impl</a></span> <span class="kwd">with</span> (<span class="id">f</span> := <span class="kwd">fun</span> <span class="id">t</span> =&gt; <span class="id"><a href="STerm.html#app">app</a></span> <span class="id">t</span> <span class="id">u1</span>); [|<span class="id">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> [<span class="id">Hxy</span> | <span class="id">Hxy</span>]; [<span class="id">left</span>|<span class="id">right</span>]; <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_map_impl">star_map_impl</a></span> <span class="kwd">with</span> (<span class="id">f</span> := <span class="kwd">fun</span> <span class="id">u</span> =&gt; <span class="id"><a href="STerm.html#app">app</a></span> <span class="id">t2</span> <span class="id">u</span>); [|<span class="id">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> [<span class="id">Hxy</span> | <span class="id">Hxy</span>]; [<span class="id">left</span>|<span class="id">right</span>]; <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="beta_convertible_switch">beta_convertible_switch</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">l1</span> <span class="id">l2</span>, <span class="id"><a href="Rewrite.html#convertible">convertible</a></span> <span class="id"><a href="Beta.html#beta">beta</a></span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> '(<span class="id">p1</span>, <span class="id">t1</span>) '(<span class="id">p2</span>, <span class="id">t2</span>) =&gt; <span class="id">p1</span> = <span class="id">p2</span> /\ <span class="id"><a href="Rewrite.html#convertible">convertible</a></span> <span class="id"><a href="Beta.html#beta">beta</a></span> <span class="id">t1</span> <span class="id">t2</span>) <span class="id">l1</span> <span class="id">l2</span> -&gt; <span class="id"><a href="Rewrite.html#convertible">convertible</a></span> <span class="id"><a href="Beta.html#beta">beta</a></span> (<span class="id"><a href="STerm.html#switch">switch</a></span> <span class="id">t1</span> <span class="id">l1</span>) (<span class="id"><a href="STerm.html#switch">switch</a></span> <span class="id">t2</span> <span class="id">l2</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">l1</span> <span class="id">l2</span> <span class="id">Ht</span> <span class="id">Hl</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_compose">star_compose</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_map_impl">star_map_impl</a></span> <span class="kwd">with</span> (<span class="id">f</span> := <span class="kwd">fun</span> <span class="id">t</span> =&gt; <span class="id"><a href="STerm.html#switch">switch</a></span> <span class="id">t</span> <span class="id">l1</span>); [|<span class="id">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> [<span class="id">Hxy</span> | <span class="id">Hxy</span>]; [<span class="id">left</span>|<span class="id">right</span>]; <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Rewrite.html#star_list">star_list</a></span> <span class="kwd">with</span> (<span class="id">RA</span> := (<span class="kwd">fun</span> '(<span class="id">p1</span>, <span class="id">t1</span>) '(<span class="id">p2</span>, <span class="id">t2</span>) =&gt; <span class="id">p1</span> = <span class="id">p2</span> /\ <span class="id"><a href="Rewrite.html#symc">symc</a></span> <span class="id"><a href="Beta.html#beta">beta</a></span> <span class="id">t1</span> <span class="id">t2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> <span class="id">la</span> <span class="id">lb</span> [? <span class="id">u1</span>] [<span class="id">p</span> <span class="id">u2</span>] [-&gt; <span class="id">Hu</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hu</span> <span class="kwd">as</span> [<span class="id">Hu</span> | <span class="id">Hu</span>]; [<span class="id">left</span> | <span class="id">right</span>]; <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Misc.html#Forall2_impl">Forall2_impl</a></span>; [|<span class="id">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> [? <span class="id">u1</span>] [<span class="id">p</span> <span class="id">u2</span>] [-&gt; <span class="id">Hu</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_map_impl">star_map_impl</a></span>; [|<span class="id">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">tauto</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="betaiota_convertible_app">betaiota_convertible_app</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">defs</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">u1</span> <span class="id">u2</span>, <span class="id"><a href="Rewrite.html#convertible">convertible</a></span> (<span class="id"><a href="Beta.html#betaiota">betaiota</a></span> <span class="id">defs</span>) <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id"><a href="Rewrite.html#convertible">convertible</a></span> (<span class="id"><a href="Beta.html#betaiota">betaiota</a></span> <span class="id">defs</span>) <span class="id">u1</span> <span class="id">u2</span> -&gt; <span class="id"><a href="Rewrite.html#convertible">convertible</a></span> (<span class="id"><a href="Beta.html#betaiota">betaiota</a></span> <span class="id">defs</span>) (<span class="id"><a href="STerm.html#app">app</a></span> <span class="id">t1</span> <span class="id">u1</span>) (<span class="id"><a href="STerm.html#app">app</a></span> <span class="id">t2</span> <span class="id">u2</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">defs</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">u1</span> <span class="id">u2</span> <span class="id">Ht</span> <span class="id">Hu</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_compose">star_compose</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_map_impl">star_map_impl</a></span> <span class="kwd">with</span> (<span class="id">f</span> := <span class="kwd">fun</span> <span class="id">t</span> =&gt; <span class="id"><a href="STerm.html#app">app</a></span> <span class="id">t</span> <span class="id">u1</span>); [|<span class="id">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> [[<span class="id">Hxy</span> | <span class="id">Hxy</span>] | [<span class="id">Hxy</span> | <span class="id">Hxy</span>]]; [<span class="id">left</span>; <span class="id">left</span>|<span class="id">left</span>; <span class="id">right</span>|<span class="id">right</span>; <span class="id">left</span>|<span class="id">right</span>; <span class="id">right</span>]; <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_map_impl">star_map_impl</a></span> <span class="kwd">with</span> (<span class="id">f</span> := <span class="kwd">fun</span> <span class="id">u</span> =&gt; <span class="id"><a href="STerm.html#app">app</a></span> <span class="id">t2</span> <span class="id">u</span>); [|<span class="id">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> [[<span class="id">Hxy</span> | <span class="id">Hxy</span>] | [<span class="id">Hxy</span> | <span class="id">Hxy</span>]]; [<span class="id">left</span>; <span class="id">left</span>|<span class="id">left</span>; <span class="id">right</span>|<span class="id">right</span>; <span class="id">left</span>|<span class="id">right</span>; <span class="id">right</span>]; <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="betaiota_convertible_switch">betaiota_convertible_switch</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">defs</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">l1</span> <span class="id">l2</span>, <span class="id"><a href="Rewrite.html#convertible">convertible</a></span> (<span class="id"><a href="Beta.html#betaiota">betaiota</a></span> <span class="id">defs</span>) <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> '(<span class="id">p1</span>, <span class="id">t1</span>) '(<span class="id">p2</span>, <span class="id">t2</span>) =&gt; <span class="id">p1</span> = <span class="id">p2</span> /\ <span class="id"><a href="Rewrite.html#convertible">convertible</a></span> (<span class="id"><a href="Beta.html#betaiota">betaiota</a></span> <span class="id">defs</span>) <span class="id">t1</span> <span class="id">t2</span>) <span class="id">l1</span> <span class="id">l2</span> -&gt; <span class="id"><a href="Rewrite.html#convertible">convertible</a></span> (<span class="id"><a href="Beta.html#betaiota">betaiota</a></span> <span class="id">defs</span>) (<span class="id"><a href="STerm.html#switch">switch</a></span> <span class="id">t1</span> <span class="id">l1</span>) (<span class="id"><a href="STerm.html#switch">switch</a></span> <span class="id">t2</span> <span class="id">l2</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">defs</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">l1</span> <span class="id">l2</span> <span class="id">Ht</span> <span class="id">Hl</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_compose">star_compose</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_map_impl">star_map_impl</a></span> <span class="kwd">with</span> (<span class="id">f</span> := <span class="kwd">fun</span> <span class="id">t</span> =&gt; <span class="id"><a href="STerm.html#switch">switch</a></span> <span class="id">t</span> <span class="id">l1</span>); [|<span class="id">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> [[<span class="id">Hxy</span> | <span class="id">Hxy</span>] | [<span class="id">Hxy</span> | <span class="id">Hxy</span>]]; [<span class="id">left</span>; <span class="id">left</span>|<span class="id">left</span>; <span class="id">right</span>|<span class="id">right</span>; <span class="id">left</span>|<span class="id">right</span>; <span class="id">right</span>]; <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Rewrite.html#star_list">star_list</a></span> <span class="kwd">with</span> (<span class="id">RA</span> := (<span class="kwd">fun</span> '(<span class="id">p1</span>, <span class="id">t1</span>) '(<span class="id">p2</span>, <span class="id">t2</span>) =&gt; <span class="id">p1</span> = <span class="id">p2</span> /\ <span class="id"><a href="Rewrite.html#symc">symc</a></span> (<span class="id"><a href="Beta.html#betaiota">betaiota</a></span> <span class="id">defs</span>) <span class="id">t1</span> <span class="id">t2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">intros</span> <span class="id">la</span> <span class="id">lb</span> [? <span class="id">u1</span>] [<span class="id">p</span> <span class="id">u2</span>] [-&gt; <span class="id">Hu</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Hu</span> <span class="kwd">as</span> [[<span class="id">Hu</span> | <span class="id">Hu</span>] | [<span class="id">Hu</span> | <span class="id">Hu</span>]]; [<span class="id">left</span>; <span class="id">left</span>|<span class="id">left</span>; <span class="id">right</span>|<span class="id">right</span>; <span class="id">left</span>|<span class="id">right</span>; <span class="id">right</span>]; <span class="id">constructor</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Misc.html#Forall2_impl">Forall2_impl</a></span>; [|<span class="id">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> [? <span class="id">u1</span>] [<span class="id">p</span> <span class="id">u2</span>] [-&gt; <span class="id">Hu</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Rewrite.html#star_map_impl">star_map_impl</a></span>; [|<span class="id">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">tauto</span>.<br/>
Qed.</details>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="compare_branches_trans">compare_branches_trans</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l1</span> <span class="id">l2</span> <span class="id">l3</span> <span class="id">l12</span> <span class="id">l23</span>, <span class="id"><a href="Beta.html#compare_branches">compare_branches</a></span> <span class="id">l1</span> <span class="id">l2</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l12</span> -&gt; <span class="id"><a href="Beta.html#compare_branches">compare_branches</a></span> <span class="id">l2</span> <span class="id">l3</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l23</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">l13</span>, <span class="id"><a href="Beta.html#compare_branches">compare_branches</a></span> <span class="id">l1</span> <span class="id">l3</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l13</span> /\ <span class="id"><a href="Misc.html#Forall3">Forall3</a></span> (<span class="kwd">fun</span> '(<span class="id">x1</span>, <span class="id">x2</span>) '(<span class="id">y2</span>, <span class="id">y3</span>) '(<span class="id">z1</span>, <span class="id">z3</span>) =&gt; <span class="id">x1</span> = <span class="id">z1</span> /\ <span class="id">x2</span> = <span class="id">y2</span> /\ <span class="id">y3</span> = <span class="id">z3</span>) <span class="id">l12</span> <span class="id">l23</span> <span class="id">l13</span>.<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">l1</span>; <span class="id">intros</span> <span class="id">l2</span> <span class="id">l3</span> <span class="id">l12</span> <span class="id">l23</span> <span class="id">H12</span> <span class="id">H23</span>; <span class="id">destruct</span> <span class="id">l2</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">try</span> <span class="id">discriminate</span>; <span class="id">destruct</span> <span class="id">l3</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">try</span> <span class="id">discriminate</span>.<br/>
&nbsp;&nbsp;- <span class="kwd">exists</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>. <span class="id">split</span>; [<span class="id">reflexivity</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">injection</span> <span class="id">H12</span> <span class="kwd">as</span> <span class="id">H12</span>; <span class="id">injection</span> <span class="id">H23</span> <span class="kwd">as</span> <span class="id">H23</span>; <span class="id">subst</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">a</span>; <span class="id">discriminate</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">p</span>; <span class="id">discriminate</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">a</span>; <span class="id">destruct</span> <span class="id">p</span>; <span class="id">destruct</span> <span class="id">p0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_dec">Nat.eq_dec</a></span>; [|<span class="id">discriminate</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_dec">Nat.eq_dec</a></span>; [|<span class="id">discriminate</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_dec">Nat.eq_dec</a></span>; [|<span class="id">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Beta.html#compare_branches">compare_branches</a></span> <span class="id">l1</span> <span class="id">l2</span>) <span class="id">eqn</span>:<span class="id">Hl12</span>; [|<span class="id">discriminate</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Beta.html#compare_branches">compare_branches</a></span> <span class="id">l2</span> <span class="id">l3</span>) <span class="id">eqn</span>:<span class="id">Hl23</span>; [|<span class="id">discriminate</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHl1</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hl12</span> <span class="id">Hl23</span>). <span class="id">destruct</span> <span class="id">IHl1</span> <span class="kwd">as</span> (<span class="id">l13</span> &amp; <span class="id">Hl13</span> &amp; <span class="id">Hall</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> ((<span class="id">t</span>, <span class="id">t1</span>) :: <span class="id">l13</span>). <span class="id">rewrite</span> <span class="id">Hl13</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; [<span class="id">reflexivity</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">injection</span> <span class="id">H12</span> <span class="kwd">as</span> <span class="id">H12</span>; <span class="id">injection</span> <span class="id">H23</span> <span class="kwd">as</span> <span class="id">H23</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; [|<span class="id">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tauto</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="compare_hnf_trans">compare_hnf_trans</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">t3</span> <span class="id">l12</span> <span class="id">l23</span>, <span class="id"><a href="Beta.html#compare_hnf">compare_hnf</a></span> <span class="id">t1</span> <span class="id">t2</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l12</span> -&gt; <span class="id"><a href="Beta.html#compare_hnf">compare_hnf</a></span> <span class="id">t2</span> <span class="id">t3</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l23</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id">l13</span>, <span class="id"><a href="Beta.html#compare_hnf">compare_hnf</a></span> <span class="id">t1</span> <span class="id">t3</span> = <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l13</span> /\ <span class="id"><a href="Misc.html#Forall3">Forall3</a></span> (<span class="kwd">fun</span> '(<span class="id">x1</span>, <span class="id">x2</span>) '(<span class="id">y2</span>, <span class="id">y3</span>) '(<span class="id">z1</span>, <span class="id">z3</span>) =&gt; <span class="id">x1</span> = <span class="id">z1</span> /\ <span class="id">x2</span> = <span class="id">y2</span> /\ <span class="id">y3</span> = <span class="id">z3</span>) <span class="id">l12</span> <span class="id">l23</span> <span class="id">l13</span>.<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">t1</span>; <span class="id">intros</span> <span class="id">t2</span> <span class="id">t3</span> <span class="id">l12</span> <span class="id">l23</span> <span class="id">H12</span> <span class="id">H23</span>; <span class="id">destruct</span> <span class="id">t2</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">try</span> <span class="id">discriminate</span>; <span class="id">destruct</span> <span class="id">t3</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">try</span> <span class="id">discriminate</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_dec">Nat.eq_dec</a></span>; [|<span class="id">discriminate</span>]. <span class="id">destruct</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_dec">Nat.eq_dec</a></span>; [|<span class="id">discriminate</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>. <span class="id">split</span>; [<span class="id">destruct</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_dec">Nat.eq_dec</a></span>; <span class="id">congruence</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">injection</span> <span class="id">H12</span> <span class="kwd">as</span> <span class="id">H12</span>; <span class="id">injection</span> <span class="id">H23</span> <span class="kwd">as</span> <span class="id">H23</span>; <span class="id">subst</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_dec">Nat.eq_dec</a></span>; [|<span class="id">discriminate</span>]. <span class="id">destruct</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_dec">Nat.eq_dec</a></span>; [|<span class="id">discriminate</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>. <span class="id">split</span>; [<span class="id">destruct</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_dec">Nat.eq_dec</a></span>; <span class="id">congruence</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">injection</span> <span class="id">H12</span> <span class="kwd">as</span> <span class="id">H12</span>; <span class="id">injection</span> <span class="id">H23</span> <span class="kwd">as</span> <span class="id">H23</span>; <span class="id">subst</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">specialize</span> (<span class="id">IHt1_1</span> <span class="id">t2_1</span> <span class="id">t3_1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id"><a href="Beta.html#compare_hnf">compare_hnf</a></span> <span class="kwd">as</span> [<span class="id">l12a</span>|]; [|<span class="id">discriminate</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id"><a href="Beta.html#compare_hnf">compare_hnf</a></span> <span class="kwd">as</span> [<span class="id">l23a</span>|]; [|<span class="id">discriminate</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">injection</span> <span class="id">H12</span> <span class="kwd">as</span> <span class="id">H12</span>; <span class="id">injection</span> <span class="id">H23</span> <span class="kwd">as</span> <span class="id">H23</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id">IHt1_1</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span>) <span class="kwd">as</span> (<span class="id">l13a</span> &amp; <span class="id">H13</span> &amp; <span class="id">Hall</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">l13a</span> ++ (<span class="id">t1_2</span>, <span class="id">t3_2</span>) :: <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>). <span class="id">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id">H13</span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">subst</span>. <span class="id">apply</span> <span class="id"><a href="Misc.html#Forall3_app">Forall3_app</a></span>; [<span class="id">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; [|<span class="id">constructor</span>]. <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> (<span class="id"><a href="Beta.html#compare_hnf">compare_hnf</a></span> <span class="id">t1</span> <span class="id">t2</span>) <span class="id">eqn</span>:<span class="id">Hl12</span>; [|<span class="id">discriminate</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Beta.html#compare_hnf">compare_hnf</a></span> <span class="id">t2</span> <span class="id">t3</span>) <span class="id">eqn</span>:<span class="id">Hl23</span>; [|<span class="id">discriminate</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">IHt1</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hl12</span> <span class="id">Hl23</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">IHt1</span> <span class="kwd">as</span> (<span class="id">l13</span> &amp; <span class="id">Hl13</span> &amp; <span class="id">Hall</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Beta.html#compare_branches">compare_branches</a></span> <span class="id">l</span> <span class="id">l0</span>) <span class="id">eqn</span>:<span class="id">Hb12</span>; [|<span class="id">discriminate</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Beta.html#compare_branches">compare_branches</a></span> <span class="id">l0</span> <span class="id">l1</span>) <span class="id">eqn</span>:<span class="id">Hb23</span>; [|<span class="id">discriminate</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Beta.html#compare_branches_trans">compare_branches_trans</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hb12</span> <span class="id">Hb23</span>) <span class="kwd">as</span> (<span class="id">l13b</span> &amp; <span class="id">Hl13b</span> &amp; <span class="id">Hallb</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">exists</span> (<span class="id">l13</span> ++ <span class="id">l13b</span>). <span class="id">rewrite</span> <span class="id">Hl13</span>, <span class="id">Hl13b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split</span>; [<span class="id">reflexivity</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">injection</span> <span class="id">H12</span> <span class="kwd">as</span> <span class="id">H12</span>; <span class="id">injection</span> <span class="id">H23</span> <span class="kwd">as</span> <span class="id">H23</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Misc.html#Forall3_app">Forall3_app</a></span>; <span class="id">assumption</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="all_are">all_are</a></span> {<span class="id">A</span> : <span class="kwd">Type</span>} (<span class="id">R</span> : <span class="id">A</span> -&gt; <span class="kwd">Prop</span>) (<span class="id">x</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id">A</span>)) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">x</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall">Forall</a></span> <span class="id">R</span> <span class="id">l</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="all_are_impl">all_are_impl</a></span> {<span class="id">A</span> : <span class="kwd">Type</span>} (<span class="id">R1</span> <span class="id">R2</span> : <span class="id">A</span> -&gt; <span class="kwd">Prop</span>) (<span class="id">H</span> : <span class="kwd">forall</span> <span class="id">x</span>, <span class="id">R1</span> <span class="id">x</span> -&gt; <span class="id">R2</span> <span class="id">x</span>) :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span>, <span class="id"><a href="Beta.html#all_are">all_are</a></span> <span class="id">R1</span> <span class="id">l</span> -&gt; <span class="id"><a href="Beta.html#all_are">all_are</a></span> <span class="id">R2</span> <span class="id">l</span>.<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> [<span class="id">l</span>|] <span class="id">Hl</span>; [|<span class="id">assumption</span>]; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_impl">Forall_impl</a></span>; <span class="id">eassumption</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="all_are_merge">all_are_merge</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> (<span class="id">R</span> : <span class="id">A</span> -&gt; <span class="kwd">Prop</span>) <span class="id">l1</span> <span class="id">l2</span>, <span class="id"><a href="Beta.html#all_are">all_are</a></span> <span class="id">R</span> <span class="id">l1</span> -&gt; <span class="id"><a href="Beta.html#all_are">all_are</a></span> <span class="id">R</span> <span class="id">l2</span> -&gt; <span class="id"><a href="Beta.html#all_are">all_are</a></span> <span class="id">R</span> (<span class="id"><a href="Beta.html#mk_merge">mk_merge</a></span> <span class="id">l1</span> <span class="id">l2</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">A</span> <span class="id">R</span> [<span class="id">l1</span>|] [<span class="id">l2</span>|] <span class="id">H1</span> <span class="id">H2</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">try</span> <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Misc.html#Forall_app_iff">Forall_app_iff</a></span>; <span class="id">tauto</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="all_are_merge_iff">all_are_merge_iff</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> (<span class="id">R</span> : <span class="id">A</span> -&gt; <span class="kwd">Prop</span>) <span class="id">l1</span> <span class="id">l2</span>, <span class="id"><a href="Beta.html#all_are">all_are</a></span> <span class="id">R</span> (<span class="id"><a href="Beta.html#mk_merge">mk_merge</a></span> <span class="id">l1</span> <span class="id">l2</span>) &lt;-&gt; <span class="id"><a href="Beta.html#all_are">all_are</a></span> <span class="id">R</span> <span class="id">l1</span> /\ <span class="id"><a href="Beta.html#all_are">all_are</a></span> <span class="id">R</span> <span class="id">l2</span>.<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">A</span> <span class="id">R</span> [<span class="id">l1</span>|] [<span class="id">l2</span>|]; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">try</span> <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Misc.html#Forall_app_iff">Forall_app_iff</a></span>; <span class="id">tauto</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="all_are2">all_are2</a></span> {<span class="id">A</span> <span class="id">B</span> : <span class="kwd">Type</span>} (<span class="id">R</span> : <span class="id">A</span> -&gt; <span class="id">B</span> -&gt; <span class="kwd">Prop</span>) <span class="id">l</span> := <span class="id"><a href="Beta.html#all_are">all_are</a></span> (<span class="id"><a href="Rewrite.html#uncurry">uncurry</a></span> <span class="id">R</span>) <span class="id">l</span>.<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="all_are2_impl">all_are2_impl</a></span> {<span class="id">A</span> <span class="id">B</span> : <span class="kwd">Type</span>} (<span class="id">R1</span> <span class="id">R2</span> : <span class="id">A</span> -&gt; <span class="id">B</span> -&gt; <span class="kwd">Prop</span>) (<span class="id">H</span> : <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id">R1</span> <span class="id">x</span> <span class="id">y</span> -&gt; <span class="id">R2</span> <span class="id">x</span> <span class="id">y</span>) :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span>, <span class="id"><a href="Beta.html#all_are2">all_are2</a></span> <span class="id">R1</span> <span class="id">l</span> -&gt; <span class="id"><a href="Beta.html#all_are2">all_are2</a></span> <span class="id">R2</span> <span class="id">l</span>.<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Beta.html#all_are_impl">all_are_impl</a></span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> [<span class="id">x</span> <span class="id">y</span>] <span class="id">Hxy</span>; <span class="id">apply</span> <span class="id">H</span>; <span class="id">assumption</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="all_are2_merge">all_are2_merge</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> <span class="id">B</span> (<span class="id">R</span> : <span class="id">A</span> -&gt; <span class="id">B</span> -&gt; <span class="kwd">Prop</span>) <span class="id">l1</span> <span class="id">l2</span>, <span class="id"><a href="Beta.html#all_are2">all_are2</a></span> <span class="id">R</span> <span class="id">l1</span> -&gt; <span class="id"><a href="Beta.html#all_are2">all_are2</a></span> <span class="id">R</span> <span class="id">l2</span> -&gt; <span class="id"><a href="Beta.html#all_are2">all_are2</a></span> <span class="id">R</span> (<span class="id"><a href="Beta.html#mk_merge">mk_merge</a></span> <span class="id">l1</span> <span class="id">l2</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Beta.html#all_are_merge">all_are_merge</a></span>; <span class="id">assumption</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="all_are2_merge_iff">all_are2_merge_iff</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">A</span> <span class="id">B</span> (<span class="id">R</span> : <span class="id">A</span> -&gt; <span class="id">B</span> -&gt; <span class="kwd">Prop</span>) <span class="id">l1</span> <span class="id">l2</span>, <span class="id"><a href="Beta.html#all_are2">all_are2</a></span> <span class="id">R</span> (<span class="id"><a href="Beta.html#mk_merge">mk_merge</a></span> <span class="id">l1</span> <span class="id">l2</span>) &lt;-&gt; <span class="id"><a href="Beta.html#all_are2">all_are2</a></span> <span class="id">R</span> <span class="id">l1</span> /\ <span class="id"><a href="Beta.html#all_are2">all_are2</a></span> <span class="id">R</span> <span class="id">l2</span>.<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span>; <span class="id">apply</span> <span class="id"><a href="Beta.html#all_are_merge_iff">all_are_merge_iff</a></span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="compare_hnf_all_are_trans">compare_hnf_all_are_trans</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">t3</span> <span class="id">P12</span> <span class="id">P23</span>, <span class="id"><a href="Beta.html#all_are2">all_are2</a></span> <span class="id">P12</span> (<span class="id"><a href="Beta.html#compare_hnf">compare_hnf</a></span> <span class="id">t1</span> <span class="id">t2</span>) -&gt; <span class="id"><a href="Beta.html#all_are2">all_are2</a></span> <span class="id">P23</span> (<span class="id"><a href="Beta.html#compare_hnf">compare_hnf</a></span> <span class="id">t2</span> <span class="id">t3</span>) -&gt; <span class="id"><a href="Beta.html#all_are2">all_are2</a></span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">z</span> =&gt; <span class="kwd">exists</span> <span class="id">y</span>, <span class="id">P12</span> <span class="id">x</span> <span class="id">y</span> /\ <span class="id">P23</span> <span class="id">y</span> <span class="id">z</span>) (<span class="id"><a href="Beta.html#compare_hnf">compare_hnf</a></span> <span class="id">t1</span> <span class="id">t3</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">t3</span> <span class="id">P12</span> <span class="id">P23</span> <span class="id">H12</span> <span class="id">H13</span>.<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Beta.html#compare_hnf">compare_hnf</a></span> <span class="id">t1</span> <span class="id">t2</span>) <span class="kwd">as</span> [<span class="id">l12</span>|] <span class="id">eqn</span>:<span class="id">Hhnf12</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; [|<span class="id">tauto</span>].<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Beta.html#compare_hnf">compare_hnf</a></span> <span class="id">t2</span> <span class="id">t3</span>) <span class="kwd">as</span> [<span class="id">l23</span>|] <span class="id">eqn</span>:<span class="id">Hhnf23</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; [|<span class="id">tauto</span>].<br/>
&nbsp;&nbsp;<span class="id">destruct</span> (<span class="id"><a href="Beta.html#compare_hnf_trans">compare_hnf_trans</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hhnf12</span> <span class="id">Hhnf23</span>) <span class="kwd">as</span> (<span class="id">l13</span> &amp; <span class="id">Hhnf13</span> &amp; <span class="id">Hall</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">Hhnf13</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Misc.html#Forall3_select3">Forall3_select3</a></span>, <span class="id"><a href="Misc.html#Forall3_impl">Forall3_impl</a></span>; [|<span class="id">eapply</span> <span class="id"><a href="Misc.html#Forall3_and">Forall3_and</a></span>; [<span class="id">eassumption</span>|<span class="id">apply</span> <span class="id"><a href="Misc.html#Forall3_and">Forall3_and</a></span> <span class="kwd">with</span> (<span class="id">P</span> := <span class="kwd">fun</span> <span class="id">x</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="Rewrite.html#uncurry">uncurry</a></span> <span class="id">P12</span> <span class="id">x</span>) (<span class="id">Q</span> := <span class="kwd">fun</span> <span class="id">_</span> <span class="id">y</span> <span class="id">_</span> =&gt; <span class="id"><a href="Rewrite.html#uncurry">uncurry</a></span> <span class="id">P23</span> <span class="id">y</span>)]].<br/>
&nbsp;&nbsp;- <span class="id">intros</span> [<span class="id">x1</span> <span class="id">x2</span>] [<span class="id">y2</span> <span class="id">y3</span>] [<span class="id">z1</span> <span class="id">z3</span>] ((-&gt; &amp; -&gt; &amp; -&gt;) &amp; <span class="id">Hxy</span> &amp; <span class="id">Hyz</span>). <span class="kwd">exists</span> <span class="id">y2</span>. <span class="id">split</span>; [<span class="id">exact</span> <span class="id">Hxy</span> | <span class="id">exact</span> <span class="id">Hyz</span>].<br/>
&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Misc.html#Forall3_unselect1">Forall3_unselect1</a></span>; <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Misc.html#Forall3_unselect2">Forall3_unselect2</a></span>; <span class="id">eassumption</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="compare_branches_refl">compare_branches_refl</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span>, <span class="id"><a href="Beta.html#all_are2">all_are2</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> (<span class="id"><a href="Beta.html#compare_branches">compare_branches</a></span> <span class="id">l</span> <span class="id">l</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">l</span>; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">a</span>. <span class="id">destruct</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_dec">Nat.eq_dec</a></span>; [|<span class="id">congruence</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Beta.html#all_are2_merge">all_are2_merge</a></span>; [|<span class="id">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>. <span class="id">constructor</span>; [|<span class="id">constructor</span>]. <span class="id">reflexivity</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="compare_hnf_refl">compare_hnf_refl</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span>, <span class="id"><a href="Beta.html#is_hnf">is_hnf</a></span> <span class="id">t</span> -&gt; <span class="id"><a href="Beta.html#all_are2">all_are2</a></span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> (<span class="id"><a href="Beta.html#compare_hnf">compare_hnf</a></span> <span class="id">t</span> <span class="id">t</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">t</span> (<span class="id">h</span> &amp; <span class="id">t1</span> &amp; <span class="id">Hhead</span> &amp; <span class="id">Hfill</span>); <span class="id">subst</span>. <span class="id">induction</span> <span class="id">h</span>.<br/>
&nbsp;&nbsp;- <span class="id">simpl</span>. <span class="id">inversion</span> <span class="id">Hhead</span>; <span class="id">subst</span>; <span class="id">simpl</span>; <span class="id">destruct</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_dec">Nat.eq_dec</a></span>; <span class="id">simpl</span>; <span class="id">try</span> <span class="id">tauto</span>; <span class="id">apply</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall_nil">Forall_nil</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">simpl</span>. <span class="id">apply</span> <span class="id"><a href="Beta.html#all_are2_merge">all_are2_merge</a></span>; [<span class="id">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>. <span class="id">apply</span> <span class="id"><a href="Beta.html#Forall_1">Forall_1</a></span>. <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id">simpl</span>. <span class="id">apply</span> <span class="id"><a href="Beta.html#all_are2_merge">all_are2_merge</a></span>; [<span class="id">assumption</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Beta.html#compare_branches_refl">compare_branches_refl</a></span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="beta_for_hnf">beta_for_hnf</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span>, <span class="id"><a href="Beta.html#is_hnf">is_hnf</a></span> <span class="id">t1</span> -&gt; <span class="id"><a href="Beta.html#beta">beta</a></span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id"><a href="Beta.html#all_are2">all_are2</a></span> (<span class="id"><a href="Rewrite.html#reflc">reflc</a></span> <span class="id"><a href="Beta.html#beta">beta</a></span>) (<span class="id"><a href="Beta.html#compare_hnf">compare_hnf</a></span> <span class="id">t1</span> <span class="id">t2</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">t1</span> <span class="id">t2</span> (<span class="id">h</span> &amp; <span class="id">t</span> &amp; <span class="id">Hhead</span> &amp; <span class="id">Hfill</span>); <span class="id">revert</span> <span class="id">t2</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">h</span>; <span class="id">intros</span> <span class="id">t2</span> <span class="id">Hbeta</span>; <span class="id">inversion</span> <span class="id">Hbeta</span>; <span class="id">subst</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">subst</span>; <span class="id">try</span> <span class="id">solve</span> [<span class="id">inversion</span> <span class="id">Hhead</span>].<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Beta.html#all_are2_merge">all_are2_merge</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id">IHh</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Beta.html#Forall_1">Forall_1</a></span>. <span class="id">right</span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Beta.html#all_are2_merge">all_are2_merge</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Beta.html#all_are2_impl">all_are2_impl</a></span>; [|<span class="id">apply</span> <span class="id"><a href="Beta.html#compare_hnf_refl">compare_hnf_refl</a></span>; <span class="kwd">exists</span> <span class="id">h</span>; <span class="kwd">exists</span> <span class="id">t</span>; <span class="id">split</span>; [<span class="id">assumption</span>|<span class="id">reflexivity</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> -&gt;; <span class="id">right</span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Beta.html#Forall_1">Forall_1</a></span>. <span class="id">left</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">h</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">try</span> <span class="id">discriminate</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inversion</span> <span class="id">Hhead</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Beta.html#all_are2_merge">all_are2_merge</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id">IHh</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Beta.html#all_are2_impl">all_are2_impl</a></span>; [|<span class="id">apply</span> <span class="id"><a href="Beta.html#compare_branches_refl">compare_branches_refl</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> -&gt;; <span class="id">right</span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Beta.html#all_are2_merge">all_are2_merge</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Beta.html#all_are2_impl">all_are2_impl</a></span>; [|<span class="id">apply</span> <span class="id"><a href="Beta.html#compare_hnf_refl">compare_hnf_refl</a></span>; <span class="kwd">exists</span> <span class="id">h</span>; <span class="kwd">exists</span> <span class="id">t</span>; <span class="id">split</span>; [<span class="id">assumption</span>|<span class="id">reflexivity</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> -&gt;; <span class="id">right</span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id"><a href="Beta.html#compare_branches_app">compare_branches_app</a></span> <span class="kwd">by</span> <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Beta.html#all_are2_merge">all_are2_merge</a></span>; [<span class="id">eapply</span> <span class="id"><a href="Beta.html#all_are2_impl">all_are2_impl</a></span>; [|<span class="id">apply</span> <span class="id"><a href="Beta.html#compare_branches_refl">compare_branches_refl</a></span>]; <span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> -&gt;; <span class="id">right</span>; <span class="id">reflexivity</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_dec">Nat.eq_dec</a></span>; [|<span class="id">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Beta.html#all_are2_merge">all_are2_merge</a></span>; [|<span class="id">eapply</span> <span class="id"><a href="Beta.html#all_are2_impl">all_are2_impl</a></span>; [|<span class="id">apply</span> <span class="id"><a href="Beta.html#compare_branches_refl">compare_branches_refl</a></span>]; <span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> -&gt;; <span class="id">right</span>; <span class="id">reflexivity</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>. <span class="id">constructor</span>; [|<span class="id">constructor</span>]. <span class="id">left</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">h</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">try</span> <span class="id">discriminate</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inversion</span> <span class="id">Hhead</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="beta_is_hnf">beta_is_hnf</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span>, <span class="id"><a href="Beta.html#is_hnf">is_hnf</a></span> <span class="id">t1</span> -&gt; <span class="id"><a href="Beta.html#beta">beta</a></span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id"><a href="Beta.html#is_hnf">is_hnf</a></span> <span class="id">t2</span>.<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">t1</span> <span class="id">t2</span> (<span class="id">h</span> &amp; <span class="id">t</span> &amp; <span class="id">Hhead</span> &amp; <span class="id">Hfill</span>); <span class="id">revert</span> <span class="id">t2</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">h</span>; <span class="id">intros</span> <span class="id">t2</span> <span class="id">Hbeta</span>; <span class="id">inversion</span> <span class="id">Hbeta</span>; <span class="id">subst</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">subst</span>; <span class="id">try</span> <span class="id">solve</span> [<span class="id">inversion</span> <span class="id">Hhead</span>].<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id">IHh</span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="id">apply</span> <span class="id"><a href="Beta.html#is_hnf_app">is_hnf_app</a></span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Beta.html#is_hnf_app">is_hnf_app</a></span>. <span class="kwd">exists</span> <span class="id">h</span>; <span class="kwd">exists</span> <span class="id">t</span>; <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">h</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">try</span> <span class="id">discriminate</span>; <span class="id">subst</span>; <span class="id">inversion</span> <span class="id">Hhead</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id">IHh</span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="id">apply</span> <span class="id"><a href="Beta.html#is_hnf_switch">is_hnf_switch</a></span>. <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Beta.html#is_hnf_switch">is_hnf_switch</a></span>. <span class="kwd">exists</span> <span class="id">h</span>; <span class="kwd">exists</span> <span class="id">t</span>; <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">h</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">try</span> <span class="id">discriminate</span>; <span class="id">subst</span>; <span class="id">inversion</span> <span class="id">Hhead</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_head_betaiota_head">is_head_betaiota_head</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">defs</span> <span class="id">t</span>, <span class="id"><a href="Beta.html#is_head_betaiota">is_head_betaiota</a></span> <span class="id">defs</span> <span class="id">t</span> -&gt; <span class="id"><a href="Beta.html#is_head">is_head</a></span> <span class="id">t</span>.<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">defs</span> <span class="id">t</span> <span class="id">H</span>; <span class="id">inversion</span> <span class="id">H</span>; <span class="id">subst</span>; <span class="id">constructor</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="iota_for_hnf">iota_for_hnf</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">defs</span> <span class="id">t1</span> <span class="id">t2</span>, <span class="id"><a href="Beta.html#is_hnf_betaiota">is_hnf_betaiota</a></span> <span class="id">defs</span> <span class="id">t1</span> -&gt; <span class="id"><a href="Beta.html#iota">iota</a></span> <span class="id">defs</span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id"><a href="Beta.html#all_are2">all_are2</a></span> (<span class="id"><a href="Rewrite.html#reflc">reflc</a></span> (<span class="id"><a href="Beta.html#iota">iota</a></span> <span class="id">defs</span>)) (<span class="id"><a href="Beta.html#compare_hnf">compare_hnf</a></span> <span class="id">t1</span> <span class="id">t2</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">defs</span> <span class="id">t1</span> <span class="id">t2</span> (<span class="id">h</span> &amp; <span class="id">t</span> &amp; <span class="id">Hhead</span> &amp; <span class="id">Hfill</span>); <span class="id">revert</span> <span class="id">t2</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">h</span>; <span class="id">intros</span> <span class="id">t2</span> <span class="id">Hbeta</span>; <span class="id">inversion</span> <span class="id">Hbeta</span>; <span class="id">subst</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">subst</span>; <span class="id">try</span> <span class="id">solve</span> [<span class="id">inversion</span> <span class="id">Hhead</span>].<br/>
&nbsp;&nbsp;- <span class="id">inversion</span> <span class="id">Hhead</span>. <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Beta.html#all_are2_merge">all_are2_merge</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id">IHh</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Beta.html#Forall_1">Forall_1</a></span>. <span class="id">right</span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Beta.html#all_are2_merge">all_are2_merge</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Beta.html#all_are2_impl">all_are2_impl</a></span>; [|<span class="id">apply</span> <span class="id"><a href="Beta.html#compare_hnf_refl">compare_hnf_refl</a></span>; <span class="kwd">exists</span> <span class="id">h</span>; <span class="kwd">exists</span> <span class="id">t</span>; <span class="id">split</span>; [<span class="id">eapply</span> <span class="id"><a href="Beta.html#is_head_betaiota_head">is_head_betaiota_head</a></span>; <span class="id">eassumption</span>|<span class="id">reflexivity</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> -&gt;; <span class="id">right</span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id"><a href="Beta.html#Forall_1">Forall_1</a></span>. <span class="id">left</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Beta.html#all_are2_merge">all_are2_merge</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">apply</span> <span class="id">IHh</span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Beta.html#all_are2_impl">all_are2_impl</a></span>; [|<span class="id">apply</span> <span class="id"><a href="Beta.html#compare_branches_refl">compare_branches_refl</a></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> -&gt;; <span class="id">right</span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Beta.html#all_are2_merge">all_are2_merge</a></span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">eapply</span> <span class="id"><a href="Beta.html#all_are2_impl">all_are2_impl</a></span>; [|<span class="id">apply</span> <span class="id"><a href="Beta.html#compare_hnf_refl">compare_hnf_refl</a></span>; <span class="kwd">exists</span> <span class="id">h</span>; <span class="kwd">exists</span> <span class="id">t</span>; <span class="id">split</span>; [<span class="id">eapply</span> <span class="id"><a href="Beta.html#is_head_betaiota_head">is_head_betaiota_head</a></span>; <span class="id">eassumption</span>|<span class="id">reflexivity</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> -&gt;; <span class="id">right</span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">rewrite</span> <span class="id"><a href="Beta.html#compare_branches_app">compare_branches_app</a></span> <span class="kwd">by</span> <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Beta.html#all_are2_merge">all_are2_merge</a></span>; [<span class="id">eapply</span> <span class="id"><a href="Beta.html#all_are2_impl">all_are2_impl</a></span>; [|<span class="id">apply</span> <span class="id"><a href="Beta.html#compare_branches_refl">compare_branches_refl</a></span>]; <span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> -&gt;; <span class="id">right</span>; <span class="id">reflexivity</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_dec">Nat.eq_dec</a></span>; [|<span class="id">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Beta.html#all_are2_merge">all_are2_merge</a></span>; [|<span class="id">eapply</span> <span class="id"><a href="Beta.html#all_are2_impl">all_are2_impl</a></span>; [|<span class="id">apply</span> <span class="id"><a href="Beta.html#compare_branches_refl">compare_branches_refl</a></span>]; <span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> -&gt;; <span class="id">right</span>; <span class="id">reflexivity</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span>. <span class="id">constructor</span>; [|<span class="id">constructor</span>]. <span class="id">left</span>; <span class="id">assumption</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="beta_is_hnf_betaiota">beta_is_hnf_betaiota</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">defs</span> <span class="id">t1</span> <span class="id">t2</span>, <span class="id"><a href="Beta.html#is_hnf_betaiota">is_hnf_betaiota</a></span> <span class="id">defs</span> <span class="id">t1</span> -&gt; <span class="id"><a href="Beta.html#beta">beta</a></span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id"><a href="Beta.html#is_hnf_betaiota">is_hnf_betaiota</a></span> <span class="id">defs</span> <span class="id">t2</span>.<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">defs</span> <span class="id">t1</span> <span class="id">t2</span> (<span class="id">h</span> &amp; <span class="id">t</span> &amp; <span class="id">Hhead</span> &amp; <span class="id">Hfill</span>); <span class="id">revert</span> <span class="id">t2</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">h</span>; <span class="id">intros</span> <span class="id">t2</span> <span class="id">Hbeta</span>; <span class="id">inversion</span> <span class="id">Hbeta</span>; <span class="id">subst</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">subst</span>; <span class="id">try</span> <span class="id">solve</span> [<span class="id">inversion</span> <span class="id">Hhead</span>].<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id">IHh</span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="id">apply</span> <span class="id"><a href="Beta.html#in_ctx_app">in_ctx_app</a></span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Beta.html#in_ctx_app">in_ctx_app</a></span>. <span class="kwd">exists</span> <span class="id">h</span>; <span class="kwd">exists</span> <span class="id">t</span>; <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">h</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">try</span> <span class="id">discriminate</span>; <span class="id">subst</span>; <span class="id">inversion</span> <span class="id">Hhead</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id">IHh</span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="id">apply</span> <span class="id"><a href="Beta.html#in_ctx_switch">in_ctx_switch</a></span>. <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Beta.html#in_ctx_switch">in_ctx_switch</a></span>. <span class="kwd">exists</span> <span class="id">h</span>; <span class="kwd">exists</span> <span class="id">t</span>; <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">h</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">try</span> <span class="id">discriminate</span>; <span class="id">subst</span>; <span class="id">inversion</span> <span class="id">Hhead</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="iota_is_hnf_betaiota">iota_is_hnf_betaiota</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">defs</span> <span class="id">t1</span> <span class="id">t2</span>, <span class="id"><a href="Beta.html#is_hnf_betaiota">is_hnf_betaiota</a></span> <span class="id">defs</span> <span class="id">t1</span> -&gt; <span class="id"><a href="Beta.html#iota">iota</a></span> <span class="id">defs</span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id"><a href="Beta.html#is_hnf_betaiota">is_hnf_betaiota</a></span> <span class="id">defs</span> <span class="id">t2</span>.<br/>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">defs</span> <span class="id">t1</span> <span class="id">t2</span> (<span class="id">h</span> &amp; <span class="id">t</span> &amp; <span class="id">Hhead</span> &amp; <span class="id">Hfill</span>); <span class="id">revert</span> <span class="id">t2</span>; <span class="id">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">h</span>; <span class="id">intros</span> <span class="id">t2</span> <span class="id">Hbeta</span>; <span class="id">inversion</span> <span class="id">Hbeta</span>; <span class="id">subst</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">subst</span>; <span class="id">try</span> <span class="id">solve</span> [<span class="id">inversion</span> <span class="id">Hhead</span>].<br/>
&nbsp;&nbsp;- <span class="id">inversion</span> <span class="id">Hhead</span>; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id">IHh</span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="id">apply</span> <span class="id"><a href="Beta.html#in_ctx_app">in_ctx_app</a></span>; <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Beta.html#in_ctx_app">in_ctx_app</a></span>. <span class="kwd">exists</span> <span class="id">h</span>; <span class="kwd">exists</span> <span class="id">t</span>; <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id">IHh</span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="id">apply</span> <span class="id"><a href="Beta.html#in_ctx_switch">in_ctx_switch</a></span>. <span class="id">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id">apply</span> <span class="id"><a href="Beta.html#in_ctx_switch">in_ctx_switch</a></span>. <span class="kwd">exists</span> <span class="id">h</span>; <span class="kwd">exists</span> <span class="id">t</span>; <span class="id">tauto</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="star_beta_for_hnf">star_beta_for_hnf</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span>, <span class="id"><a href="Beta.html#is_hnf">is_hnf</a></span> <span class="id">t1</span> -&gt; <span class="id"><a href="Rewrite.html#star">star</a></span> <span class="id"><a href="Beta.html#beta">beta</a></span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id"><a href="Beta.html#all_are2">all_are2</a></span> (<span class="id"><a href="Rewrite.html#star">star</a></span> <span class="id"><a href="Beta.html#beta">beta</a></span>) (<span class="id"><a href="Beta.html#compare_hnf">compare_hnf</a></span> <span class="id">t1</span> <span class="id">t2</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">Ht1</span> <span class="id">Ht12</span>. <span class="id">induction</span> <span class="id">Ht12</span>.<br/>
&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Beta.html#all_are2_impl">all_are2_impl</a></span>; [|<span class="id">apply</span> <span class="id"><a href="Beta.html#compare_hnf_refl">compare_hnf_refl</a></span>; <span class="id">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> ? ? -&gt;; <span class="id">simpl</span>; <span class="id">apply</span> <span class="id"><a href="Rewrite.html#star_refl">star_refl</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">assert</span> (<span class="id"><a href="Beta.html#is_hnf">is_hnf</a></span> <span class="id">y</span>) <span class="kwd">by</span> (<span class="id">eapply</span> <span class="id"><a href="Beta.html#beta_is_hnf">beta_is_hnf</a></span>; <span class="id">eassumption</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Beta.html#beta_for_hnf">beta_for_hnf</a></span> <span class="kwd">in</span> <span class="id">H</span>; [|<span class="id">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Beta.html#all_are2_impl">all_are2_impl</a></span>; [|<span class="id">eapply</span> <span class="id"><a href="Beta.html#compare_hnf_all_are_trans">compare_hnf_all_are_trans</a></span>; [<span class="id">eassumption</span>|<span class="id">apply</span> <span class="id">IHHt12</span>; <span class="id">assumption</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">u</span> <span class="id">v</span> (<span class="id">w</span> &amp; <span class="id">Huw</span> &amp; <span class="id">Hwv</span>); <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Huw</span> <span class="kwd">as</span> [<span class="id">Huw</span> | -&gt;]; [<span class="id">econstructor</span>; <span class="id">eassumption</span>|<span class="id">assumption</span>].<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="star_betaiota_for_hnf">star_betaiota_for_hnf</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">defs</span> <span class="id">t1</span> <span class="id">t2</span>, <span class="id"><a href="Beta.html#is_hnf_betaiota">is_hnf_betaiota</a></span> <span class="id">defs</span> <span class="id">t1</span> -&gt; <span class="id"><a href="Rewrite.html#star">star</a></span> (<span class="id"><a href="Beta.html#betaiota">betaiota</a></span> <span class="id">defs</span>) <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id"><a href="Beta.html#all_are2">all_are2</a></span> (<span class="id"><a href="Rewrite.html#star">star</a></span> (<span class="id"><a href="Beta.html#betaiota">betaiota</a></span> <span class="id">defs</span>)) (<span class="id"><a href="Beta.html#compare_hnf">compare_hnf</a></span> <span class="id">t1</span> <span class="id">t2</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">defs</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">Ht1</span> <span class="id">Ht12</span>. <span class="id">induction</span> <span class="id">Ht12</span>.<br/>
&nbsp;&nbsp;- <span class="id">eapply</span> <span class="id"><a href="Beta.html#all_are2_impl">all_are2_impl</a></span>; [|<span class="id">eapply</span> <span class="id"><a href="Beta.html#compare_hnf_refl">compare_hnf_refl</a></span>, (<span class="id"><a href="Beta.html#in_ctx_imp">in_ctx_imp</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="Beta.html#is_head_betaiota_head">is_head_betaiota_head</a></span> <span class="id">defs</span>)); <span class="id">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> ? ? -&gt;; <span class="id">simpl</span>; <span class="id">apply</span> <span class="id"><a href="Rewrite.html#star_refl">star_refl</a></span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">H</span> | <span class="id">H</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">assert</span> (<span class="id"><a href="Beta.html#is_hnf_betaiota">is_hnf_betaiota</a></span> <span class="id">defs</span> <span class="id">y</span>) <span class="kwd">by</span> (<span class="id">eapply</span> <span class="id"><a href="Beta.html#iota_is_hnf_betaiota">iota_is_hnf_betaiota</a></span>; <span class="id">eassumption</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Beta.html#iota_for_hnf">iota_for_hnf</a></span> <span class="kwd">in</span> <span class="id">H</span>; [|<span class="id">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Beta.html#all_are2_impl">all_are2_impl</a></span>; [|<span class="id">eapply</span> <span class="id"><a href="Beta.html#compare_hnf_all_are_trans">compare_hnf_all_are_trans</a></span>; [<span class="id">eassumption</span>|<span class="id">apply</span> <span class="id">IHHt12</span>; <span class="id">assumption</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">u</span> <span class="id">v</span> (<span class="id">w</span> &amp; <span class="id">Huw</span> &amp; <span class="id">Hwv</span>); <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Huw</span> <span class="kwd">as</span> [<span class="id">Huw</span> | -&gt;]; [<span class="id">econstructor</span>; [<span class="id">left</span>|]; <span class="id">eassumption</span>|<span class="id">assumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">assert</span> (<span class="id"><a href="Beta.html#is_hnf_betaiota">is_hnf_betaiota</a></span> <span class="id">defs</span> <span class="id">y</span>) <span class="kwd">by</span> (<span class="id">eapply</span> <span class="id"><a href="Beta.html#beta_is_hnf_betaiota">beta_is_hnf_betaiota</a></span>; <span class="id">eassumption</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Beta.html#beta_for_hnf">beta_for_hnf</a></span> <span class="kwd">in</span> <span class="id">H</span>; [|<span class="id">eapply</span> (<span class="id"><a href="Beta.html#in_ctx_imp">in_ctx_imp</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="Beta.html#is_head_betaiota_head">is_head_betaiota_head</a></span> <span class="id">defs</span>)); <span class="id">eassumption</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Beta.html#all_are2_impl">all_are2_impl</a></span>; [|<span class="id">eapply</span> <span class="id"><a href="Beta.html#compare_hnf_all_are_trans">compare_hnf_all_are_trans</a></span>; [<span class="id">eassumption</span>|<span class="id">apply</span> <span class="id">IHHt12</span>; <span class="id">assumption</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">intros</span> <span class="id">u</span> <span class="id">v</span> (<span class="id">w</span> &amp; <span class="id">Huw</span> &amp; <span class="id">Hwv</span>); <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Huw</span> <span class="kwd">as</span> [<span class="id">Huw</span> | -&gt;]; [<span class="id">econstructor</span>; [<span class="id">right</span>|]; <span class="id">eassumption</span>|<span class="id">assumption</span>].<br/>
Qed.</details>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="flipl">flipl</a></span> {<span class="id">A</span> : <span class="kwd">Type</span>} (<span class="id">l</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id">A</span> * <span class="id">A</span>))) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">l</span> <span class="kwd">with</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> | <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span> =&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> '(<span class="id">x</span>, <span class="id">y</span>) =&gt; (<span class="id">y</span>, <span class="id">x</span>)) <span class="id">l</span>) <span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="mk_merge_flipl">mk_merge_flipl</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">A</span> : <span class="kwd">Type</span>) (<span class="id">l1</span> <span class="id">l2</span> : <span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="https://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id">A</span> * <span class="id">A</span>))), <span class="id"><a href="Beta.html#flipl">flipl</a></span> (<span class="id"><a href="Beta.html#mk_merge">mk_merge</a></span> <span class="id">l1</span> <span class="id">l2</span>) = <span class="id"><a href="Beta.html#mk_merge">mk_merge</a></span> (<span class="id"><a href="Beta.html#flipl">flipl</a></span> <span class="id">l1</span>) (<span class="id"><a href="Beta.html#flipl">flipl</a></span> <span class="id">l2</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">A</span> [<span class="id">l1</span>|] [<span class="id">l2</span>|]; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">try</span> <span class="id">reflexivity</span>; <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>; <span class="id">reflexivity</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="compare_branches_flip">compare_branches_flip</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l1</span> <span class="id">l2</span>, <span class="id"><a href="Beta.html#compare_branches">compare_branches</a></span> <span class="id">l2</span> <span class="id">l1</span> = <span class="id"><a href="Beta.html#flipl">flipl</a></span> (<span class="id"><a href="Beta.html#compare_branches">compare_branches</a></span> <span class="id">l1</span> <span class="id">l2</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">l1</span>; <span class="id">intros</span> <span class="id">l2</span>; <span class="id">destruct</span> <span class="id">l2</span>; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;- <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">p</span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">a</span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">p</span>; <span class="id">destruct</span> <span class="id">a</span>; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_dec">Nat.eq_dec</a></span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">destruct</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_dec">Nat.eq_dec</a></span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id">IHl1</span>. <span class="id">destruct</span> <span class="id"><a href="Beta.html#compare_branches">compare_branches</a></span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">reflexivity</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="compare_hnf_flip">compare_hnf_flip</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span>, <span class="id"><a href="Beta.html#compare_hnf">compare_hnf</a></span> <span class="id">t2</span> <span class="id">t1</span> = <span class="id"><a href="Beta.html#flipl">flipl</a></span> (<span class="id"><a href="Beta.html#compare_hnf">compare_hnf</a></span> <span class="id">t1</span> <span class="id">t2</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">t1</span>; <span class="id">intros</span> <span class="id">t2</span>; <span class="id">destruct</span> <span class="id">t2</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">try</span> <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_dec">Nat.eq_dec</a></span>; <span class="id">destruct</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_dec">Nat.eq_dec</a></span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_dec">Nat.eq_dec</a></span>; <span class="id">destruct</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_dec">Nat.eq_dec</a></span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">congruence</span>.<br/>
&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id">IHt1_1</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id"><a href="Beta.html#compare_hnf">compare_hnf</a></span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">try</span> <span class="id">rewrite</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#map_app">map_app</a></span>; <span class="id">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id">IHt1</span>; <span class="id">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Beta.html#mk_merge_flipl">mk_merge_flipl</a></span>, <span class="id"><a href="Beta.html#compare_branches_flip">compare_branches_flip</a></span>. <span class="id">reflexivity</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="all_are2_flip">all_are2_flip</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">A</span> : <span class="kwd">Type</span>) (<span class="id">P</span> : <span class="id">A</span> -&gt; <span class="id">A</span> -&gt; <span class="kwd">Prop</span>) <span class="id">l</span>, <span class="id"><a href="Beta.html#all_are2">all_are2</a></span> <span class="id">P</span> (<span class="id"><a href="Beta.html#flipl">flipl</a></span> <span class="id">l</span>) &lt;-&gt; <span class="id"><a href="Beta.html#all_are2">all_are2</a></span> (<span class="id"><a href="Rewrite.html#flip">flip</a></span> <span class="id">P</span>) <span class="id">l</span>.<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">A</span> <span class="id">P</span> [<span class="id">l</span>|]; <span class="id">simpl</span> <span class="kwd">in</span> *; [|<span class="id">reflexivity</span>].<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Misc.html#Forall_map">Forall_map</a></span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Misc.html#Forall_ext">Forall_ext</a></span>; <span class="id">intros</span> [<span class="id">a</span> <span class="id">b</span>]; <span class="id">reflexivity</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="convertible_compare_hnf">convertible_compare_hnf</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span>, <span class="id"><a href="Beta.html#is_hnf">is_hnf</a></span> <span class="id">t1</span> -&gt; <span class="id"><a href="Beta.html#is_hnf">is_hnf</a></span> <span class="id">t2</span> -&gt; <span class="id"><a href="Rewrite.html#convertible">convertible</a></span> <span class="id"><a href="Beta.html#beta">beta</a></span> <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id"><a href="Beta.html#all_are2">all_are2</a></span> (<span class="id"><a href="Rewrite.html#convertible">convertible</a></span> <span class="id"><a href="Beta.html#beta">beta</a></span>) (<span class="id"><a href="Beta.html#compare_hnf">compare_hnf</a></span> <span class="id">t1</span> <span class="id">t2</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">Ht1</span> <span class="id">Ht2</span> <span class="id">Ht</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Rewrite.html#convertible_confluent_common_reduce">convertible_confluent_common_reduce</a></span> <span class="kwd">in</span> <span class="id">Ht</span>; [|<span class="id">apply</span> <span class="id"><a href="Beta.html#beta_confluent">beta_confluent</a></span>].<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Ht</span> <span class="kwd">as</span> (<span class="id">t3</span> &amp; <span class="id">Ht13</span> &amp; <span class="id">Ht23</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Beta.html#star_beta_for_hnf">star_beta_for_hnf</a></span> <span class="kwd">in</span> <span class="id">Ht13</span>; [|<span class="id">assumption</span>].<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Beta.html#star_beta_for_hnf">star_beta_for_hnf</a></span> <span class="kwd">in</span> <span class="id">Ht23</span>; [|<span class="id">assumption</span>].<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Beta.html#compare_hnf_flip">compare_hnf_flip</a></span>, <span class="id"><a href="Beta.html#all_are2_flip">all_are2_flip</a></span> <span class="kwd">in</span> <span class="id">Ht23</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Beta.html#all_are2_impl">all_are2_impl</a></span>; [|<span class="id">eapply</span> <span class="id"><a href="Beta.html#compare_hnf_all_are_trans">compare_hnf_all_are_trans</a></span>; <span class="id">eassumption</span>].<br/>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> (<span class="id">z</span> &amp; <span class="id">Hxz</span> &amp; <span class="id">Hyz</span>).<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Rewrite.html#common_reduce_convertible">common_reduce_convertible</a></span>; <span class="id">eassumption</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="compare_branches_forall">compare_branches_forall</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l1</span> <span class="id">l2</span> <span class="id">R</span>, <span class="id"><a href="Beta.html#all_are2">all_are2</a></span> <span class="id">R</span> (<span class="id"><a href="Beta.html#compare_branches">compare_branches</a></span> <span class="id">l1</span> <span class="id">l2</span>) -&gt; <span class="id"><a href="https://coq.inria.fr/library/Coq.Lists.List.html#Forall2">Forall2</a></span> (<span class="kwd">fun</span> '(<span class="id">p1</span>, <span class="id">t1</span>) '(<span class="id">p2</span>, <span class="id">t2</span>) =&gt; <span class="id">p1</span> = <span class="id">p2</span> /\ <span class="id">R</span> <span class="id">t1</span> <span class="id">t2</span>) <span class="id">l1</span> <span class="id">l2</span>.<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">l1</span>; <span class="id">intros</span> <span class="id">l2</span> <span class="id">R</span> <span class="id">H</span>; <span class="id">destruct</span> <span class="id">l2</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">try</span> <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">a</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id">a</span>; <span class="id">destruct</span> <span class="id">p</span>; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destruct</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_dec">Nat.eq_dec</a></span>; <span class="id">simpl</span> <span class="kwd">in</span> *; [|<span class="id">tauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Beta.html#all_are2_merge_iff">all_are2_merge_iff</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">rewrite</span> <span class="id"><a href="Beta.html#Forall_1">Forall_1</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; [<span class="id">tauto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id">IHl1</span>; <span class="id">tauto</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="compare_hnf_convertible">compare_hnf_convertible</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span>, <span class="id"><a href="Beta.html#all_are2">all_are2</a></span> (<span class="id"><a href="Rewrite.html#convertible">convertible</a></span> <span class="id"><a href="Beta.html#beta">beta</a></span>) (<span class="id"><a href="Beta.html#compare_hnf">compare_hnf</a></span> <span class="id">t1</span> <span class="id">t2</span>) -&gt; <span class="id"><a href="Rewrite.html#convertible">convertible</a></span> <span class="id"><a href="Beta.html#beta">beta</a></span> <span class="id">t1</span> <span class="id">t2</span>.<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">induction</span> <span class="id">t1</span>; <span class="id">intros</span> <span class="id">t2</span> <span class="id">H12</span>; <span class="id">destruct</span> <span class="id">t2</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">try</span> <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_dec">Nat.eq_dec</a></span>; <span class="id">subst</span>; [<span class="id">apply</span> <span class="id"><a href="Rewrite.html#convertible_refl">convertible_refl</a></span>|<span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">tauto</span>].<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_dec">Nat.eq_dec</a></span>; <span class="id">subst</span>; [<span class="id">apply</span> <span class="id"><a href="Rewrite.html#convertible_refl">convertible_refl</a></span>|<span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">tauto</span>].<br/>
&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="Beta.html#all_are2_merge_iff">all_are2_merge_iff</a></span> <span class="kwd">in</span> <span class="id">H12</span>; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Beta.html#beta_convertible_app">beta_convertible_app</a></span>; [<span class="id">apply</span> <span class="id">IHt1_1</span>; <span class="id">tauto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Beta.html#Forall_1">Forall_1</a></span> <span class="kwd">in</span> <span class="id">H12</span>; <span class="id">apply</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="Beta.html#all_are2_merge_iff">all_are2_merge_iff</a></span> <span class="kwd">in</span> <span class="id">H12</span>; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Beta.html#beta_convertible_switch">beta_convertible_switch</a></span>; [<span class="id">apply</span> <span class="id">IHt1</span>; <span class="id">tauto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Beta.html#compare_branches_forall">compare_branches_forall</a></span>; <span class="id">tauto</span>.<br/>
Qed.</details>
<br/>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="convertible_compare_hnf_betaiota">convertible_compare_hnf_betaiota</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">defs</span> <span class="id">t1</span> <span class="id">t2</span>, <span class="id"><a href="Beta.html#is_hnf_betaiota">is_hnf_betaiota</a></span> <span class="id">defs</span> <span class="id">t1</span> -&gt; <span class="id"><a href="Beta.html#is_hnf_betaiota">is_hnf_betaiota</a></span> <span class="id">defs</span> <span class="id">t2</span> -&gt; <span class="id"><a href="Rewrite.html#convertible">convertible</a></span> (<span class="id"><a href="Beta.html#betaiota">betaiota</a></span> <span class="id">defs</span>) <span class="id">t1</span> <span class="id">t2</span> -&gt; <span class="id"><a href="Beta.html#all_are2">all_are2</a></span> (<span class="id"><a href="Rewrite.html#convertible">convertible</a></span> (<span class="id"><a href="Beta.html#betaiota">betaiota</a></span> <span class="id">defs</span>)) (<span class="id"><a href="Beta.html#compare_hnf">compare_hnf</a></span> <span class="id">t1</span> <span class="id">t2</span>).<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">defs</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">Ht1</span> <span class="id">Ht2</span> <span class="id">Ht</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Rewrite.html#convertible_confluent_common_reduce">convertible_confluent_common_reduce</a></span> <span class="kwd">in</span> <span class="id">Ht</span>; [|<span class="id">apply</span> <span class="id"><a href="Beta.html#beta_iota_confluent">beta_iota_confluent</a></span>].<br/>
&nbsp;&nbsp;<span class="id">destruct</span> <span class="id">Ht</span> <span class="kwd">as</span> (<span class="id">t3</span> &amp; <span class="id">Ht13</span> &amp; <span class="id">Ht23</span>).<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Beta.html#star_betaiota_for_hnf">star_betaiota_for_hnf</a></span> <span class="kwd">in</span> <span class="id">Ht13</span>; [|<span class="id">assumption</span>].<br/>
&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Beta.html#star_betaiota_for_hnf">star_betaiota_for_hnf</a></span> <span class="kwd">in</span> <span class="id">Ht23</span>; [|<span class="id">assumption</span>].<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Beta.html#compare_hnf_flip">compare_hnf_flip</a></span>, <span class="id"><a href="Beta.html#all_are2_flip">all_are2_flip</a></span> <span class="kwd">in</span> <span class="id">Ht23</span>.<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Beta.html#all_are2_impl">all_are2_impl</a></span>; [|<span class="id">eapply</span> <span class="id"><a href="Beta.html#compare_hnf_all_are_trans">compare_hnf_all_are_trans</a></span>; <span class="id">eassumption</span>].<br/>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">x</span> <span class="id">y</span> (<span class="id">z</span> &amp; <span class="id">Hxz</span> &amp; <span class="id">Hyz</span>).<br/>
&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Rewrite.html#common_reduce_convertible">common_reduce_convertible</a></span>; <span class="id">eassumption</span>.<br/>
Qed.</details>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="compare_hnf_convertible_betaiota">compare_hnf_convertible_betaiota</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">defs</span> <span class="id">t1</span> <span class="id">t2</span>, <span class="id"><a href="Beta.html#all_are2">all_are2</a></span> (<span class="id"><a href="Rewrite.html#convertible">convertible</a></span> (<span class="id"><a href="Beta.html#betaiota">betaiota</a></span> <span class="id">defs</span>)) (<span class="id"><a href="Beta.html#compare_hnf">compare_hnf</a></span> <span class="id">t1</span> <span class="id">t2</span>) -&gt; <span class="id"><a href="Rewrite.html#convertible">convertible</a></span> (<span class="id"><a href="Beta.html#betaiota">betaiota</a></span> <span class="id">defs</span>) <span class="id">t1</span> <span class="id">t2</span>.<br/>
<details><summary>Proof.</summary>
&nbsp;&nbsp;<span class="id">intros</span> <span class="id">defs</span>; <span class="id">induction</span> <span class="id">t1</span>; <span class="id">intros</span> <span class="id">t2</span> <span class="id">H12</span>; <span class="id">destruct</span> <span class="id">t2</span>; <span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">try</span> <span class="id">tauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_dec">Nat.eq_dec</a></span>; <span class="id">subst</span>; [<span class="id">apply</span> <span class="id"><a href="Rewrite.html#convertible_refl">convertible_refl</a></span>|<span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">tauto</span>].<br/>
&nbsp;&nbsp;- <span class="id">destruct</span> <span class="id"><a href="https://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.eq_dec">Nat.eq_dec</a></span>; <span class="id">subst</span>; [<span class="id">apply</span> <span class="id"><a href="Rewrite.html#convertible_refl">convertible_refl</a></span>|<span class="id">simpl</span> <span class="kwd">in</span> *; <span class="id">tauto</span>].<br/>
&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="Beta.html#all_are2_merge_iff">all_are2_merge_iff</a></span> <span class="kwd">in</span> <span class="id">H12</span>; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Beta.html#betaiota_convertible_app">betaiota_convertible_app</a></span>; [<span class="id">apply</span> <span class="id">IHt1_1</span>; <span class="id">tauto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> <span class="id"><a href="Beta.html#Forall_1">Forall_1</a></span> <span class="kwd">in</span> <span class="id">H12</span>; <span class="id">apply</span> <span class="id">H12</span>.<br/>
&nbsp;&nbsp;- <span class="id">rewrite</span> <span class="id"><a href="Beta.html#all_are2_merge_iff">all_are2_merge_iff</a></span> <span class="kwd">in</span> <span class="id">H12</span>; <span class="id">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply</span> <span class="id"><a href="Beta.html#betaiota_convertible_switch">betaiota_convertible_switch</a></span>; [<span class="id">apply</span> <span class="id">IHt1</span>; <span class="id">tauto</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eapply</span> <span class="id"><a href="Beta.html#compare_branches_forall">compare_branches_forall</a></span>; <span class="id">tauto</span>.<br/>
Qed.</details>
<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</a></div>
</body>
</html>
